<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Differential test functioning statistics — DTF • mirt</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Differential test functioning statistics — DTF"><meta name="description" content="Function performs various omnibus differential test functioning procedures on an object
estimated with multipleGroup(). If the latent means/covariances are suspected to differ
then the input object should contain a set of 'anchor' items to ensure that only differential
test features are being detected rather than group differences. Returns signed (average area
above and below) and unsigned (total area) statistics, with descriptives such as the percent
average bias between group total scores for each statistic. If a grid of Theta values is passed,
these can be evaluated as well to determine specific DTF location effects.  For best results,
the baseline model should contain a set of 'anchor' items and have freely estimated
hyper-parameters in the focal groups. See DIF for details."><meta property="og:description" content="Function performs various omnibus differential test functioning procedures on an object
estimated with multipleGroup(). If the latent means/covariances are suspected to differ
then the input object should contain a set of 'anchor' items to ensure that only differential
test features are being detected rather than group differences. Returns signed (average area
above and below) and unsigned (total area) statistics, with descriptives such as the percent
average bias between group total scores for each statistic. If a grid of Theta values is passed,
these can be evaluated as well to determine specific DTF location effects.  For best results,
the baseline model should contain a set of 'anchor' items and have freely estimated
hyper-parameters in the focal groups. See DIF for details."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mirt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.44.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/mirt-vignettes.html">UNKNOWN TITLE</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/philchalmers/mirt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Differential test functioning statistics</h1>
      <small class="dont-index">Source: <a href="https://github.com/philchalmers/mirt/blob/main/R/DTF.R" class="external-link"><code>R/DTF.R</code></a></small>
      <div class="d-none name"><code>DTF.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function performs various omnibus differential test functioning procedures on an object
estimated with <code><a href="multipleGroup.html">multipleGroup()</a></code>. If the latent means/covariances are suspected to differ
then the input object should contain a set of 'anchor' items to ensure that only differential
test features are being detected rather than group differences. Returns signed (average area
above and below) and unsigned (total area) statistics, with descriptives such as the percent
average bias between group total scores for each statistic. If a grid of Theta values is passed,
these can be evaluated as well to determine specific DTF location effects.  For best results,
the baseline model should contain a set of 'anchor' items and have freely estimated
hyper-parameters in the focal groups. See <code><a href="DIF.html">DIF</a></code> for details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">DTF</span><span class="op">(</span></span>
<span>  <span class="va">mod</span>,</span>
<span>  draws <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  CI <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  npts <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  theta_lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  Theta_nodes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>space <span class="op">=</span> <span class="st">"right"</span>, points <span class="op">=</span> <span class="cn">FALSE</span>, lines <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mod">mod<a class="anchor" aria-label="anchor" href="#arg-mod"></a></dt>
<dd><p>a multipleGroup object which estimated only 2 groups</p></dd>


<dt id="arg-draws">draws<a class="anchor" aria-label="anchor" href="#arg-draws"></a></dt>
<dd><p>a number indicating how many draws to take to form a suitable multiple imputation
estimate of the expected test scores (usually 100 or more). Returns a list containing the
imputation distribution and null hypothesis test for the sDTF statistic</p></dd>


<dt id="arg-ci">CI<a class="anchor" aria-label="anchor" href="#arg-ci"></a></dt>
<dd><p>range of confidence interval when using draws input</p></dd>


<dt id="arg-npts">npts<a class="anchor" aria-label="anchor" href="#arg-npts"></a></dt>
<dd><p>number of points to use in the integration. Default is 1000</p></dd>


<dt id="arg-theta-lim">theta_lim<a class="anchor" aria-label="anchor" href="#arg-theta-lim"></a></dt>
<dd><p>lower and upper limits of the latent trait (theta) to be evaluated, and is
used in conjunction with <code>npts</code></p></dd>


<dt id="arg-theta-nodes">Theta_nodes<a class="anchor" aria-label="anchor" href="#arg-theta-nodes"></a></dt>
<dd><p>an optional matrix of Theta values to be evaluated in the draws for the
sDTF statistic. However, these values are not averaged across, and instead give the bootstrap
confidence intervals at the respective Theta nodes. Useful when following up a large
uDTF/sDTF statistic to determine where the difference between the test curves are large
(while still accounting for sampling variability). Returns a matrix with observed
variability</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>a character vector indicating which plot to draw. Possible values are 'none',
'func' for the test score functions, and 'sDTF' for the evaluated sDTF values across the
integration grid. Each plot is drawn with imputed confidence envelopes</p></dd>


<dt id="arg-auto-key">auto.key<a class="anchor" aria-label="anchor" href="#arg-auto-key"></a></dt>
<dd><p>logical; automatically generate key in lattice plot?</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments to be passed to <code>lattice</code> and <code>boot</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Chalmers, R., P. (2012). mirt: A Multidimensional Item Response Theory
Package for the R Environment. <em>Journal of Statistical Software, 48</em>(6), 1-29.
<a href="https://doi.org/10.18637/jss.v048.i06" class="external-link">doi:10.18637/jss.v048.i06</a></p>
<p>Chalmers, R. P., Counsell, A., and Flora, D. B. (2016). It might not
  make a big DIF: Improved Differential Test Functioning statistics that account for
  sampling variability. <em>Educational and Psychological Measurement, 76</em>, 114-140.
  <a href="https://doi.org/10.1177/0013164415584576" class="external-link">doi:10.1177/0013164415584576</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="multipleGroup.html">multipleGroup</a></code>, <code><a href="DIF.html">DIF</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">500</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># only first 5 items as anchors</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">'F = 1-30</span></span></span>
<span class="r-in"><span><span class="st">          CONSTRAINB = (1-5, a1), (1-5, d)'</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'Group_1'</span>, <span class="va">N</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'Group_2'</span>, <span class="va">N</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## -------------</span></span></span>
<span class="r-in"><span><span class="co"># groups completely equal</span></span></span>
<span class="r-in"><span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">N</span>, itemtype <span class="op">=</span> <span class="st">'2PL'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">N</span>, itemtype <span class="op">=</span> <span class="st">'2PL'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dat1</span>, <span class="va">dat2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="multipleGroup.html">multipleGroup</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">model</span>, group<span class="op">=</span><span class="va">group</span>, SE<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                     invariance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'free_means'</span>, <span class="st">'free_var'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating information matrix...</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="DTF-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">DTF</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    sDTF.score sDTF(%).score    uDTF.score uDTF(%).score </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.1742369     0.5807896     0.1768800     0.5896002 </span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="mirtCluster.html">mirtCluster</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">DTF</span><span class="op">(</span><span class="va">mod</span>, draws <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="co">#95% C.I. for sDTF containing 0. uDTF is very small</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $observed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    sDTF.score sDTF(%).score    uDTF.score uDTF(%).score </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.1742369     0.5807896     0.1768800     0.5896002 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $CIs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sDTF.score sDTF(%).score uDTF.score uDTF(%).score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5  0.4728808     1.5762695 0.76426586     2.5475529</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  -0.1233808    -0.4112693 0.08050925     0.2683642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tests</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P(sDTF.score = 0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         0.2723393 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">DTF</span><span class="op">(</span><span class="va">mod</span>, draws <span class="op">=</span> <span class="fl">1000</span>, plot<span class="op">=</span><span class="st">'sDTF'</span><span class="op">)</span> <span class="co">#sDTF 95% C.I.'s across Theta always include 0</span></span></span>
<span class="r-plt img"><img src="DTF-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## -------------</span></span></span>
<span class="r-in"><span><span class="co">## random slopes and intercepts for 15 items, and latent mean difference</span></span></span>
<span class="r-in"><span><span class="co">##    (no systematic DTF should exist, but DIF will be present)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">N</span>, itemtype <span class="op">=</span> <span class="st">'2PL'</span>, mu<span class="op">=</span><span class="fl">.50</span>, sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">15</span>, <span class="op">-</span><span class="fl">.2</span>, <span class="fl">.2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="va">d</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">15</span>, <span class="op">-</span><span class="fl">.5</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span>, <span class="va">N</span>, itemtype <span class="op">=</span> <span class="st">'2PL'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dat1</span>, <span class="va">dat2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="multipleGroup.html">multipleGroup</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, group<span class="op">=</span><span class="va">group</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span> <span class="co">#does not account for group differences! Need anchors</span></span></span>
<span class="r-plt img"><img src="DTF-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="multipleGroup.html">multipleGroup</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">model</span>, group<span class="op">=</span><span class="va">group</span>, SE<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                      invariance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'free_means'</span>, <span class="st">'free_var'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating information matrix...</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="DTF-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># significant DIF in multiple items....</span></span></span>
<span class="r-in"><span><span class="co"># DIF(mod2, which.par=c('a1', 'd'), items2test=16:30)</span></span></span>
<span class="r-in"><span><span class="fu">DTF</span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    sDTF.score sDTF(%).score    uDTF.score uDTF(%).score </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.1937470     0.6458234     0.1944098     0.6480326 </span>
<span class="r-in"><span><span class="fu">DTF</span><span class="op">(</span><span class="va">mod2</span>, draws<span class="op">=</span><span class="fl">1000</span><span class="op">)</span> <span class="co">#non-sig DTF due to item cancellation</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $observed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    sDTF.score sDTF(%).score    uDTF.score uDTF(%).score </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.1937470     0.6458234     0.1944098     0.6480326 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $CIs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sDTF.score sDTF(%).score uDTF.score uDTF(%).score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5  0.4949249     1.6497498 0.66772934     2.2257645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  -0.0600406    -0.2001353 0.08150818     0.2716939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tests</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P(sDTF.score = 0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         0.1694501 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## -------------</span></span></span>
<span class="r-in"><span><span class="co">## systematic differing slopes and intercepts (clear DTF)</span></span></span>
<span class="r-in"><span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">N</span>, itemtype <span class="op">=</span> <span class="st">'2PL'</span>, mu<span class="op">=</span><span class="fl">.50</span>, sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">15</span>, <span class="fl">1</span>, <span class="fl">.25</span><span class="op">)</span><span class="op">)</span>, <span class="va">d</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">15</span>, <span class="fl">1</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="va">N</span>, itemtype <span class="op">=</span> <span class="st">'2PL'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dat1</span>, <span class="va">dat2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu"><a href="multipleGroup.html">multipleGroup</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">model</span>, group<span class="op">=</span><span class="va">group</span>, SE<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                      invariance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'free_means'</span>, <span class="st">'free_var'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating information matrix...</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span> <span class="co">#visable DTF happening</span></span></span>
<span class="r-plt img"><img src="DTF-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># DIF(mod3, c('a1', 'd'), items2test=16:30)</span></span></span>
<span class="r-in"><span><span class="fu">DTF</span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span> <span class="co">#unsigned bias. Signed bias indicates group 2 scores generally higher on average</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    sDTF.score sDTF(%).score    uDTF.score uDTF(%).score </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -0.8317365    -2.7724550     1.0764408     3.5881361 </span>
<span class="r-in"><span><span class="fu">DTF</span><span class="op">(</span><span class="va">mod3</span>, draws<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $observed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    sDTF.score sDTF(%).score    uDTF.score uDTF(%).score </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -0.8317365    -2.7724550     1.0764408     3.5881361 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $CIs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sDTF.score sDTF(%).score uDTF.score uDTF(%).score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 -0.5503085     -1.834362  1.3842919      4.614306</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  -1.1248651     -3.749550  0.7954752      2.651584</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tests</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P(sDTF.score = 0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2.738111e-08 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">DTF</span><span class="op">(</span><span class="va">mod3</span>, draws<span class="op">=</span><span class="fl">1000</span>, plot<span class="op">=</span><span class="st">'func'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="DTF-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">DTF</span><span class="op">(</span><span class="va">mod3</span>, draws<span class="op">=</span><span class="fl">1000</span>, plot<span class="op">=</span><span class="st">'sDTF'</span><span class="op">)</span> <span class="co">#multiple DTF areas along Theta</span></span></span>
<span class="r-plt img"><img src="DTF-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># evaluate specific values for sDTF</span></span></span>
<span class="r-in"><span><span class="va">Theta_nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>,<span class="fl">6</span>,length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sDTF</span> <span class="op">&lt;-</span> <span class="fu">DTF</span><span class="op">(</span><span class="va">mod3</span>, Theta_nodes<span class="op">=</span><span class="va">Theta_nodes</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sDTF</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Theta       sDTF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score.1 -6.000000 0.03153791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score.2 -5.878788 0.03604196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score.3 -5.757576 0.04118184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score.4 -5.636364 0.04704370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score.5 -5.515152 0.05372403</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score.6 -5.393939 0.06133041</span>
<span class="r-in"><span><span class="va">sDTF</span> <span class="op">&lt;-</span> <span class="fu">DTF</span><span class="op">(</span><span class="va">mod3</span>, Theta_nodes<span class="op">=</span><span class="va">Theta_nodes</span>, draws<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sDTF</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Theta       sDTF   CI_97.5      CI_2.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score.1 -6.000000 0.03153791 0.1630118 -0.01734655</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score.2 -5.878788 0.03604196 0.1785965 -0.01768471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score.3 -5.757576 0.04118184 0.1955885 -0.01792454</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score.4 -5.636364 0.04704370 0.2140994 -0.01804610</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score.5 -5.515152 0.05372403 0.2342469 -0.01802792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> score.6 -5.393939 0.06133041 0.2561549 -0.01784738</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

