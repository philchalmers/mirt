<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Full-Information Item Bi-factor and Two-Tier Analysis — bfactor • mirt</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Full-Information Item Bi-factor and Two-Tier Analysis — bfactor"><meta name="description" content="bfactor fits a confirmatory maximum likelihood two-tier/bifactor/testlet model to
dichotomous and polytomous data under the item response theory paradigm.
The IRT models are fit using a dimensional reduction EM algorithm so that regardless
of the number of specific factors estimated the model only uses the number of
factors in the second-tier structure plus 1. For the bifactor model the maximum
number of dimensions is only 2 since the second-tier only consists of a
ubiquitous unidimensional factor. See mirt for appropriate methods to be used
on the objects returned from the estimation."><meta property="og:description" content="bfactor fits a confirmatory maximum likelihood two-tier/bifactor/testlet model to
dichotomous and polytomous data under the item response theory paradigm.
The IRT models are fit using a dimensional reduction EM algorithm so that regardless
of the number of specific factors estimated the model only uses the number of
factors in the second-tier structure plus 1. For the bifactor model the maximum
number of dimensions is only 2 since the second-tier only consists of a
ubiquitous unidimensional factor. See mirt for appropriate methods to be used
on the objects returned from the estimation."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mirt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.44.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/mirt-vignettes.html">UNKNOWN TITLE</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/philchalmers/mirt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Full-Information Item Bi-factor and Two-Tier Analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/philchalmers/mirt/blob/main/R/bfactor.R" class="external-link"><code>R/bfactor.R</code></a></small>
      <div class="d-none name"><code>bfactor.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>bfactor</code> fits a confirmatory maximum likelihood two-tier/bifactor/testlet model to
dichotomous and polytomous data under the item response theory paradigm.
The IRT models are fit using a dimensional reduction EM algorithm so that regardless
of the number of specific factors estimated the model only uses the number of
factors in the second-tier structure plus 1. For the bifactor model the maximum
number of dimensions is only 2 since the second-tier only consists of a
ubiquitous unidimensional factor. See <code><a href="mirt.html">mirt</a></code> for appropriate methods to be used
on the objects returned from the estimation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bfactor</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  model2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"G = 1-"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quadpts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  invariance <span class="op">=</span> <span class="st">""</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a <code>matrix</code> or <code>data.frame</code> that consists of
numerically ordered data, organized in the form of integers,
with missing data coded as <code>NA</code></p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>a numeric vector specifying which factor loads on which
  item. For example, if for a 4 item test with two specific factors, the first
  specific factor loads on the first two items and the second specific factor
  on the last two, then the vector is <code>c(1,1,2,2)</code>. For items that should only load
  on the second-tier factors (have no specific component) <code>NA</code> values may
  be used as place-holders. These numbers will be translated into a format suitable for
  <code><a href="mirt.model.html">mirt.model()</a></code>, combined with the definition in <code>model2</code>, with the letter 'S'
  added to the respective factor number</p>
<p>Alternatively, input can be specified using the <code><a href="mirt.model.html">mirt.model</a></code> syntax with the
  restriction that each item must load on exactly one specific factor (or no specific factors,
  if it is only predicted by the general factor specified in <code>model2</code>)</p></dd>


<dt id="arg-model-">model2<a class="anchor" aria-label="anchor" href="#arg-model-"></a></dt>
<dd><p>a two-tier model specification object defined by <code><a href="mirt.model.html">mirt.model()</a></code> or
a string to be passed to <code><a href="mirt.model.html">mirt.model</a></code>. By default
the model will fit a unidimensional model in the second-tier, and therefore be equivalent to
the bifactor model</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>a factor variable indicating group membership used for multiple group analyses</p></dd>


<dt id="arg-quadpts">quadpts<a class="anchor" aria-label="anchor" href="#arg-quadpts"></a></dt>
<dd><p>number of quadrature nodes to use after accounting for the reduced number of dimensions.
Scheme is the same as the one used in <code><a href="mirt.html">mirt</a></code>, however it is in regards to the reduced
dimensions (e.g., a bifactor model has 2 dimensions to be integrated)</p></dd>


<dt id="arg-invariance">invariance<a class="anchor" aria-label="anchor" href="#arg-invariance"></a></dt>
<dd><p>see <code><a href="multipleGroup.html">multipleGroup</a></code> for details, however, the specific factor variances
and means will be constrained according to the dimensional reduction algorithm</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments to be passed to the estimation engine. See <code><a href="mirt.html">mirt</a></code>
for more details and examples</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>function returns an object of class <code>SingleGroupClass</code>
  (<a href="SingleGroupClass-class.html">SingleGroupClass-class</a>) or <code>MultipleGroupClass</code>(<a href="MultipleGroupClass-class.html">MultipleGroupClass-class</a>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>bfactor</code> follows the item factor analysis strategy explicated by
Gibbons and Hedeker (1992), Gibbons et al. (2007), and Cai (2010).
Nested models may be compared via an approximate
chi-squared difference test or by a reduction in AIC or BIC (accessible via
<code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></code>). See <code><a href="mirt.html">mirt</a></code> for more details regarding the
IRT estimation approach used in this package.</p>
<p>The two-tier model has a specific block diagonal covariance structure between the primary and
secondary latent traits. Namely, the secondary latent traits are assumed to be orthogonal to
all traits and have a fixed variance of 1, while the primary traits can be organized to vary
and covary with other primary traits in the model.</p>
<p>$$\Sigma_{two-tier} = \left(\begin{array}{cc} G &amp; 0 \\ 0 &amp; diag(S) \end{array} \right)$$</p>
<p>The bifactor model is a special case of the two-tier model when \(G\) above is a 1x1 matrix,
and therefore only 1 primary factor is being modeled. Evaluation of the numerical integrals
for the two-tier model requires only \(ncol(G) + 1\) dimensions for integration since the
\(S\) second order (or 'specific') factors require only 1 integration grid due to the
dimension reduction technique.</p>
<p>Note: for multiple group two-tier analyses only the second-tier means and variances
should be freed since the specific factors are not treated independently due to the
dimension reduction technique.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Cai, L. (2010). A two-tier full-information item factor analysis model with applications.
<em>Psychometrika, 75</em>, 581-612.</p>
<p>Chalmers, R., P. (2012). mirt: A Multidimensional Item Response Theory
Package for the R Environment. <em>Journal of Statistical Software, 48</em>(6), 1-29.
<a href="https://doi.org/10.18637/jss.v048.i06" class="external-link">doi:10.18637/jss.v048.i06</a></p>
<p>Bradlow, E.T., Wainer, H., &amp; Wang, X. (1999). A Bayesian random effects model for testlets.
<em>Psychometrika, 64</em>, 153-168.</p>
<p>Gibbons, R. D., &amp; Hedeker, D. R. (1992). Full-information Item Bi-Factor
Analysis. <em>Psychometrika, 57</em>, 423-436.</p>
<p>Gibbons, R. D., Darrell, R. B., Hedeker, D., Weiss, D. J., Segawa, E., Bhaumik, D. K.,
Kupfer, D. J., Frank, E., Grochocinski, V. J., &amp; Stover, A. (2007).
Full-Information item bifactor analysis of graded response data.
<em>Applied Psychological Measurement, 31</em>, 4-19.</p>
<p>Wainer, H., Bradlow, E.T., &amp; Wang, X. (2007). Testlet response theory and its applications.
New York, NY: Cambridge University Press.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mirt.html">mirt</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### load SAT12 and compute bifactor model with 3 specific factors</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">SAT12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="key2binary.html">key2binary</a></span><span class="op">(</span><span class="va">SAT12</span>,</span></span>
<span class="r-in"><span>  key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">specific</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">bfactor</span><span class="op">(</span><span class="va">data</span>, <span class="va">specific</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              G      S1      S2      S3      h2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.1  0.4078          0.2273         0.21799</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.2  0.6195                  0.3391 0.49881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.3  0.5573         -0.0744         0.31612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.4  0.2808                  0.3101 0.17503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.5  0.4779                  0.2544 0.29311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.6  0.5341          0.2724         0.35948</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.7  0.4741  0.4210                 0.40199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.8  0.3537          0.2732         0.19971</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.9  0.2181  0.5321                 0.33068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.10 0.4849  0.3792                 0.37895</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.11 0.6442  0.3321                 0.52536</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.12 0.0699                  0.1592 0.03023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.13 0.5219  0.2743                 0.34764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.14 0.4791                  0.4563 0.43776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.15 0.5985  0.2402                 0.41590</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.16 0.3885          0.2049         0.19292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.17 0.6636  0.1177                 0.45423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.18 0.7163  0.0775                 0.51903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.19 0.4520                  0.0198 0.20466</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.20 0.6578                  0.1792 0.46478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.21 0.2806  0.3451                 0.19787</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.22 0.7025 -0.0281                 0.49425</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.23 0.3236                  0.2657 0.17536</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.24 0.5848  0.1030                 0.35266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.25 0.3732                  0.3297 0.24799</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.26 0.6430                  0.2124 0.45854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.27 0.7374  0.1554                 0.56792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.28 0.5256                  0.0758 0.28199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.29 0.4185          0.7071         0.67516</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.30 0.2455                 -0.0959 0.06946</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.31 0.8333 -0.0872                 0.70202</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item.32 0.0780          0.0165         0.00635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SS loadings:  8.435 1.03 0.748 0.781 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion Var:  0.264 0.032 0.023 0.024 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor correlations: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    G S1 S2 S3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G  1         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S1 0  1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S2 0  0  1   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S3 0  0  0  1</span>
<span class="r-in"><span><span class="fu"><a href="itemplot.html">itemplot</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="fl">18</span>, drop.zeros <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#drop the zero slopes to allow plotting</span></span></span>
<span class="r-plt img"><img src="bfactor-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># alternative model definition via ?mirt.model syntax</span></span></span>
<span class="r-in"><span><span class="va">specific2</span> <span class="op">&lt;-</span> <span class="st">"S1 = 7,9,10,11,13,15,17,18,21,22,24,27,31</span></span></span>
<span class="r-in"><span><span class="st">              S2 = 1,3,6,8,16,29,32</span></span></span>
<span class="r-in"><span><span class="st">              S3 = 2,4,5,12,14,19,20,23,25,26,28,30"</span></span></span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">bfactor</span><span class="op">(</span><span class="va">data</span>, <span class="va">specific2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="va">mod2</span><span class="op">)</span> <span class="co"># same</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          AIC    SABIC       HQ      BIC    logLik X2 df   p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod1 19062.1 19179.44 19226.42 19484.21 -9435.052          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod2 19062.1 19179.44 19226.42 19484.21 -9435.052  0  0 NaN</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># also equivalent using item names instead (not run)</span></span></span>
<span class="r-in"><span><span class="va">specific3</span> <span class="op">&lt;-</span> <span class="st">"S1 = Item.7, Item.9, Item.10, Item.11, Item.13, Item.15,</span></span></span>
<span class="r-in"><span><span class="st">                Item.17, Item.18, Item.21, Item.22, Item.24, Item.27, Item.31</span></span></span>
<span class="r-in"><span><span class="st">              S2 = Item.1, Item.3, Item.6, Item.8, Item.16, Item.29, Item.32</span></span></span>
<span class="r-in"><span><span class="st">              S3 = Item.2, Item.4, Item.5, Item.12, Item.14, Item.19,</span></span></span>
<span class="r-in"><span><span class="st">                Item.20, Item.23, Item.25, Item.26, Item.28, Item.30"</span></span></span>
<span class="r-in"><span><span class="co"># mod3 &lt;- bfactor(data, specific3)</span></span></span>
<span class="r-in"><span><span class="co"># anova(mod1, mod2, mod3)  # all same</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Try with fixed guessing parameters added</span></span></span>
<span class="r-in"><span><span class="va">guess</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="fl">32</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">bfactor</span><span class="op">(</span><span class="va">data</span>, <span class="va">specific</span>, guess <span class="op">=</span> <span class="va">guess</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1 a2    a3 a4      d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.225  0 0.624  0 -1.822 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1 a2 a3    a4     d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.721  0  0 0.954 0.171 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1 a2     a3 a4      d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 2.415  0 -0.459  0 -2.602 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1 a2 a3    a4      d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.745  0  0 0.695 -0.989 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1 a2 a3    a4     d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.048  0  0 0.603 0.419 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       a1 a2    a3 a4      d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 3.06  0 0.501  0 -5.002 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1    a2 a3 a4     d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.121 0.839  0  0 1.373 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1 a2    a3 a4      d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.956  0 1.443  0 -3.772 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1    a2 a3 a4     d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.512 1.236  0  0 2.484 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       a1    a2 a3 a4      d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.68 1.506  0  0 -1.031 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1    a2 a3 a4     d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.655 0.842  0  0 5.441 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1 a2 a3    a4      d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.129  0  0 0.364 -0.641 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1    a2 a3 a4     d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.183 0.477  0  0 0.679 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1 a2 a3    a4     d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.125  0  0 1.058 1.164 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1    a2 a3 a4     d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.435 0.317  0  0 1.863 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       a1 a2    a3 a4      d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.95  0 0.573  0 -0.783 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1    a2 a3 a4     d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.547 0.059  0  0 4.112 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1    a2 a3 a4      d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 2.731 0.094  0  0 -1.808 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1 a2 a3    a4      d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.918  0  0 0.101 -0.001 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1 a2 a3    a4     d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.456  0  0 0.593 2.501 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1    a2 a3 a4    d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.596 0.493  0  0 2.49 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     a2 a3 a4     d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.554 -0.242  0  0 3.428 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1 a2 a3    a4      d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.908  0  0 0.766 -1.488 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1    a2 a3 a4     d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.379 0.001  0  0 1.132 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       a1 a2 a3    a4      d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.03  0  0 1.094 -1.164 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1 a2 a3    a4      d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.985  0  0 0.747 -0.663 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1    a2 a3 a4     d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.909 0.348  0  0 2.642 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1 a2 a3    a4      d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.213  0  0 0.142 -0.097 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1 a2    a3 a4      d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.938  0 2.339  0 -2.209 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1 a2 a3     a4      d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.479  0  0 -0.128 -0.527 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1    a2 a3 a4     d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 3.173 -0.82  0  0 3.316 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1 a2     a3 a4      d   g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.534  0 -0.053  0 -2.786 0.1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $GroupPars</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     MEAN_1 MEAN_2 MEAN_3 MEAN_4 COV_11 COV_21 COV_31 COV_41 COV_22 COV_32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par      0      0      0      0      1      0      0      0      1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     COV_42 COV_33 COV_43 COV_44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par      0      1      0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="va">mod2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           AIC    SABIC       HQ      BIC    logLik     X2 df   p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod1 19062.10 19179.44 19226.42 19484.21 -9435.052              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod2 19009.55 19126.88 19173.87 19431.65 -9408.775 52.553  0 NaN</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## don't estimate specific factor for item 32</span></span></span>
<span class="r-in"><span><span class="va">specific</span><span class="op">[</span><span class="fl">32</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">bfactor</span><span class="op">(</span><span class="va">data</span>, <span class="va">specific</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod3</span>, <span class="va">mod1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           AIC    SABIC       HQ      BIC    logLik   X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod3 19060.12 19176.23 19222.73 19477.83 -9435.062              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod1 19062.10 19179.44 19226.42 19484.21 -9435.052 0.02  1 0.886</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># same, but with syntax (not run)</span></span></span>
<span class="r-in"><span><span class="va">specific3</span> <span class="op">&lt;-</span> <span class="st">"S1 = 7,9,10,11,13,15,17,18,21,22,24,27,31</span></span></span>
<span class="r-in"><span><span class="st">              S2 = 1,3,6,8,16,29</span></span></span>
<span class="r-in"><span><span class="st">              S3 = 2,4,5,12,14,19,20,23,25,26,28,30"</span></span></span>
<span class="r-in"><span><span class="co"># mod3b &lt;- bfactor(data, specific3)</span></span></span>
<span class="r-in"><span><span class="co"># anova(mod3b)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#########</span></span></span>
<span class="r-in"><span><span class="co"># mixed itemtype example</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulate data</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="cn">NA</span>,<span class="fl">0.5</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="cn">NA</span>,<span class="fl">0.5</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="cn">NA</span>,<span class="fl">0.5</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="cn">NA</span>,<span class="fl">0.5</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="cn">NA</span>,<span class="fl">0.5</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="cn">NA</span>,<span class="fl">0.5</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="cn">NA</span>,<span class="fl">0.5</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">3</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="op">-</span><span class="fl">1.0</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span><span class="op">-</span><span class="fl">1.5</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span> <span class="fl">1.5</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span> <span class="fl">0.0</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span><span class="fl">2.5</span>,<span class="fl">1.0</span>,<span class="op">-</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span><span class="fl">3.0</span>,<span class="fl">2.0</span>,<span class="op">-</span><span class="fl">0.5</span>,</span></span>
<span class="r-in"><span><span class="fl">3.0</span>,<span class="fl">2.0</span>,<span class="op">-</span><span class="fl">0.5</span>,</span></span>
<span class="r-in"><span><span class="fl">3.0</span>,<span class="fl">2.0</span>,<span class="op">-</span><span class="fl">0.5</span>,</span></span>
<span class="r-in"><span><span class="fl">2.5</span>,<span class="fl">1.0</span>,<span class="op">-</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span><span class="fl">2.0</span>,<span class="fl">0.0</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span><span class="op">-</span><span class="fl">1.0</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span><span class="op">-</span><span class="fl">1.5</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span> <span class="fl">1.5</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span> <span class="fl">0.0</span>,<span class="cn">NA</span>,<span class="cn">NA</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">3</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>, <span class="fl">14</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">items</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'graded'</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">d</span>,<span class="fl">5000</span>,itemtype<span class="op">=</span><span class="va">items</span>,sigma<span class="op">=</span><span class="va">sigma</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="itemstats.html">itemstats</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $overall</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     N mean_total.score sd_total.score ave.r  sd.r alpha SEM.alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5000           15.145           4.49 0.178 0.032 0.736     2.309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $itemstats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            N  mean    sd total.r total.r_if_rm alpha_if_rm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  5000 0.306 0.461   0.436         0.347       0.723</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  5000 0.232 0.422   0.403         0.320       0.725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  5000 0.771 0.420   0.376         0.291       0.727</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  5000 0.498 0.500   0.478         0.385       0.719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  5000 1.896 0.963   0.571         0.398       0.717</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  5000 2.147 0.880   0.549         0.389       0.717</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  5000 2.171 0.863   0.540         0.382       0.717</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  5000 2.133 0.890   0.551         0.389       0.717</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  5000 1.858 0.988   0.575         0.398       0.717</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 5000 1.332 0.736   0.528         0.394       0.715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 5000 0.299 0.458   0.438         0.351       0.723</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 5000 0.233 0.423   0.390         0.306       0.726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 5000 0.764 0.424   0.410         0.326       0.725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 5000 0.504 0.500   0.473         0.379       0.720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $proportions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             0     1     2     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.694 0.306    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  0.768 0.232    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.229 0.771    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.502 0.498    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  0.107 0.199 0.384 0.310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.081 0.082 0.447 0.390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.072 0.085 0.443 0.400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.082 0.091 0.438 0.389</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.123 0.199 0.374 0.304</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.160 0.348 0.492    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.701 0.299    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 0.767 0.233    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 0.236 0.764    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 0.496 0.504    NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">specific</span> <span class="op">&lt;-</span> <span class="st">"S1 = 1-7</span></span></span>
<span class="r-in"><span><span class="st">             S2 = 8-14"</span></span></span>
<span class="r-in"><span><span class="va">simmod</span> <span class="op">&lt;-</span> <span class="fu">bfactor</span><span class="op">(</span><span class="va">dataset</span>, <span class="va">specific</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">simmod</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1     a2    a3      d  g  u    d1     d2     d3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1.145  0.392 0.000 -1.048  0  1    NA     NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1.146 -0.042 0.000 -1.496  0  1    NA     NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.962  0.334 0.000  1.458  0  1    NA     NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  1.247 -0.163 0.000 -0.008  0  1    NA     NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1.086  0.117 0.000     NA NA NA 2.543  1.012 -0.991</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  1.149  0.462 0.000     NA NA NA 3.005  2.081 -0.577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1.112  0.062 0.000     NA NA NA 3.039  2.056 -0.500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.939  0.000 0.674     NA NA NA 2.916  1.939 -0.568</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.887  0.000 0.676     NA NA NA 2.381  0.925 -1.035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.928  0.000 0.655     NA NA NA 2.034 -0.044     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 1.018  0.000 0.456 -1.063  0  1    NA     NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 0.903  0.000 0.560 -1.448  0  1    NA     NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 0.928  0.000 0.620  1.456  0  1    NA     NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 0.974  0.000 0.663  0.022  0  1    NA     NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  G S1 S2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0  0  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    G S1 S2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G  1  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S1 0  1  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S2 0  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#########</span></span></span>
<span class="r-in"><span><span class="co"># General testlet response model (Wainer, 2007)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulate data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">12</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="va">a</span><span class="op">[</span><span class="va">ind</span><span class="op">:</span><span class="op">(</span><span class="va">ind</span><span class="op">+</span><span class="fl">3</span><span class="op">)</span>,<span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="va">ind</span><span class="op">:</span><span class="op">(</span><span class="va">ind</span><span class="op">+</span><span class="fl">3</span><span class="op">)</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>   <span class="va">ind</span> <span class="op">&lt;-</span> <span class="va">ind</span><span class="op">+</span><span class="fl">4</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]      [,2]     [,3]      [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.8503394 0.8503394 0.000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 1.3274088 1.3274088 0.000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 1.6910208 1.6910208 0.000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.6042850 0.6042850 0.000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 1.3892130 0.0000000 1.389213 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 1.4216480 0.0000000 1.421648 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 1.0279618 0.0000000 1.027962 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 1.0366667 0.0000000 1.036667 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 1.0311394 0.0000000 0.000000 1.0311394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.9351846 0.0000000 0.000000 0.9351846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 1.0584888 0.0000000 0.000000 1.0584888</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 0.9052755 0.0000000 0.000000 0.9052755</span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">0</span>, <span class="fl">.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.5</span>, <span class="fl">1</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">d</span>,<span class="fl">2000</span>,itemtype<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>, <span class="fl">12</span><span class="op">)</span>,sigma<span class="op">=</span><span class="va">sigma</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="itemstats.html">itemstats</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $overall</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     N mean_total.score sd_total.score ave.r  sd.r alpha SEM.alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2000                6          2.929 0.175 0.068 0.717     1.558</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $itemstats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            N  mean    sd total.r total.r_if_rm alpha_if_rm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  2000 0.426 0.495   0.438         0.287       0.708</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  2000 0.502 0.500   0.560         0.425       0.689</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  2000 0.571 0.495   0.575         0.445       0.686</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  2000 0.502 0.500   0.383         0.224       0.716</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  2000 0.464 0.499   0.549         0.413       0.690</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  2000 0.436 0.496   0.561         0.428       0.688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  2000 0.440 0.497   0.500         0.356       0.698</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  2000 0.693 0.462   0.474         0.339       0.701</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  2000 0.511 0.500   0.481         0.334       0.701</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 2000 0.456 0.498   0.465         0.316       0.704</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 2000 0.458 0.498   0.459         0.309       0.705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 2000 0.540 0.498   0.475         0.327       0.702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $proportions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.575 0.426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  0.498 0.502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.430 0.571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.498 0.502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  0.536 0.464</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.564 0.436</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.559 0.440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.308 0.693</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.488 0.511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.543 0.456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.541 0.458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 0.460 0.540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate by applying constraints and freeing the latent variances</span></span></span>
<span class="r-in"><span><span class="va">specific</span> <span class="op">&lt;-</span> <span class="st">"S1 = 1-4</span></span></span>
<span class="r-in"><span><span class="st">             S2 = 5-8</span></span></span>
<span class="r-in"><span><span class="st">             S3 = 9-12"</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">"G = 1-12</span></span></span>
<span class="r-in"><span><span class="st">          CONSTRAIN = (1, a1, a2), (2, a1, a2), (3, a1, a2), (4, a1, a2),</span></span></span>
<span class="r-in"><span><span class="st">            (5, a1, a3), (6, a1, a3), (7, a1, a3), (8, a1, a3),</span></span></span>
<span class="r-in"><span><span class="st">            (9, a1, a4), (10, a1, a4), (11, a1, a4), (12, a1, a4)</span></span></span>
<span class="r-in"><span><span class="st">          COV = S1*S1, S2*S2, S3*S3"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">simmod</span> <span class="op">&lt;-</span> <span class="fu">bfactor</span><span class="op">(</span><span class="va">dataset</span>, <span class="va">specific</span>, <span class="va">model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">simmod</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1    a2    a3    a4      d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.794 0.794 0.000 0.000 -0.359 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1.544 1.544 0.000 0.000  0.011 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1.762 1.762 0.000 0.000  0.479 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.544 0.544 0.000 0.000  0.011 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1.386 0.000 1.386 0.000 -0.244 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  1.497 0.000 1.497 0.000 -0.449 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.853 0.000 0.853 0.000 -0.312 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.953 0.000 0.953 0.000  1.101 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.981 0.000 0.000 0.981  0.058 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.913 0.000 0.000 0.913 -0.217 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.868 0.000 0.000 0.868 -0.204 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 0.966 0.000 0.000 0.966  0.206 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  G S1 S2 S3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0  0  0  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    G    S1    S2    S3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G  1 0.000 0.000 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S1 0 0.452 0.000 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S2 0 0.000 1.135 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S3 0 0.000 0.000 0.432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Constrained testlet model (Bradlow, 1999)</span></span></span>
<span class="r-in"><span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="st">"G = 1-12</span></span></span>
<span class="r-in"><span><span class="st">          CONSTRAIN = (1, a1, a2), (2, a1, a2), (3, a1, a2), (4, a1, a2),</span></span></span>
<span class="r-in"><span><span class="st">            (5, a1, a3), (6, a1, a3), (7, a1, a3), (8, a1, a3),</span></span></span>
<span class="r-in"><span><span class="st">            (9, a1, a4), (10, a1, a4), (11, a1, a4), (12, a1, a4),</span></span></span>
<span class="r-in"><span><span class="st">            (GROUP, COV_22, COV_33, COV_44)</span></span></span>
<span class="r-in"><span><span class="st">          COV = S1*S1, S2*S2, S3*S3"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">simmod2</span> <span class="op">&lt;-</span> <span class="fu">bfactor</span><span class="op">(</span><span class="va">dataset</span>, <span class="va">specific</span>, <span class="va">model2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">simmod2</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1    a2    a3    a4      d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.744 0.744 0.000 0.000 -0.360 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1.453 1.453 0.000 0.000  0.010 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1.664 1.664 0.000 0.000  0.482 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.509 0.509 0.000 0.000  0.011 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1.541 0.000 1.541 0.000 -0.241 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  1.670 0.000 1.670 0.000 -0.445 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.968 0.000 0.968 0.000 -0.313 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  1.075 0.000 1.075 0.000  1.098 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.927 0.000 0.000 0.927  0.059 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.854 0.000 0.000 0.854 -0.218 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.813 0.000 0.000 0.813 -0.205 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 0.908 0.000 0.000 0.908  0.207 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  G S1 S2 S3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0  0  0  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    G    S1    S2    S3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G  1 0.000 0.000 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S1 0 0.667 0.000 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S2 0 0.000 0.667 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S3 0 0.000 0.000 0.667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">simmod2</span>, <span class="va">simmod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              AIC    SABIC       HQ      BIC   logLik     X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> simmod2 30256.59 30317.19 30308.00 30396.61 -15103.3                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> simmod  30248.79 30314.24 30304.32 30400.02 -15097.4 11.795  2 0.003</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#########</span></span></span>
<span class="r-in"><span><span class="co"># Two-tier model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulate data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="fl">0</span>,<span class="fl">1</span>,<span class="cn">NA</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="fl">0</span>,<span class="fl">1</span>,<span class="cn">NA</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="fl">0</span>,<span class="fl">1</span>,<span class="cn">NA</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="fl">1</span>,<span class="fl">0</span>,<span class="cn">NA</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="fl">1</span>,<span class="fl">0</span>,<span class="cn">NA</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="fl">1</span>,<span class="fl">0</span>,<span class="cn">NA</span>,<span class="fl">0.5</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="fl">1</span>,<span class="fl">0</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  <span class="fl">1</span>,<span class="fl">0</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  <span class="fl">1</span>,<span class="fl">0</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  <span class="fl">1</span>,<span class="fl">0</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  <span class="fl">1</span>,<span class="fl">0</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="fl">0.5</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">5</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">16</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>, <span class="fl">16</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sigma</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">sigma</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">.4</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">d</span>,<span class="fl">2000</span>,itemtype<span class="op">=</span><span class="va">items</span>,sigma<span class="op">=</span><span class="va">sigma</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="itemstats.html">itemstats</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $overall</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     N mean_total.score sd_total.score ave.r  sd.r alpha SEM.alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2000            7.086          3.077 0.108 0.058 0.662      1.79</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $itemstats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            N  mean    sd total.r total.r_if_rm alpha_if_rm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  2000 0.288 0.453   0.378         0.241       0.650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  2000 0.571 0.495   0.422         0.276       0.646</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  2000 0.705 0.456   0.381         0.245       0.650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  2000 0.133 0.340   0.289         0.183       0.656</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  2000 0.601 0.490   0.393         0.246       0.650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  2000 0.587 0.492   0.419         0.274       0.646</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  2000 0.379 0.485   0.444         0.304       0.642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  2000 0.378 0.485   0.400         0.256       0.649</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  2000 0.386 0.487   0.392         0.246       0.650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 2000 0.322 0.467   0.400         0.261       0.648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 2000 0.402 0.490   0.455         0.315       0.640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 2000 0.318 0.466   0.414         0.278       0.646</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 2000 0.368 0.482   0.423         0.281       0.645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 2000 0.498 0.500   0.424         0.277       0.646</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 2000 0.669 0.471   0.394         0.254       0.649</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_16 2000 0.482 0.500   0.444         0.300       0.642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $proportions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.713 0.288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  0.430 0.571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.295 0.705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.867 0.133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  0.400 0.601</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.413 0.587</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.621 0.379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.622 0.378</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.614 0.386</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.678 0.322</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.598 0.402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 0.681 0.318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 0.632 0.368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 0.502 0.498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.330 0.669</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_16 0.518 0.482</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">specific</span> <span class="op">&lt;-</span> <span class="st">"S1 = 1-5</span></span></span>
<span class="r-in"><span><span class="st">             S2 = 6-11</span></span></span>
<span class="r-in"><span><span class="st">             S3 = 12-16"</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">'</span></span></span>
<span class="r-in"><span><span class="st">    G1 = 1-8</span></span></span>
<span class="r-in"><span><span class="st">    G2 = 9-16</span></span></span>
<span class="r-in"><span><span class="st">    COV = G1*G2'</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># quadpts dropped for faster estimation, but not as precise</span></span></span>
<span class="r-in"><span><span class="va">simmod</span> <span class="op">&lt;-</span> <span class="fu">bfactor</span><span class="op">(</span><span class="va">dataset</span>, <span class="va">specific</span>, <span class="va">model</span>, quadpts <span class="op">=</span> <span class="fl">9</span>, TOL <span class="op">=</span> <span class="fl">1e-3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">simmod</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1    a2    a3    a4    a5      d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.965 0.000 0.385 0.000 0.000 -1.100 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1.076 0.000 0.550 0.000 0.000  0.363 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.898 0.000 0.592 0.000 0.000  1.068 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.896 0.000 0.710 0.000 0.000 -2.293 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  0.892 0.000 0.848 0.000 0.000  0.526 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  1.013 0.000 0.000 0.413 0.000  0.435 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1.162 0.000 0.000 0.451 0.000 -0.639 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.945 0.000 0.000 0.609 0.000 -0.623 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.000 0.831 0.000 0.371 0.000 -0.544 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.000 0.925 0.000 0.610 0.000 -0.926 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.000 1.142 0.000 0.495 0.000 -0.517 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 0.000 0.978 0.000 0.000 0.634 -0.964 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 0.000 1.108 0.000 0.000 0.437 -0.694 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 0.000 1.004 0.000 0.000 0.321 -0.012 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.000 0.916 0.000 0.000 0.758  0.897 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_16 0.000 1.020 0.000 0.000 0.650 -0.096 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1 G2 S1 S2 S3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0  0  0  0  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       G1    G2 S1 S2 S3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1 1.000 0.412  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2 0.412 1.000  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S1 0.000 0.000  1  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S2 0.000 0.000  0  1  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S3 0.000 0.000  0  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">simmod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            G1    G2    S1    S2    S3    h2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.484       0.193             0.271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  0.516       0.263             0.335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.446       0.294             0.285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.437       0.346             0.311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  0.425       0.404             0.343</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.501             0.204       0.293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.551             0.214       0.349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.463             0.299       0.304</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9        0.431       0.192       0.222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10       0.456       0.300       0.298</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11       0.541       0.235       0.348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12       0.474             0.307 0.319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13       0.533             0.210 0.329</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14       0.501             0.160 0.277</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15       0.441             0.365 0.328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_16       0.488             0.311 0.336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SS loadings:  1.839 1.88 0.476 0.359 0.395 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion Var:  0.115 0.118 0.03 0.022 0.025 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor correlations: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       G1 G2 S1 S2 S3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1 1.000            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2 0.412  1         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S1 0.000  0  1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S2 0.000  0  0  1   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S3 0.000  0  0  0  1</span>
<span class="r-in"><span><span class="fu"><a href="itemfit.html">itemfit</a></span><span class="op">(</span><span class="va">simmod</span>, QMC<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item   S_X2 df.S_X2 RMSEA.S_X2 p.S_X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1  7.103       9      0.000  0.626</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2 13.326      10      0.013  0.206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3  8.332       9      0.000  0.501</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4  8.531      10      0.000  0.577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5  7.170      10      0.000  0.709</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6  3.967      10      0.000  0.949</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7  8.350      10      0.000  0.595</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8 16.010      10      0.017  0.099</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9 17.529      10      0.019  0.063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10 12.058      10      0.010  0.281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Item_11 13.567      10      0.013  0.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Item_12 13.907       9      0.017  0.126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Item_13 11.144      10      0.008  0.346</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Item_14  7.852      10      0.000  0.643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 Item_15 14.142       9      0.017  0.117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Item_16  5.926      10      0.000  0.821</span>
<span class="r-in"><span><span class="fu"><a href="M2.html">M2</a></span><span class="op">(</span><span class="va">simmod</span>, QMC<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             M2 df         p RMSEA RMSEA_5   RMSEA_95      SRMSR      TLI CFI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stats 86.28163 87 0.5015988     0       0 0.01201603 0.01662365 1.000285   1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">simmod</span>, QMC<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LD matrix (lower triangle) and standardized residual correlations (upper triangle)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper triangle summary:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.046  -0.011  -0.002  -0.001   0.012   0.041 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1         -0.011 -0.015 -0.007  0.016  0.003  0.006 -0.002  0.004  -0.009</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2   0.263        -0.002  0.005 -0.001  0.016 -0.022  0.021 -0.003  -0.006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3   0.441  0.008         0.014 -0.001  0.029 -0.017 -0.011 -0.021  -0.028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4   0.086  0.054  0.376        -0.014 -0.023  0.021 -0.004  0.020  -0.040</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5   0.514  0.004  0.003  0.386        -0.028  0.011  0.014 -0.021   0.013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6   0.015  0.483  1.630  1.038  1.588        -0.022 -0.009  0.031  -0.004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7   0.077  0.996  0.590  0.852  0.258  0.992        -0.007 -0.004   0.013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8   0.012  0.858  0.264  0.039  0.377  0.154  0.094        -0.020   0.008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9   0.033  0.017  0.863  0.803  0.890  1.974  0.037  0.808          0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10  0.157  0.084  1.528  3.158  0.360  0.038  0.330  0.128  0.001        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11  0.510  0.125  2.195  0.231  0.004  0.215  1.049  0.004  0.031   0.754</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12  2.017  0.253  1.865  0.388  0.005  0.417  0.074  0.090  0.443   0.042</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13  0.470  2.122  0.125  0.271  0.881  0.264  0.310  4.304  0.009   0.059</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14  0.101  1.546  0.165  0.006  0.296  0.004  1.672  0.765  3.341   0.066</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15  0.822  0.257  0.011  0.442  0.443  0.113  0.526  0.297  2.306   0.044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_16  0.097  0.627  1.486  0.127  0.445  0.011  0.732  0.061  0.007   0.944</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Item_11 Item_12 Item_13 Item_14 Item_15 Item_16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1   -0.016  -0.032   0.015  -0.007   0.020  -0.007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2    0.008   0.011  -0.033  -0.028  -0.011   0.018</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3    0.033   0.031   0.008  -0.009  -0.002   0.027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4   -0.011   0.014  -0.012  -0.002  -0.015  -0.008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5   -0.001   0.002  -0.021  -0.012   0.015   0.015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6    0.010   0.014  -0.011   0.001  -0.008   0.002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7    0.023   0.006   0.012   0.029  -0.016   0.019</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8   -0.001   0.007  -0.046  -0.020   0.012   0.006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9    0.004  -0.015  -0.002   0.041  -0.034  -0.002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10  -0.019   0.005   0.005   0.006  -0.005   0.022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11           0.009   0.000  -0.025   0.039  -0.011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12   0.149          -0.008   0.013  -0.002  -0.009</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13   0.000   0.140           0.013  -0.012   0.003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14   1.269   0.338   0.336          -0.007  -0.023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15   3.061   0.010   0.284   0.086           0.010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_16   0.250   0.153   0.015   1.026   0.190        </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

