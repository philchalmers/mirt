<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate response patterns — simdata • mirt</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate response patterns — simdata"><meta name="description" content="Simulates response patterns for compensatory and noncompensatory MIRT models
from multivariate normally distributed factor (\(\theta\)) scores, or from
a user input matrix of \(\theta\)'s."><meta property="og:description" content="Simulates response patterns for compensatory and noncompensatory MIRT models
from multivariate normally distributed factor (\(\theta\)) scores, or from
a user input matrix of \(\theta\)'s."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mirt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.45.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/mirt-vignettes.html">UNKNOWN TITLE</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/philchalmers/mirt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate response patterns</h1>
      <small class="dont-index">Source: <a href="https://github.com/philchalmers/mirt/blob/main/R/simdata.R" class="external-link"><code>R/simdata.R</code></a></small>
      <div class="d-none name"><code>simdata.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulates response patterns for compensatory and noncompensatory MIRT models
from multivariate normally distributed factor (\(\theta\)) scores, or from
a user input matrix of \(\theta\)'s.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simdata</span><span class="op">(</span></span>
<span>  <span class="va">a</span>,</span>
<span>  <span class="va">d</span>,</span>
<span>  <span class="va">N</span>,</span>
<span>  <span class="va">itemtype</span>,</span>
<span>  sigma <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mu <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  guess <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  upper <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  rho <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nominal <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  t <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Theta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gpcm_mats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  returnList <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  equal.K <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  which.items <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mins <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  lca_cats <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prob.list <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-a">a<a class="anchor" aria-label="anchor" href="#arg-a"></a></dt>
<dd><p>a matrix/vector of slope parameters. If slopes are to be constrained to
zero then use <code>NA</code> or simply set them equal to 0</p></dd>


<dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>a matrix/vector of intercepts. The matrix should have as many columns as
the item with the largest number of categories, and filled empty locations
with <code>NA</code>. When a vector is used the test is assumed to consist only of dichotomous items
(because only one intercept per item is provided). When <code>itemtype = 'lca'</code> intercepts will not
be used</p></dd>


<dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>sample size</p></dd>


<dt id="arg-itemtype">itemtype<a class="anchor" aria-label="anchor" href="#arg-itemtype"></a></dt>
<dd><p>a character vector of length <code>nrow(a)</code> (or 1, if all the item types are
  the same) specifying the type of items to simulate. Inputs can either be the same as
  the inputs found in the <code>itemtype</code> argument in <code><a href="mirt.html">mirt</a></code> or the
  internal classes defined by the package. Typical <code>itemtype</code> inputs that
  are passed to <code><a href="mirt.html">mirt</a></code> are used then these will be converted into
  the respective internal classes automatically.</p>
<p>If the internal class of the object is specified instead, the inputs can
  be <code>'dich', 'graded', 'gpcm', 'sequential', 'nominal', 'nestlogit', 'partcomp', 'gumm'</code>,
  <code>'lca'</code>, and all the models under the Luo (2001) family (see <code><a href="mirt.html">mirt</a></code>),
  for dichotomous, graded, generalized partial credit, sequential,
  nominal, nested logit, partially compensatory,
  generalized graded unfolding model, latent class analysis model, and ordered unfolding models.
  Note that for the gpcm, nominal, and nested logit models there should
  be as many parameters as desired categories, however to parametrized them for meaningful
  interpretation the first category intercept should
  equal 0 for these models (second column for <code>'nestlogit'</code>, since first column is for the
  correct item traceline). For nested logit models the 'correct' category is always the lowest
  category (i.e., == 1). It may be helpful to use <code><a href="mod2values.html">mod2values</a></code> on data-sets that
  have already been estimated to understand the itemtypes more intimately</p></dd>


<dt id="arg-sigma">sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>a covariance matrix of the underlying distribution. Default is
the identity matrix. Used when <code>Theta</code> is not supplied</p></dd>


<dt id="arg-mu">mu<a class="anchor" aria-label="anchor" href="#arg-mu"></a></dt>
<dd><p>a mean vector of the underlying distribution. Default is a vector
of zeros. Used when <code>Theta</code> is not supplied</p></dd>


<dt id="arg-guess">guess<a class="anchor" aria-label="anchor" href="#arg-guess"></a></dt>
<dd><p>a vector of guessing parameters for each item; only applicable
for dichotomous items. Must be either a scalar value that will affect all of
the dichotomous items, or a vector with as many values as to be simulated items</p></dd>


<dt id="arg-upper">upper<a class="anchor" aria-label="anchor" href="#arg-upper"></a></dt>
<dd><p>same as <code>guess</code>, but for upper bound parameters</p></dd>


<dt id="arg-rho">rho<a class="anchor" aria-label="anchor" href="#arg-rho"></a></dt>
<dd><p>a matrix of <code>rho</code> values to be used for the Lui (2001) family of
ordered unfolding models (see <code><a href="mirt.html">mirt</a></code>) to control the latitude of
acceptance. All values must be positive</p></dd>


<dt id="arg-nominal">nominal<a class="anchor" aria-label="anchor" href="#arg-nominal"></a></dt>
<dd><p>a matrix of specific item category slopes for nominal models.
Should be the dimensions as the intercept specification with one less column, with <code>NA</code>
in locations where not applicable. Note that during estimation the first slope will be
constrained to 0 and the last will be constrained to the number of categories minus 1,
so it is best to set these as the values for the first and last categories as well</p></dd>


<dt id="arg-t">t<a class="anchor" aria-label="anchor" href="#arg-t"></a></dt>
<dd><p>matrix of t-values for the 'ggum' itemtype, where each row corresponds to a given item.
Also determines the number of categories, where <code>NA</code> can be used for non-applicable categories</p></dd>


<dt id="arg-theta">Theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>a user specified matrix of the underlying ability parameters,
where <code>nrow(Theta) == N</code> and <code>ncol(Theta) == ncol(a)</code>. When this is supplied the
<code>N</code> input is not required</p></dd>


<dt id="arg-gpcm-mats">gpcm_mats<a class="anchor" aria-label="anchor" href="#arg-gpcm-mats"></a></dt>
<dd><p>a list of matrices specifying the scoring scheme for generalized partial
credit models (see <code><a href="mirt.html">mirt</a></code> for details)</p></dd>


<dt id="arg-returnlist">returnList<a class="anchor" aria-label="anchor" href="#arg-returnlist"></a></dt>
<dd><p>logical; return a list containing the data, item objects defined
by <code>mirt</code> containing the population parameters and item structure, and the
latent trait matrix <code>Theta</code>? Default is FALSE</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>a single group object, typically returned by functions such as <code><a href="mirt.html">mirt</a></code> or
<code><a href="bfactor.html">bfactor</a></code>. Supplying this will render all other parameter elements (excluding the
<code>Theta</code>, <code>N</code>, <code>mu</code>, and <code>sigma</code> inputs) redundant (unless explicitly provided).
This input can therefore be used to create parametric bootstrap data whereby plausible data implied by the
estimated model can be generated and evaluated</p></dd>


<dt id="arg-equal-k">equal.K<a class="anchor" aria-label="anchor" href="#arg-equal-k"></a></dt>
<dd><p>logical; when a <code>model</code> input is supplied, should the generated data contain the same
number of categories as the original data indicated by <code>extract.mirt(model, 'K')</code>? Default is TRUE,
which will redrawn data until this condition is satisfied</p></dd>


<dt id="arg-which-items">which.items<a class="anchor" aria-label="anchor" href="#arg-which-items"></a></dt>
<dd><p>an integer vector used to indicate which items to simulate when a
<code>model</code> input is included. Default simulates all items</p></dd>


<dt id="arg-mins">mins<a class="anchor" aria-label="anchor" href="#arg-mins"></a></dt>
<dd><p>an integer vector (or single value to be used for each item) indicating what
the lowest category should be. If <code>model</code> is supplied then this will be extracted from
<code>slot(mod, 'Data')$mins</code>, otherwise the default is 0</p></dd>


<dt id="arg-lca-cats">lca_cats<a class="anchor" aria-label="anchor" href="#arg-lca-cats"></a></dt>
<dd><p>a vector indicating how many categories each lca item should have. If not supplied
then it is assumed that 2 categories should be generated for each item</p></dd>


<dt id="arg-prob-list">prob.list<a class="anchor" aria-label="anchor" href="#arg-prob-list"></a></dt>
<dd><p>an optional list containing matrix/data.frames of probabilities values for
each category to be simulated. This is useful when creating customized probability functions
to be sampled from</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Returns a data matrix simulated from the parameters, or a list containing the data,
item objects, and Theta matrix.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Chalmers, R., P. (2012). mirt: A Multidimensional Item Response Theory
Package for the R Environment. <em>Journal of Statistical Software, 48</em>(6), 1-29.
<a href="https://doi.org/10.18637/jss.v048.i06" class="external-link">doi:10.18637/jss.v048.i06</a></p>
<p>Reckase, M. D. (2009). <em>Multidimensional Item Response Theory</em>. New York: Springer.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Parameters from Reckase (2009), p. 153</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> <span class="fl">.7471</span>, <span class="fl">.0250</span>, <span class="fl">.1428</span>,</span></span>
<span class="r-in"><span> <span class="fl">.4595</span>, <span class="fl">.0097</span>, <span class="fl">.0692</span>,</span></span>
<span class="r-in"><span> <span class="fl">.8613</span>, <span class="fl">.0067</span>, <span class="fl">.4040</span>,</span></span>
<span class="r-in"><span><span class="fl">1.0141</span>, <span class="fl">.0080</span>, <span class="fl">.0470</span>,</span></span>
<span class="r-in"><span> <span class="fl">.5521</span>, <span class="fl">.0204</span>, <span class="fl">.1482</span>,</span></span>
<span class="r-in"><span><span class="fl">1.3547</span>, <span class="fl">.0064</span>, <span class="fl">.5362</span>,</span></span>
<span class="r-in"><span><span class="fl">1.3761</span>, <span class="fl">.0861</span>, <span class="fl">.4676</span>,</span></span>
<span class="r-in"><span> <span class="fl">.8525</span>, <span class="fl">.0383</span>, <span class="fl">.2574</span>,</span></span>
<span class="r-in"><span><span class="fl">1.0113</span>, <span class="fl">.0055</span>, <span class="fl">.2024</span>,</span></span>
<span class="r-in"><span> <span class="fl">.9212</span>, <span class="fl">.0119</span>, <span class="fl">.3044</span>,</span></span>
<span class="r-in"><span> <span class="fl">.0026</span>, <span class="fl">.0119</span>, <span class="fl">.8036</span>,</span></span>
<span class="r-in"><span> <span class="fl">.0008</span>, <span class="fl">.1905</span>,<span class="fl">1.1945</span>,</span></span>
<span class="r-in"><span> <span class="fl">.0575</span>, <span class="fl">.0853</span>, <span class="fl">.7077</span>,</span></span>
<span class="r-in"><span> <span class="fl">.0182</span>, <span class="fl">.3307</span>,<span class="fl">2.1414</span>,</span></span>
<span class="r-in"><span> <span class="fl">.0256</span>, <span class="fl">.0478</span>, <span class="fl">.8551</span>,</span></span>
<span class="r-in"><span> <span class="fl">.0246</span>, <span class="fl">.1496</span>, <span class="fl">.9348</span>,</span></span>
<span class="r-in"><span> <span class="fl">.0262</span>, <span class="fl">.2872</span>,<span class="fl">1.3561</span>,</span></span>
<span class="r-in"><span> <span class="fl">.0038</span>, <span class="fl">.2229</span>, <span class="fl">.8993</span>,</span></span>
<span class="r-in"><span> <span class="fl">.0039</span>, <span class="fl">.4720</span>, <span class="fl">.7318</span>,</span></span>
<span class="r-in"><span> <span class="fl">.0068</span>, <span class="fl">.0949</span>, <span class="fl">.6416</span>,</span></span>
<span class="r-in"><span> <span class="fl">.3073</span>, <span class="fl">.9704</span>, <span class="fl">.0031</span>,</span></span>
<span class="r-in"><span> <span class="fl">.1819</span>, <span class="fl">.4980</span>, <span class="fl">.0020</span>,</span></span>
<span class="r-in"><span> <span class="fl">.4115</span>,<span class="fl">1.1136</span>, <span class="fl">.2008</span>,</span></span>
<span class="r-in"><span> <span class="fl">.1536</span>,<span class="fl">1.7251</span>, <span class="fl">.0345</span>,</span></span>
<span class="r-in"><span> <span class="fl">.1530</span>, <span class="fl">.6688</span>, <span class="fl">.0020</span>,</span></span>
<span class="r-in"><span> <span class="fl">.2890</span>,<span class="fl">1.2419</span>, <span class="fl">.0220</span>,</span></span>
<span class="r-in"><span> <span class="fl">.1341</span>,<span class="fl">1.4882</span>, <span class="fl">.0050</span>,</span></span>
<span class="r-in"><span> <span class="fl">.0524</span>, <span class="fl">.4754</span>, <span class="fl">.0012</span>,</span></span>
<span class="r-in"><span> <span class="fl">.2139</span>, <span class="fl">.4612</span>, <span class="fl">.0063</span>,</span></span>
<span class="r-in"><span> <span class="fl">.1761</span>,<span class="fl">1.1200</span>, <span class="fl">.0870</span><span class="op">)</span>,<span class="fl">30</span>,<span class="fl">3</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">*</span><span class="fl">1.702</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1826</span>,<span class="op">-</span><span class="fl">.1924</span>,<span class="op">-</span><span class="fl">.4656</span>,<span class="op">-</span><span class="fl">.4336</span>,<span class="op">-</span><span class="fl">.4428</span>,<span class="op">-</span><span class="fl">.5845</span>,<span class="op">-</span><span class="fl">1.0403</span>,</span></span>
<span class="r-in"><span>  <span class="fl">.6431</span>,<span class="fl">.0122</span>,<span class="fl">.0912</span>,<span class="fl">.8082</span>,<span class="op">-</span><span class="fl">.1867</span>,<span class="fl">.4533</span>,<span class="op">-</span><span class="fl">1.8398</span>,<span class="fl">.4139</span>,</span></span>
<span class="r-in"><span>  <span class="op">-</span><span class="fl">.3004</span>,<span class="op">-</span><span class="fl">.1824</span>,<span class="fl">.5125</span>,<span class="fl">1.1342</span>,<span class="fl">.0230</span>,<span class="fl">.6172</span>,<span class="op">-</span><span class="fl">.1955</span>,<span class="op">-</span><span class="fl">.3668</span>,</span></span>
<span class="r-in"><span>  <span class="op">-</span><span class="fl">1.7590</span>,<span class="op">-</span><span class="fl">.2434</span>,<span class="fl">.4925</span>,<span class="op">-</span><span class="fl">.3410</span>,<span class="fl">.2896</span>,<span class="fl">.006</span>,<span class="fl">.0329</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">1.702</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.4</span>, <span class="op">-</span><span class="fl">.7</span>, <span class="fl">.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.21</span>,<span class="fl">.297</span>,<span class="fl">1.232</span>,<span class="fl">.297</span>,<span class="fl">.81</span>,<span class="fl">.252</span>,<span class="fl">1.232</span>,<span class="fl">.252</span>,<span class="fl">1.96</span><span class="op">)</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">dataset1</span> <span class="op">&lt;-</span> <span class="fu">simdata</span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="fl">2000</span>, itemtype <span class="op">=</span> <span class="st">'2PL'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2,000 × 30</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>      0      0      0      0      0      0      0      1      1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>      1      0      0      0      1      0      1      1      1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>      1      1      1      1      1      1      0      1      1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>      0      0      0      0      0      0      0      0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>      0      0      0      0      1      1      0      1      0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>      1      1      1      1      1      1      1      1      1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>      0      1      0      0      0      0      0      1      0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>      0      0      0      1      0      0      0      1      0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>      0      1      0      0      1      0      0      0      0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>      1      0      1      0      0      0      0      0      1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1,990 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 20 more variables: Item_11 &lt;dbl&gt;, Item_12 &lt;dbl&gt;, Item_13 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Item_14 &lt;dbl&gt;, Item_15 &lt;dbl&gt;, Item_16 &lt;dbl&gt;, Item_17 &lt;dbl&gt;, Item_18 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Item_19 &lt;dbl&gt;, Item_20 &lt;dbl&gt;, Item_21 &lt;dbl&gt;, Item_22 &lt;dbl&gt;, Item_23 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Item_24 &lt;dbl&gt;, Item_25 &lt;dbl&gt;, Item_26 &lt;dbl&gt;, Item_27 &lt;dbl&gt;, Item_28 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Item_29 &lt;dbl&gt;, Item_30 &lt;dbl&gt;</span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">dataset2</span> <span class="op">&lt;-</span> <span class="fu">simdata</span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="fl">2000</span>, itemtype <span class="op">=</span> <span class="st">'2PL'</span>, mu <span class="op">=</span> <span class="va">mu</span>, sigma <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2,000 × 30</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>      0      0      0      0      0      0      0      0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>      1      0      1      1      0      0      0      1      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>      0      0      0      0      0      0      0      0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>      0      0      1      0      1      0      0      1      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>      1      1      0      1      0      1      0      1      0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>      1      1      0      0      0      0      0      0      1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>      0      1      0      0      0      0      0      0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>      1      1      0      1      0      0      0      0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>      1      0      1      1      0      1      0      1      1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>      0      0      1      0      0      0      0      1      0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1,990 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 20 more variables: Item_11 &lt;dbl&gt;, Item_12 &lt;dbl&gt;, Item_13 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Item_14 &lt;dbl&gt;, Item_15 &lt;dbl&gt;, Item_16 &lt;dbl&gt;, Item_17 &lt;dbl&gt;, Item_18 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Item_19 &lt;dbl&gt;, Item_20 &lt;dbl&gt;, Item_21 &lt;dbl&gt;, Item_22 &lt;dbl&gt;, Item_23 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Item_24 &lt;dbl&gt;, Item_25 &lt;dbl&gt;, Item_26 &lt;dbl&gt;, Item_27 &lt;dbl&gt;, Item_28 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Item_29 &lt;dbl&gt;, Item_30 &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#mod &lt;- mirt(dataset1, 3, method = 'MHRM')</span></span></span>
<span class="r-in"><span><span class="co">#coef(mod)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Unidimensional graded response model with 5 categories each</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">.2</span>,<span class="fl">.3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># for the graded model, ensure that there is enough space between the intercepts,</span></span></span>
<span class="r-in"><span><span class="co"># otherwise closer categories will not be selected often (minimum distance of 0.3 here)</span></span></span>
<span class="r-in"><span><span class="va">diffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">*</span><span class="fl">4</span>, <span class="fl">.3</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">20</span><span class="op">)</span>, <span class="fl">1</span>, <span class="va">cumsum</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">diffs</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="op">(</span><span class="va">diffs</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">diffs</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">diffs</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">simdata</span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="fl">500</span>, itemtype <span class="op">=</span> <span class="st">'graded'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 500 × 20</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>      3      4      0      3      4      0      0      4      4       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>      3      4      3      0      4      0      4      4      4       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>      0      3      0      2      4      0      0      0      0       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>      4      4      0      4      4      0      2      0      4       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>      0      0      0      0      2      0      1      0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>      0      4      4      4      4      4      4      1      4       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>      4      4      0      0      4      4      4      0      0       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>      0      4      0      0      4      0      4      0      4       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>      0      3      0      2      4      1      0      0      4       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>      3      2      0      0      4      4      4      4      1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 490 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 10 more variables: Item_11 &lt;dbl&gt;, Item_12 &lt;dbl&gt;, Item_13 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Item_14 &lt;dbl&gt;, Item_15 &lt;dbl&gt;, Item_16 &lt;dbl&gt;, Item_17 &lt;dbl&gt;, Item_18 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Item_19 &lt;dbl&gt;, Item_20 &lt;dbl&gt;</span></span>
<span class="r-in"><span><span class="co"># mod &lt;- mirt(dat)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### An example of a mixed item, bifactor loadings pattern with correlated specific factors</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="fl">.8</span>,<span class="fl">.4</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span><span class="fl">.4</span>,<span class="fl">.4</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span><span class="fl">.7</span>,<span class="fl">.4</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span><span class="fl">.8</span>,<span class="cn">NA</span>,<span class="fl">.4</span>,</span></span>
<span class="r-in"><span><span class="fl">.4</span>,<span class="cn">NA</span>,<span class="fl">.4</span>,</span></span>
<span class="r-in"><span><span class="fl">.7</span>,<span class="cn">NA</span>,<span class="fl">.4</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">3</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="op">-</span><span class="fl">1.0</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span> <span class="fl">1.5</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span> <span class="fl">0.0</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span><span class="fl">0.0</span>,<span class="op">-</span><span class="fl">1.0</span>,<span class="fl">1.5</span>,  <span class="co">#the first 0 here is the recommended constraint for nominal</span></span></span>
<span class="r-in"><span><span class="fl">0.0</span>,<span class="fl">1.0</span>,<span class="op">-</span><span class="fl">1</span>, <span class="co">#the first 0 here is the recommended constraint for gpcm</span></span></span>
<span class="r-in"><span><span class="fl">2.0</span>,<span class="fl">0.0</span>,<span class="cn">NA</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">3</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">nominal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># the first 0 and last (ncat - 1) = 2 values are the recommended constraints</span></span></span>
<span class="r-in"><span><span class="va">nominal</span><span class="op">[</span><span class="fl">4</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1.2</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sigma</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">sigma</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">.25</span></span></span>
<span class="r-in"><span><span class="va">items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'2PL'</span>,<span class="st">'2PL'</span>,<span class="st">'2PL'</span>,<span class="st">'nominal'</span>,<span class="st">'gpcm'</span>,<span class="st">'graded'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu">simdata</span><span class="op">(</span><span class="va">a</span>,<span class="va">d</span>,<span class="fl">2000</span>,<span class="va">items</span>,sigma<span class="op">=</span><span class="va">sigma</span>,nominal<span class="op">=</span><span class="va">nominal</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2,000 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Item_1 Item_2 Item_3 Item_4 Item_5 Item_6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>      0      1      0      2      1      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>      1      1      1      2      1      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>      1      0      0      0      1      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>      0      1      1      2      2      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>      0      0      0      0      0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>      0      0      1      2      1      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>      0      1      1      1      1      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>      1      1      0      2      1      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>      0      1      0      0      1      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>      1      1      1      2      1      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1,990 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#mod &lt;- bfactor(dataset, c(1,1,1,2,2,2), itemtype=c(rep('2PL', 3), 'nominal', 'gpcm','graded'))</span></span></span>
<span class="r-in"><span><span class="co">#coef(mod)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Convert standardized factor loadings to slopes</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">F2a</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">F</span>, <span class="va">D</span><span class="op">=</span><span class="fl">1.702</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">h2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="cn">F</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">a</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="cn">F</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">h2</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">D</span></span></span>
<span class="r-in"><span>    <span class="va">a</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="cn">F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.7</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]  0.5</span>
<span class="r-in"><span><span class="op">(</span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">F2a</span><span class="op">(</span><span class="cn">F</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 1.6682937</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 1.6682937</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 1.6682937</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 1.6682937</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 1.6682937</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.9826502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.9826502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.9826502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.9826502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.9826502</span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">simdata</span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="fl">5000</span>, itemtype <span class="op">=</span> <span class="st">'2PL'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 5,000 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>      0      1      0      0      0      0      1      0      1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>      1      1      0      0      0      0      1      0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>      0      1      0      0      0      0      0      0      1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>      1      0      0      0      0      0      1      1      1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>      1      1      1      0      0      0      1      1      1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>      1      1      1      1      1      1      1      0      1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>      0      1      1      0      0      0      1      0      1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>      1      0      1      0      0      0      1      0      1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>      0      1      0      1      0      0      1      0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>      0      1      0      0      0      0      1      0      1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 4,990 more rows</span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">items</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                a1           d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1.5912124  0.09329250 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1.6611479  0.77704003 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1.6100289  0.04348744 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  1.5251147 -0.39866322 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1.7126206 -0.69888431 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.9352647 -1.71863199 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.9211469  0.73522267 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.9893392 -1.25501247 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.9999014  0.41687594 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.9416579 -1.00423353 0 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            F1    h2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.683 0.466</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  0.698 0.488</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.687 0.472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.667 0.445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  0.709 0.503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.482 0.232</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.476 0.227</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.503 0.253</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.507 0.257</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.484 0.234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SS loadings:  3.577 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion Var:  0.358 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor correlations: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1  1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">dat</span>, <span class="st">'F1 = 1-10</span></span></span>
<span class="r-in"><span><span class="st">                   CONSTRAIN = (1-5, a1), (6-10, a1)'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            F1    h2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.689 0.475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  0.689 0.475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.689 0.475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.689 0.475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  0.689 0.475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.491 0.241</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.491 0.241</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.491 0.241</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.491 0.241</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.491 0.241</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SS loadings:  3.576 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion Var:  0.358 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor correlations: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1  1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod2</span>, <span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           AIC    SABIC       HQ      BIC    logLik    X2 df   p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod2 58058.43 58098.51 58085.85 58136.64 -29017.22             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod  58068.01 58134.80 58113.69 58198.35 -29014.01 6.425  8 0.6</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Convert classical 3PL paramerization into slope-intercept form</span></span></span>
<span class="r-in"><span><span class="va">nitems</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="va">as</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">nitems</span>, <span class="fl">.2</span>, <span class="fl">.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nitems</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">nitems</span>, <span class="fl">5</span>, <span class="fl">17</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># convert first item (only intercepts differ in resulting transformation)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="traditional2mirt.html">traditional2mirt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'a'</span><span class="op">=</span><span class="va">as</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">'b'</span><span class="op">=</span><span class="va">bs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">'g'</span><span class="op">=</span><span class="va">gs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">'u'</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span>, cls<span class="op">=</span><span class="st">'3PL'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         a1          d          g          u </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.2795115 -0.1107008  0.2525144  1.0000000 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># convert all difficulties to intercepts</span></span></span>
<span class="r-in"><span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">nitems</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nitems</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">ds</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="traditional2mirt.html">traditional2mirt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'a'</span><span class="op">=</span><span class="va">as</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">'b'</span><span class="op">=</span><span class="va">bs</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">'g'</span><span class="op">=</span><span class="va">gs</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">'u'</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                             cls<span class="op">=</span><span class="st">'3PL'</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">simdata</span><span class="op">(</span><span class="va">as</span>, <span class="va">ds</span>, N<span class="op">=</span><span class="fl">5000</span>, guess<span class="op">=</span><span class="va">gs</span>, itemtype <span class="op">=</span> <span class="st">'3PL'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate with beta prior for guessing parameters</span></span></span>
<span class="r-in"><span><span class="co"># mod &lt;- mirt(dat, model="Theta = 1-50</span></span></span>
<span class="r-in"><span><span class="co">#                         PRIOR = (1-50, g, expbeta, 5, 17)", itemtype = '3PL')</span></span></span>
<span class="r-in"><span><span class="co"># coef(mod, simplify=TRUE, IRTpars=TRUE)$items</span></span></span>
<span class="r-in"><span><span class="co"># data.frame(as, bs, gs, us=1)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Unidimensional nonlinear factor pattern</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">theta</span>,<span class="va">theta</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="fl">.8</span>,<span class="fl">.4</span>,</span></span>
<span class="r-in"><span><span class="fl">.4</span>,<span class="fl">.4</span>,</span></span>
<span class="r-in"><span><span class="fl">.7</span>,<span class="fl">.4</span>,</span></span>
<span class="r-in"><span><span class="fl">.8</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span><span class="fl">.4</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span><span class="fl">.7</span>,<span class="cn">NA</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">itemtype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>,<span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">nonlindata</span> <span class="op">&lt;-</span> <span class="fu">simdata</span><span class="op">(</span>a<span class="op">=</span><span class="va">a</span>, d<span class="op">=</span><span class="va">d</span>, itemtype<span class="op">=</span><span class="va">itemtype</span>, Theta<span class="op">=</span><span class="va">Theta</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#model &lt;- '</span></span></span>
<span class="r-in"><span><span class="co">#F1 = 1-6</span></span></span>
<span class="r-in"><span><span class="co">#(F1 * F1) = 1-3'</span></span></span>
<span class="r-in"><span><span class="co">#mod &lt;- mirt(nonlindata, model)</span></span></span>
<span class="r-in"><span><span class="co">#coef(mod)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### 2PLNRM model for item 4 (with 4 categories), 2PL otherwise</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">0</span>,<span class="fl">.2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># first column of item 4 is the intercept for the correct category of 2PL model,</span></span></span>
<span class="r-in"><span><span class="co">#    otherwise nominal model configuration</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="op">-</span><span class="fl">1.0</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span> <span class="fl">1.5</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span> <span class="fl">0.0</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,</span></span>
<span class="r-in"><span> <span class="fl">1</span>, <span class="fl">0.0</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">4</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">nominal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nominal</span><span class="op">[</span><span class="fl">4</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">0</span>,<span class="fl">.5</span>,<span class="fl">.6</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">'nestlogit'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu">simdata</span><span class="op">(</span><span class="va">a</span>,<span class="va">d</span>,<span class="fl">2000</span>,<span class="va">items</span>,nominal<span class="op">=</span><span class="va">nominal</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#mod &lt;- mirt(dataset, 1, itemtype = c('2PL', '2PL', '2PL', '2PLNRM'), key=c(NA,NA,NA,0))</span></span></span>
<span class="r-in"><span><span class="co">#coef(mod)</span></span></span>
<span class="r-in"><span><span class="co">#itemplot(mod,4)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># return list of simulation parameters</span></span></span>
<span class="r-in"><span><span class="va">listobj</span> <span class="op">&lt;-</span> <span class="fu">simdata</span><span class="op">(</span><span class="va">a</span>,<span class="va">d</span>,<span class="fl">2000</span>,<span class="va">items</span>,nominal<span class="op">=</span><span class="va">nominal</span>, returnList<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">listobj</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ itemobjects:List of 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ :Formal class 'dich' [package "mirt"] with 23 slots</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ par          : num [1:4] 0.863 -1 -999 999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. .. ..- attr(*, "na.action")= 'omit' int [1:3] 3 4 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ SEpar        : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ parnames     : chr(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ est          : logi(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ dps          :function ()  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ dps2         :function ()  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ constr       : logi(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ itemclass    : int(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ parnum       : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ nfact        : int 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ nfixedeffects: num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ fixed.design : num[0 , 0 ] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ dat          : num[0 , 0 ] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ ncat         : int 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ gradient     : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ hessian      : num[0 , 0 ] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ itemtrace    : num[0 , 0 ] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ lbound       : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ ubound       : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ any.prior    : logi(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ prior.type   : int(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ prior_1      : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ prior_2      : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ :Formal class 'dich' [package "mirt"] with 23 slots</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ par          : num [1:4] 1.25 1.5 -999 999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. .. ..- attr(*, "na.action")= 'omit' int [1:3] 3 4 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ SEpar        : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ parnames     : chr(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ est          : logi(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ dps          :function ()  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ dps2         :function ()  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ constr       : logi(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ itemclass    : int(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ parnum       : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ nfact        : int 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ nfixedeffects: num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ fixed.design : num[0 , 0 ] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ dat          : num[0 , 0 ] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ ncat         : int 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ gradient     : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ hessian      : num[0 , 0 ] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ itemtrace    : num[0 , 0 ] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ lbound       : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ ubound       : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ any.prior    : logi(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ prior.type   : int(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ prior_1      : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ prior_2      : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ :Formal class 'dich' [package "mirt"] with 23 slots</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ par          : num [1:4] 1.02 0 -999 999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. .. ..- attr(*, "na.action")= 'omit' int [1:3] 3 4 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ SEpar        : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ parnames     : chr(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ est          : logi(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ dps          :function ()  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ dps2         :function ()  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ constr       : logi(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ itemclass    : int(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ parnum       : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ nfact        : int 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ nfixedeffects: num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ fixed.design : num[0 , 0 ] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ dat          : num[0 , 0 ] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ ncat         : int 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ gradient     : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ hessian      : num[0 , 0 ] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ itemtrace    : num[0 , 0 ] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ lbound       : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ ubound       : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ any.prior    : logi(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ prior.type   : int(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ prior_1      : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ prior_2      : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ :Formal class 'nestlogit' [package "mirt"] with 24 slots</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ correctcat   : int 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ par          : num [1:10] 0.771 1 -999 999 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ SEpar        : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ parnames     : chr(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ est          : logi(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ dps          :function ()  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ dps2         :function ()  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ constr       : logi(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ itemclass    : int(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ parnum       : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ nfact        : int 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ nfixedeffects: num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ fixed.design : num[0 , 0 ] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ dat          : num[0 , 0 ] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ ncat         : int 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ gradient     : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ hessian      : num[0 , 0 ] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ itemtrace    : num[0 , 0 ] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ lbound       : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ ubound       : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ any.prior    : logi(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ prior.type   : int(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ prior_1      : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ prior_2      : num(0) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ data       : tibble [2,000 × 4] (S3: tbl_df/tbl/data.frame)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ Item_1: num [1:2000] 1 1 1 0 0 1 0 1 0 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ Item_2: num [1:2000] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ Item_3: num [1:2000] 0 1 1 1 0 1 0 0 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ Item_4: num [1:2000] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ Theta      : num [1:2000, 1] -0.399 1.931 1.621 -0.424 1.343 ...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate dataset from converged model</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">Science</span>, <span class="fl">1</span>, itemtype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'gpcm'</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">'nominal'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">simdata</span><span class="op">(</span>model<span class="op">=</span><span class="va">mod</span>, N<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Comfort Work Future Benefit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]       4    3      3       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]       3    2      3       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]       3    2      4       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]       4    3      4       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]       3    3      2       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]       2    3      3       2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">simdata</span><span class="op">(</span>model<span class="op">=</span><span class="va">mod</span>, Theta<span class="op">=</span><span class="va">Theta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Comfort Work Future Benefit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]       3    3      4       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]       4    2      3       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]       3    2      3       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]       3    3      3       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]       3    3      3       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]       3    3      4       3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># alternatively, define a suitable object with functions from the mirtCAT package</span></span></span>
<span class="r-in"><span><span class="co"># help(generate.mirt_object)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/philchalmers/mirtCAT" class="external-link">mirtCAT</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: shiny</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">nitems</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="va">a1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">nitems</span>, <span class="fl">.2</span>,<span class="fl">.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nitems</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">nitems</span>, <span class="fl">20</span>, <span class="fl">80</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a1<span class="op">=</span><span class="va">a1</span>, d<span class="op">=</span><span class="va">d</span>, g<span class="op">=</span><span class="va">g</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pars</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          a1          d         g</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.1271598 -0.6479570 0.2637693</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.3539630 -1.4832170 0.1903528</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1.1640507  0.3390045 0.1782070</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.9568311 -1.3578148 0.1389409</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 1.0394247  0.3835373 0.2361323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 1.1479152  1.3522255 0.1990177</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mirtCAT/man/generate.mirt_object.html" class="external-link">generate.mirt_object</a></span><span class="op">(</span><span class="va">pars</span>, <span class="st">'3PL'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">simdata</span><span class="op">(</span>N<span class="op">=</span><span class="fl">200</span>, model<span class="op">=</span><span class="va">obj</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### 10 item GGUMs test with 4 categories each</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">.2</span>, <span class="fl">.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="co">#passed to d= input, but used as the b parameters</span></span></span>
<span class="r-in"><span><span class="va">diffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">*</span><span class="fl">3</span>, <span class="fl">.3</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fl">1</span>, <span class="va">cumsum</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="op">(</span><span class="va">diffs</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">diffs</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">simdata</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="fl">1000</span>, <span class="st">'ggum'</span>, t<span class="op">=</span><span class="va">t</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, <span class="va">table</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0    477    496    674    332    438    417    558    458    475     513</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    299    309    218    388    364    365    288    320    314     305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    153    155     79    232    158    175    109    167    162     138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     71     40     29     48     40     43     45     55     49      44</span>
<span class="r-in"><span><span class="co"># mod &lt;- mirt(dat, 1, 'ggum')</span></span></span>
<span class="r-in"><span><span class="co"># coef(mod)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### 10 items with the hyperbolic cosine model with differing category lengths</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, nrow<span class="op">=</span><span class="fl">10</span>, ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rho</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>   <span class="co"># first two items have K=2 categories</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">simdata</span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="fl">1000</span>, <span class="st">'hcm'</span>, rho<span class="op">=</span><span class="va">rho</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="itemstats.html">itemstats</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $overall</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     N mean_total.score sd_total.score ave.r  sd.r alpha SEM.alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1000            8.522          2.709 0.015 0.212 0.119     2.543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $itemstats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            N K  mean    sd total.r total.r_if_rm alpha_if_rm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1000 2 0.475 0.500   0.128        -0.057       0.146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1000 2 0.343 0.475   0.352         0.186       0.056</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1000 3 0.574 0.796   0.367         0.079       0.082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  1000 3 0.989 0.895   0.531         0.231      -0.038</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1000 3 1.159 0.867   0.163        -0.158       0.234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  1000 3 0.911 0.874   0.511         0.214      -0.021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1000 3 1.001 0.884   0.525         0.228      -0.034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  1000 3 0.965 0.896   0.016        -0.300       0.323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  1000 3 0.886 0.895   0.517         0.213      -0.023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 1000 3 1.219 0.861   0.210        -0.110       0.204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $proportions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             0     1     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.525 0.475    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  0.657 0.343    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.620 0.186 0.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.406 0.199 0.395</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  0.309 0.223 0.468</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.430 0.229 0.341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.390 0.219 0.391</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.419 0.197 0.384</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.464 0.186 0.350</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.285 0.211 0.504</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># mod &lt;- mirt(dat, 1, 'hcm')</span></span></span>
<span class="r-in"><span><span class="co"># list(est=coef(mod, simplify=TRUE)$items, pop=cbind(a, d, log(rho)))</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">######</span></span></span>
<span class="r-in"><span><span class="co"># prob.list example</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># custom probability function that returns a matrix</span></span></span>
<span class="r-in"><span><span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">theta</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">P</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">a</span> <span class="op">*</span> <span class="op">(</span><span class="va">theta</span><span class="op">-</span><span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">P</span>, <span class="va">P</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">prob.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nitems</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">nitems</span>, <span class="fl">.2</span>, <span class="fl">.2</span><span class="op">)</span>; <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nitems</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nitems</span><span class="op">)</span> <span class="va">prob.list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">fun</span><span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">b</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">theta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">prob.list</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ : num [1:100, 1:2] 0.836 0.68 0.865 0.317 0.645 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ : num [1:100, 1:2] 0.771 0.554 0.813 0.179 0.509 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ : num [1:100, 1:2] 0.75 0.569 0.788 0.239 0.532 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ : num [1:100, 1:2] 0.737 0.503 0.785 0.146 0.457 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ : num [1:100, 1:2] 0.828 0.669 0.858 0.308 0.634 ...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">simdata</span><span class="op">(</span>prob.list<span class="op">=</span><span class="va">prob.list</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Item_1 Item_2 Item_3 Item_4 Item_5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]      0      0      0      1      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]      0      0      0      1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]      0      0      0      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]      1      1      0      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]      1      1      0      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]      0      1      0      1      0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># prob.list input is useful when defining custom items as well</span></span></span>
<span class="r-in"><span><span class="va">name</span> <span class="op">&lt;-</span> <span class="st">'old2PL'</span></span></span>
<span class="r-in"><span><span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">.5</span>, b <span class="op">=</span> <span class="op">-</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">P.old2PL</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span>,<span class="va">Theta</span>, <span class="va">ncat</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>     <span class="va">a</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>     <span class="va">b</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span>     <span class="va">P1</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">a</span><span class="op">*</span><span class="op">(</span><span class="va">Theta</span> <span class="op">-</span> <span class="va">b</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">P1</span>, <span class="va">P1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="createItem.html">createItem</a></span><span class="op">(</span><span class="va">name</span>, par<span class="op">=</span><span class="va">par</span>, est<span class="op">=</span><span class="va">est</span>, P<span class="op">=</span><span class="va">P.old2PL</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">prob.list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">@</span><span class="va">P</span><span class="op">(</span><span class="va">x</span><span class="op">@</span><span class="va">par</span>, <span class="va">theta</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

