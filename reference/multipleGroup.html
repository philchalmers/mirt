<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Multiple Group Estimation — multipleGroup • mirt</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multiple Group Estimation — multipleGroup"><meta name="description" content="multipleGroup performs a full-information
maximum-likelihood multiple group analysis for any combination of dichotomous and polytomous
data under the item response theory paradigm using either Cai's (2010)
Metropolis-Hastings Robbins-Monro (MHRM) algorithm or with an EM algorithm approach. This
function may be used for detecting differential item functioning (DIF), thought the
DIF function may provide a more convenient approach. If the grouping
variable is not specified then the dentype input can be modified to fit
mixture models to estimate any latent group components."><meta property="og:description" content="multipleGroup performs a full-information
maximum-likelihood multiple group analysis for any combination of dichotomous and polytomous
data under the item response theory paradigm using either Cai's (2010)
Metropolis-Hastings Robbins-Monro (MHRM) algorithm or with an EM algorithm approach. This
function may be used for detecting differential item functioning (DIF), thought the
DIF function may provide a more convenient approach. If the grouping
variable is not specified then the dentype input can be modified to fit
mixture models to estimate any latent group components."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mirt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.45.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/mirt-vignettes.html">UNKNOWN TITLE</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/philchalmers/mirt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Multiple Group Estimation</h1>
      <small class="dont-index">Source: <a href="https://github.com/philchalmers/mirt/blob/main/R/multipleGroup.R" class="external-link"><code>R/multipleGroup.R</code></a></small>
      <div class="d-none name"><code>multipleGroup.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>multipleGroup</code> performs a full-information
maximum-likelihood multiple group analysis for any combination of dichotomous and polytomous
data under the item response theory paradigm using either Cai's (2010)
Metropolis-Hastings Robbins-Monro (MHRM) algorithm or with an EM algorithm approach. This
function may be used for detecting differential item functioning (DIF), thought the
<code><a href="DIF.html">DIF</a></code> function may provide a more convenient approach. If the grouping
variable is not specified then the <code>dentype</code> input can be modified to fit
mixture models to estimate any latent group components.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">multipleGroup</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  model <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">group</span>,</span>
<span>  itemtype <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  invariance <span class="op">=</span> <span class="st">""</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"EM"</span>,</span>
<span>  dentype <span class="op">=</span> <span class="st">"Gaussian"</span>,</span>
<span>  itemdesign <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  item.formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a <code>matrix</code> or <code>data.frame</code> that consists of
numerically ordered data, organized in the form of integers,
 with missing data coded as <code>NA</code></p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>string to be passed to, or a model object returned from, <code><a href="mirt.model.html">mirt.model</a></code>
declaring how the global model is to be estimated (useful to apply constraints here)</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>a <code>character</code> or <code>factor</code> vector indicating group membership. If a <code>character</code>
vector is supplied this will be automatically transformed into a <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></code> variable.
As well, the first level of the (factorized) grouping variable will be treated as the "reference" group</p></dd>


<dt id="arg-itemtype">itemtype<a class="anchor" aria-label="anchor" href="#arg-itemtype"></a></dt>
<dd><p>can be same type of input as is documented in <code><a href="mirt.html">mirt</a></code>, however may also be a
<code>ngroups</code> by <code>nitems</code> matrix specifying the type of IRT models for each group, respectively.
Rows of this input correspond to the levels of the <code>group</code> input. For mixture models the rows correspond
to the respective mixture grouping variables to be constructed, and the IRT models should be within these
mixtures</p></dd>


<dt id="arg-invariance">invariance<a class="anchor" aria-label="anchor" href="#arg-invariance"></a></dt>
<dd><p>a character vector containing the following possible options:</p><dl><dt><code>'free_mean'</code> or <code>'free_means'</code></dt>
<dd><p>freely estimate all latent means in all focal groups
      (reference group constrained to a vector of 0's)</p></dd>

    <dt><code>'free_var'</code>, <code>'free_vars'</code>, <code>'free_variance'</code>, or <code>'free_variances'</code></dt>
<dd><p>freely estimate all latent variances in focal groups
      (reference group variances all constrained to 1)</p></dd>

    <dt><code>'slopes'</code></dt>
<dd><p>to constrain all the slopes to be equal across all groups</p></dd>

    <dt><code>'intercepts'</code></dt>
<dd><p>to constrain all the intercepts to be equal across all
      groups, note for nominal models this also includes the category specific slope parameters</p></dd>


</dl><p>Additionally, specifying specific item name bundles (from <code>colnames(data)</code>) will
  constrain all freely estimated parameters in each item to be equal across groups. This is
  useful for selecting 'anchor' items for vertical and horizontal scaling, and for detecting
  differential item functioning (DIF) across groups</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>a character object that is either <code>'EM'</code>, <code>'QMCEM'</code>, or <code>'MHRM'</code>
(default is <code>'EM'</code>). See <code><a href="mirt.html">mirt</a></code> for details</p></dd>


<dt id="arg-dentype">dentype<a class="anchor" aria-label="anchor" href="#arg-dentype"></a></dt>
<dd><p>type of density form to use for the latent trait parameters. Current options include
  all of the methods described in <code><a href="mirt.html">mirt</a></code>, as well as</p>
<p></p><ul><li><p><code>'mixture-#'</code> estimates mixtures of Gaussian distributions,
      where the <code>#</code> placeholder represents the number of potential grouping variables
      (e.g., <code>'mixture-3'</code> will estimate 3 underlying classes). Each class is
      assigned the group name <code>MIXTURE_#</code>, where <code>#</code> is the class number.
      Note that internally the mixture coefficients are stored as log values where
      the first mixture group coefficient is fixed at 0</p></li>
</ul></dd>


<dt id="arg-itemdesign">itemdesign<a class="anchor" aria-label="anchor" href="#arg-itemdesign"></a></dt>
<dd><p>see <code><a href="mirt.html">mirt</a></code> for details</p></dd>


<dt id="arg-item-formula">item.formula<a class="anchor" aria-label="anchor" href="#arg-item-formula"></a></dt>
<dd><p>see <code><a href="mirt.html">mirt</a></code> for details</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments to be passed to the estimation engine. See <code><a href="mirt.html">mirt</a></code>
for details and examples</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>function returns an object of class <code>MultipleGroupClass</code>
  (<a href="MultipleGroupClass-class.html">MultipleGroupClass-class</a>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>By default the estimation in <code>multipleGroup</code> assumes that the models are maximally
independent, and therefore could initially be performed by sub-setting the data and running
identical models with <code>mirt</code> and aggregating the results (e.g., log-likelihood).
However, constrains may be automatically imposed across groups by invoking various
<code>invariance</code> keywords. Users may also supply a list of parameter equality constraints
to by <code>constrain</code> argument, of define equality constraints using the
<code><a href="mirt.model.html">mirt.model</a></code> syntax (recommended).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Chalmers, R., P. (2012). mirt: A Multidimensional Item Response Theory
Package for the R Environment. <em>Journal of Statistical Software, 48</em>(6), 1-29.
<a href="https://doi.org/10.18637/jss.v048.i06" class="external-link">doi:10.18637/jss.v048.i06</a></p>
<p>Magnus, B. E. and  Garnier-Villarreal (2022). A multidimensional zero-inflated
graded response model for ordinal symptom data. <em>Psychological Methods</em>, 27, 261-279.</p>
<p>Wall, M., M., Park, J., Y., and Moustaki I. (2015). IRT modeling in the presence of
zero-inflation with application to psychiatric disorder severity.
<em>Applied Psychological Measurement</em> 39: 583-597.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mirt.html">mirt</a></code>, <code><a href="DIF.html">DIF</a></code>, <code><a href="extract.group.html">extract.group</a></code>, <code><a href="DRF.html">DRF</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># single factor</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">1</span>,<span class="fl">.3</span><span class="op">)</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">0</span>,<span class="fl">.7</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">itemtype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">dataset1</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">N</span>, <span class="va">itemtype</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dataset2</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">N</span>, <span class="va">itemtype</span>, mu <span class="op">=</span> <span class="fl">.1</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dataset1</span>, <span class="va">dataset2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'D1'</span>, <span class="va">N</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'D2'</span>, <span class="va">N</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># marginal information</span></span></span>
<span class="r-in"><span><span class="fu"><a href="itemstats.html">itemstats</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $overall</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     N mean_total.score sd_total.score ave.r  sd.r alpha SEM.alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2000            7.888          3.555 0.188 0.053 0.777     1.678</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $itemstats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            N K  mean    sd total.r total.r_if_rm alpha_if_rm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  2000 2 0.609 0.488   0.525         0.414       0.762</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  2000 2 0.392 0.488   0.540         0.431       0.761</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  2000 2 0.456 0.498   0.526         0.413       0.762</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  2000 2 0.684 0.465   0.461         0.349       0.768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  2000 2 0.538 0.499   0.528         0.415       0.762</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  2000 2 0.649 0.477   0.334         0.207       0.779</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  2000 2 0.681 0.466   0.524         0.419       0.762</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  2000 2 0.432 0.495   0.504         0.389       0.764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  2000 2 0.302 0.459   0.446         0.334       0.769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 2000 2 0.274 0.446   0.388         0.273       0.774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 2000 2 0.734 0.442   0.457         0.351       0.768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 2000 2 0.470 0.499   0.585         0.481       0.756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 2000 2 0.585 0.493   0.561         0.455       0.759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 2000 2 0.592 0.492   0.538         0.428       0.761</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 2000 2 0.490 0.500   0.458         0.336       0.769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $proportions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.392 0.609</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  0.608 0.392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.544 0.456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.316 0.684</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  0.462 0.538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.351 0.649</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.318 0.681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.569 0.432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.698 0.302</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.726 0.274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.266 0.734</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 0.530 0.470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 0.416 0.585</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 0.408 0.592</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.509 0.490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># conditional information</span></span></span>
<span class="r-in"><span><span class="fu"><a href="itemstats.html">itemstats</a></span><span class="op">(</span><span class="va">dat</span>, group<span class="op">=</span><span class="va">group</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D1$overall</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     N mean_total.score sd_total.score ave.r  sd.r alpha SEM.alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1000             7.82          3.346 0.159 0.047  0.74     1.705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D1$itemstats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            N K  mean    sd total.r total.r_if_rm alpha_if_rm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1000 2 0.605 0.489   0.484         0.361       0.725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1000 2 0.368 0.483   0.507         0.388       0.722</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1000 2 0.461 0.499   0.471         0.343       0.727</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  1000 2 0.673 0.469   0.439         0.315       0.729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1000 2 0.526 0.500   0.500         0.376       0.723</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  1000 2 0.654 0.476   0.355         0.222       0.739</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1000 2 0.683 0.466   0.508         0.394       0.722</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  1000 2 0.431 0.495   0.462         0.333       0.728</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  1000 2 0.287 0.453   0.419         0.298       0.731</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 1000 2 0.274 0.446   0.372         0.249       0.735</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 1000 2 0.739 0.439   0.401         0.282       0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 1000 2 0.456 0.498   0.563         0.448       0.715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 1000 2 0.584 0.493   0.535         0.416       0.719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1000 2 0.592 0.492   0.483         0.358       0.725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 1000 2 0.487 0.500   0.451         0.321       0.729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D1$proportions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.395 0.605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  0.632 0.368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.539 0.461</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.327 0.673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  0.474 0.526</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.346 0.654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.317 0.683</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.569 0.431</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.713 0.287</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.726 0.274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.261 0.739</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 0.544 0.456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 0.416 0.584</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 0.408 0.592</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.513 0.487</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D2$overall</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     N mean_total.score sd_total.score ave.r  sd.r alpha SEM.alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1000            7.955          3.754 0.217 0.065 0.807      1.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D2$itemstats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            N K  mean    sd total.r total.r_if_rm alpha_if_rm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1000 2 0.612 0.488   0.563         0.464       0.792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1000 2 0.417 0.493   0.569         0.469       0.792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1000 2 0.450 0.498   0.578         0.479       0.791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  1000 2 0.695 0.461   0.484         0.381       0.798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1000 2 0.551 0.498   0.553         0.451       0.793</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  1000 2 0.644 0.479   0.316         0.195       0.811</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1000 2 0.680 0.467   0.540         0.443       0.794</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  1000 2 0.432 0.496   0.544         0.440       0.794</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  1000 2 0.317 0.466   0.470         0.365       0.799</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 1000 2 0.275 0.447   0.403         0.297       0.804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 1000 2 0.729 0.445   0.508         0.413       0.796</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 1000 2 0.483 0.500   0.606         0.511       0.788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 1000 2 0.585 0.493   0.587         0.491       0.790</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1000 2 0.591 0.492   0.589         0.493       0.790</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 1000 2 0.494 0.500   0.466         0.351       0.801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D2$proportions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.388 0.612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  0.583 0.417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.550 0.450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.305 0.695</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  0.449 0.551</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.356 0.644</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.320 0.680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.568 0.432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.683 0.317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.725 0.275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.271 0.729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 0.517 0.483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 0.415 0.585</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 0.409 0.591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.506 0.494</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod_configural</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span> <span class="co">#completely separate analyses</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># limited information fit statistics</span></span></span>
<span class="r-in"><span><span class="fu"><a href="M2.html">M2</a></span><span class="op">(</span><span class="va">mod_configural</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             M2  df         p RMSEA RMSEA_5 RMSEA_95   SRMSR.D1   SRMSR.D2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stats 142.9866 180 0.9806548     0       0        0 0.02414868 0.01901262</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            TLI CFI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stats 1.005381   1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod_metric</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, group <span class="op">=</span> <span class="va">group</span>, invariance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'slopes'</span><span class="op">)</span><span class="op">)</span> <span class="co">#equal slopes</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># equal intercepts, free variance and means</span></span></span>
<span class="r-in"><span><span class="va">mod_scalar2</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, group <span class="op">=</span> <span class="va">group</span>,</span></span>
<span class="r-in"><span>                             invariance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'slopes'</span>, <span class="st">'intercepts'</span>, <span class="st">'free_var'</span>,<span class="st">'free_means'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">mod_scalar1</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, group <span class="op">=</span> <span class="va">group</span>,  <span class="co">#fixed means</span></span></span>
<span class="r-in"><span>                             invariance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'slopes'</span>, <span class="st">'intercepts'</span>, <span class="st">'free_var'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">mod_fullconstrain</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, group <span class="op">=</span> <span class="va">group</span>,</span></span>
<span class="r-in"><span>                             invariance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'slopes'</span>, <span class="st">'intercepts'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="extract.mirt.html">extract.mirt</a></span><span class="op">(</span><span class="va">mod_fullconstrain</span>, <span class="st">'time'</span><span class="op">)</span> <span class="co">#time of estimation components</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TOTAL:   Data  Estep  Mstep     SE   Post </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.282  0.054  0.060  0.151  0.000  0.000 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># optionally use Newton-Raphson for (generally) faster convergence in the</span></span></span>
<span class="r-in"><span><span class="co">#  M-step's, though occasionally less stable</span></span></span>
<span class="r-in"><span><span class="va">mod_fullconstrain</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, group <span class="op">=</span> <span class="va">group</span>, optimizer <span class="op">=</span> <span class="st">'NR'</span>,</span></span>
<span class="r-in"><span>                             invariance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'slopes'</span>, <span class="st">'intercepts'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="extract.mirt.html">extract.mirt</a></span><span class="op">(</span><span class="va">mod_fullconstrain</span>, <span class="st">'time'</span><span class="op">)</span> <span class="co">#time of estimation components</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TOTAL:   Data  Estep  Mstep     SE   Post </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.197  0.053  0.073  0.053  0.000  0.001 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod_scalar2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GROUP: D1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          F1     h2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.544 0.2962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.577 0.3324</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.529 0.2799</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.460 0.2118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.536 0.2877</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.253 0.0639</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.570 0.3247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.498 0.2479</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.459 0.2104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.373 0.1393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 0.487 0.2368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 0.632 0.3998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 0.596 0.3547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 0.561 0.3147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 0.414 0.1715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SS loadings:  3.872 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion Var:  0.258 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor correlations: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GROUP: D2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          F1     h2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.634 0.4017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.665 0.4426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.619 0.3827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.548 0.3000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.626 0.3919</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.313 0.0981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.659 0.4341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.587 0.3446</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.546 0.2983</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.453 0.2052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 0.575 0.3311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 0.718 0.5152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 0.683 0.4671</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 0.650 0.4228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 0.498 0.2483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SS loadings:  5.284 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion Var:  0.352 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor correlations: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1  1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod_scalar2</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1.104  0.538 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1.201 -0.630 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1.061 -0.265 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.882  0.900 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1.082  0.164 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.445  0.636 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1.180  0.976 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.977 -0.377 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.879 -1.035 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.685 -1.118 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.948  1.213 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 1.389 -0.224 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 1.262  0.429 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1.153  0.453 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.774 -0.070 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1.104  0.538 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1.201 -0.630 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1.061 -0.265 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.882  0.900 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1.082  0.164 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.445  0.636 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1.180  0.976 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.977 -0.377 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.879 -1.035 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.685 -1.118 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.948  1.213 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 1.389 -0.224 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 1.262  0.429 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1.153  0.453 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.774 -0.070 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.066 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1 1.595</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">mod_scalar2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1      NA -0.036 -0.056  0.036 -0.014  0.014  0.017 -0.020 -0.008  -0.066</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2   1.305     NA -0.052 -0.032 -0.031  0.033 -0.028  0.034  0.038   0.042</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3   3.144  2.659     NA -0.047  0.057  0.071 -0.037 -0.050  0.033  -0.047</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4   1.279  1.040  2.173     NA  0.029  0.035  0.032 -0.039 -0.038   0.032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5   0.198  0.932  3.291  0.862     NA  0.029  0.048 -0.028  0.027  -0.027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6   0.204  1.059  5.032  1.197  0.830     NA  0.020  0.034  0.023   0.041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7   0.277  0.804  1.362  1.018  2.337  0.392     NA -0.023 -0.040   0.038</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8   0.402  1.143  2.484  1.545  0.774  1.125  0.518     NA -0.027   0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9   0.067  1.478  1.062  1.471  0.717  0.523  1.631  0.726     NA   0.052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10  4.303  1.756  2.228  1.054  0.744  1.650  1.453  0.610  2.692      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11  0.361  3.951  0.988  1.197  0.910  1.320  0.139  2.072  2.295   1.368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12  1.718  0.586  1.038  0.725  0.218  0.454  1.323  0.473  0.322   0.604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13  0.194  3.315  1.368  1.158  0.797  0.517  0.045  0.395  0.200   2.690</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14  0.074  0.804  3.798  2.946  0.648  0.228  0.223  0.464  0.693   0.378</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15  0.164  1.266  0.869  6.382  4.884  1.983  0.583  1.563  1.130   2.406</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Item_11 Item_12 Item_13 Item_14 Item_15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1   -0.019   0.041  -0.014  -0.009   0.013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2   -0.063   0.024   0.058   0.028   0.036</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3   -0.031   0.032  -0.037  -0.062   0.029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4    0.035   0.027  -0.034  -0.054   0.080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5   -0.030   0.015   0.028  -0.025  -0.070</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6    0.036   0.021   0.023  -0.015   0.045</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7    0.012   0.036  -0.007   0.015   0.024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8   -0.046   0.022   0.020  -0.022   0.040</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9   -0.048  -0.018  -0.014   0.026   0.034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10   0.037   0.025   0.052  -0.019  -0.049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11      NA   0.010  -0.024  -0.053   0.021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12   0.094      NA  -0.016  -0.016   0.012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13   0.555   0.254      NA  -0.013   0.022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14   2.862   0.255   0.159      NA   0.009</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15   0.424   0.148   0.486   0.073      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1      NA -0.029  0.031 -0.026  0.021 -0.042 -0.006  0.039  0.010  -0.029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2   0.861     NA  0.047 -0.060  0.049 -0.061 -0.036 -0.036  0.043   0.035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3   0.973  2.251     NA  0.064  0.039 -0.029  0.033  0.045  0.042   0.031</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4   0.673  3.546  4.082     NA  0.034  0.045  0.029  0.033 -0.031  -0.053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5   0.455  2.426  1.534  1.151     NA -0.042 -0.043 -0.030  0.034  -0.026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6   1.750  3.773  0.861  2.016  1.752     NA -0.038  0.023 -0.060   0.022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7   0.040  1.293  1.085  0.831  1.854  1.475     NA  0.023 -0.021   0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8   1.530  1.310  1.985  1.122  0.915  0.545  0.539     NA -0.028  -0.026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9   0.106  1.832  1.780  0.934  1.137  3.654  0.453  0.760     NA   0.037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10  0.815  1.230  0.958  2.779  0.685  0.466  0.622  0.690  1.393      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11  0.822  0.826  0.800  1.861  0.336  0.218  0.062  2.847  0.285   0.407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12  0.087  1.536  1.097  0.639  0.309  0.454  0.096  0.556  0.398   0.520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13  0.582  1.458  0.844  1.093  0.620  0.403  0.401  0.619  1.349   0.478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14  0.403  1.550  0.914  1.292  0.544  0.799  0.534  3.153  0.137   0.344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15  0.338  1.306  1.241  0.979  2.379  1.262  0.615  0.292  0.276   0.325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Item_11 Item_12 Item_13 Item_14 Item_15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1    0.029   0.009   0.024   0.020   0.018</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2    0.029  -0.039   0.038   0.039  -0.036</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3    0.028   0.033   0.029   0.030   0.035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4    0.043  -0.025  -0.033   0.036  -0.031</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5    0.018  -0.018  -0.025   0.023  -0.049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6    0.015  -0.021   0.020  -0.028  -0.036</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7   -0.008  -0.010  -0.020   0.023  -0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8    0.053  -0.024  -0.025   0.056   0.017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9   -0.017  -0.020  -0.037   0.012  -0.017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10   0.020   0.023  -0.022   0.019   0.018</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11      NA   0.032   0.017   0.018   0.024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12   1.010      NA   0.014  -0.022  -0.011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13   0.280   0.185      NA   0.022  -0.012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14   0.333   0.480   0.479      NA  -0.007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15   0.580   0.131   0.145   0.048      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_configural</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multipleGroup-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_configural</span>, type <span class="op">=</span> <span class="st">'info'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multipleGroup-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_configural</span>, type <span class="op">=</span> <span class="st">'trace'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multipleGroup-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_configural</span>, type <span class="op">=</span> <span class="st">'trace'</span>, which.items <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multipleGroup-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="itemplot.html">itemplot</a></span><span class="op">(</span><span class="va">mod_configural</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multipleGroup-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="itemplot.html">itemplot</a></span><span class="op">(</span><span class="va">mod_configural</span>, <span class="fl">2</span>, type <span class="op">=</span> <span class="st">'RE'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multipleGroup-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod_metric</span>, <span class="va">mod_configural</span><span class="op">)</span> <span class="co">#equal slopes only</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     AIC    SABIC       HQ      BIC    logLik    X2 df p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_metric     35937.61 36046.68 36030.15 36189.65 -17923.80           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_configural 35927.53 36072.96 36050.92 36263.58 -17903.76 40.08 15 0</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod_scalar2</span>, <span class="va">mod_metric</span><span class="op">)</span> <span class="co">#equal intercepts, free variance and mean</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AIC    SABIC       HQ      BIC    logLik      X2 df   p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_scalar2 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_metric  35937.61 36046.68 36030.15 36189.65 -17923.80 -16.947 13 NaN</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod_scalar1</span>, <span class="va">mod_scalar2</span><span class="op">)</span> <span class="co">#fix mean</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_scalar1 35893.96 35969.10 35957.71 36067.58 -17915.98               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_scalar2 35894.66 35972.22 35960.47 36073.89 -17915.33 1.296  1 0.255</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod_fullconstrain</span>, <span class="va">mod_scalar1</span><span class="op">)</span> <span class="co">#fix variance</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        AIC    SABIC       HQ      BIC    logLik     X2 df p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_fullconstrain 35917.51 35990.22 35979.20 36085.53 -17928.75            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_scalar1       35893.96 35969.10 35957.71 36067.58 -17915.98 25.552  1 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compared all at once (in order of most constrained to least)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod_fullconstrain</span>, <span class="va">mod_scalar2</span>, <span class="va">mod_configural</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        AIC    SABIC       HQ      BIC    logLik     X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_fullconstrain 35917.51 35990.22 35979.20 36085.53 -17928.75                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_scalar2       35894.66 35972.22 35960.47 36073.89 -17915.33 26.848  2     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_configural    35927.53 36072.96 36050.92 36263.58 -17903.76 23.133 28 0.726</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># test whether first 6 slopes should be equal across groups</span></span></span>
<span class="r-in"><span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, group <span class="op">=</span> <span class="va">group</span>, pars <span class="op">=</span> <span class="st">'values'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">values</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     group    item     class   name parnum  value lbound ubound   est const</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      D1  Item_1      dich     a1      1  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      D1  Item_1      dich      d      2  0.541   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      D1  Item_1      dich      g      3  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      D1  Item_1      dich      u      4  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      D1  Item_2      dich     a1      5  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      D1  Item_2      dich      d      6 -0.536   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      D1  Item_2      dich      g      7  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      D1  Item_2      dich      u      8  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      D1  Item_3      dich     a1      9  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     D1  Item_3      dich      d     10 -0.220   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     D1  Item_3      dich      g     11  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     D1  Item_3      dich      u     12  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13     D1  Item_4      dich     a1     13  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14     D1  Item_4      dich      d     14  0.941   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15     D1  Item_4      dich      g     15  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16     D1  Item_4      dich      u     16  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17     D1  Item_5      dich     a1     17  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18     D1  Item_5      dich      d     18  0.190   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19     D1  Item_5      dich      g     19  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20     D1  Item_5      dich      u     20  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21     D1  Item_6      dich     a1     21  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22     D1  Item_6      dich      d     22  0.752   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23     D1  Item_6      dich      g     23  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24     D1  Item_6      dich      u     24  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25     D1  Item_7      dich     a1     25  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26     D1  Item_7      dich      d     26  0.927   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27     D1  Item_7      dich      g     27  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28     D1  Item_7      dich      u     28  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29     D1  Item_8      dich     a1     29  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30     D1  Item_8      dich      d     30 -0.339   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31     D1  Item_8      dich      g     31  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32     D1  Item_8      dich      u     32  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33     D1  Item_9      dich     a1     33  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34     D1  Item_9      dich      d     34 -1.019   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35     D1  Item_9      dich      g     35  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36     D1  Item_9      dich      u     36  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37     D1 Item_10      dich     a1     37  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38     D1 Item_10      dich      d     38 -1.178   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39     D1 Item_10      dich      g     39  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40     D1 Item_10      dich      u     40  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41     D1 Item_11      dich     a1     41  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42     D1 Item_11      dich      d     42  1.228   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43     D1 Item_11      dich      g     43  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44     D1 Item_11      dich      u     44  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45     D1 Item_12      dich     a1     45  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46     D1 Item_12      dich      d     46 -0.150   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47     D1 Item_12      dich      g     47  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48     D1 Item_12      dich      u     48  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49     D1 Item_13      dich     a1     49  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50     D1 Item_13      dich      d     50  0.419   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51     D1 Item_13      dich      g     51  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52     D1 Item_13      dich      u     52  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53     D1 Item_14      dich     a1     53  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54     D1 Item_14      dich      d     54  0.455   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55     D1 Item_14      dich      g     55  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56     D1 Item_14      dich      u     56  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57     D1 Item_15      dich     a1     57  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58     D1 Item_15      dich      d     58 -0.047   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59     D1 Item_15      dich      g     59  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60     D1 Item_15      dich      u     60  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61     D1   GROUP GroupPars MEAN_1     61  0.000   -Inf    Inf FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62     D1   GROUP GroupPars COV_11     62  1.000      0    Inf FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63     D2  Item_1      dich     a1     63  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64     D2  Item_1      dich      d     64  0.541   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65     D2  Item_1      dich      g     65  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66     D2  Item_1      dich      u     66  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67     D2  Item_2      dich     a1     67  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68     D2  Item_2      dich      d     68 -0.536   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69     D2  Item_2      dich      g     69  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70     D2  Item_2      dich      u     70  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71     D2  Item_3      dich     a1     71  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72     D2  Item_3      dich      d     72 -0.220   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73     D2  Item_3      dich      g     73  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74     D2  Item_3      dich      u     74  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75     D2  Item_4      dich     a1     75  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76     D2  Item_4      dich      d     76  0.941   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77     D2  Item_4      dich      g     77  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78     D2  Item_4      dich      u     78  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79     D2  Item_5      dich     a1     79  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80     D2  Item_5      dich      d     80  0.190   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81     D2  Item_5      dich      g     81  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82     D2  Item_5      dich      u     82  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83     D2  Item_6      dich     a1     83  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84     D2  Item_6      dich      d     84  0.752   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85     D2  Item_6      dich      g     85  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86     D2  Item_6      dich      u     86  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87     D2  Item_7      dich     a1     87  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88     D2  Item_7      dich      d     88  0.927   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89     D2  Item_7      dich      g     89  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90     D2  Item_7      dich      u     90  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91     D2  Item_8      dich     a1     91  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92     D2  Item_8      dich      d     92 -0.339   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93     D2  Item_8      dich      g     93  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94     D2  Item_8      dich      u     94  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95     D2  Item_9      dich     a1     95  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96     D2  Item_9      dich      d     96 -1.019   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97     D2  Item_9      dich      g     97  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98     D2  Item_9      dich      u     98  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99     D2 Item_10      dich     a1     99  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100    D2 Item_10      dich      d    100 -1.178   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101    D2 Item_10      dich      g    101  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 102    D2 Item_10      dich      u    102  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 103    D2 Item_11      dich     a1    103  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 104    D2 Item_11      dich      d    104  1.228   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 105    D2 Item_11      dich      g    105  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 106    D2 Item_11      dich      u    106  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 107    D2 Item_12      dich     a1    107  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 108    D2 Item_12      dich      d    108 -0.150   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 109    D2 Item_12      dich      g    109  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 110    D2 Item_12      dich      u    110  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 111    D2 Item_13      dich     a1    111  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 112    D2 Item_13      dich      d    112  0.419   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 113    D2 Item_13      dich      g    113  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 114    D2 Item_13      dich      u    114  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 115    D2 Item_14      dich     a1    115  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 116    D2 Item_14      dich      d    116  0.455   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 117    D2 Item_14      dich      g    117  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 118    D2 Item_14      dich      u    118  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119    D2 Item_15      dich     a1    119  0.851   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 120    D2 Item_15      dich      d    120 -0.047   -Inf    Inf  TRUE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121    D2 Item_15      dich      g    121  0.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122    D2 Item_15      dich      u    122  1.000      0      1 FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 123    D2   GROUP GroupPars MEAN_1    123  0.000   -Inf    Inf FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 124    D2   GROUP GroupPars COV_11    124  1.000      0    Inf FALSE  none</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     nconst prior.type prior_1 prior_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99    none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 102   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 103   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 104   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 105   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 106   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 107   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 108   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 109   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 110   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 111   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 112   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 113   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 114   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 115   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 116   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 117   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 118   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 120   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 123   none       none     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 124   none       none     NaN     NaN</span>
<span class="r-in"><span><span class="va">constrain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">63</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">67</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>,<span class="fl">71</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>,<span class="fl">75</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">17</span>,<span class="fl">79</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>,<span class="fl">83</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">equalslopes</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, group <span class="op">=</span> <span class="va">group</span>, constrain <span class="op">=</span> <span class="va">constrain</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">equalslopes</span>, <span class="va">mod_configural</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     AIC    SABIC       HQ      BIC    logLik     X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> equalslopes    35935.51 36066.40 36046.56 36237.96 -17913.76                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_configural 35927.53 36072.96 36050.92 36263.58 -17903.76 19.983  6 0.003</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># same as above, but using mirt.model syntax</span></span></span>
<span class="r-in"><span><span class="va">newmodel</span> <span class="op">&lt;-</span> <span class="st">'</span></span></span>
<span class="r-in"><span><span class="st">    F = 1-15</span></span></span>
<span class="r-in"><span><span class="st">    CONSTRAINB = (1-6, a1)'</span></span></span>
<span class="r-in"><span><span class="va">equalslopes</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="va">newmodel</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">equalslopes</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1.246  0.546 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1.356 -0.720 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1.199 -0.201 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  1.006  0.861 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1.224  0.131 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.515  0.673 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1.305  0.999 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.943 -0.328 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.916 -1.058 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.731 -1.079 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.851  1.186 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 1.515 -0.251 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 1.322  0.444 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1.058  0.451 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.885 -0.061 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1.246  0.599 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1.356 -0.462 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1.199 -0.264 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  1.006  1.001 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1.224  0.266 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.515  0.631 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1.374  1.031 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  1.268 -0.367 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  1.061 -0.952 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.826 -1.115 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 1.282  1.308 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 1.625 -0.107 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 1.523  0.493 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1.545  0.532 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.885 -0.030 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">############</span></span></span>
<span class="r-in"><span><span class="co"># vertical scaling (i.e., equating when groups answer items others do not)</span></span></span>
<span class="r-in"><span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="va">dat</span></span></span>
<span class="r-in"><span><span class="va">dat2</span><span class="op">[</span><span class="va">group</span> <span class="op">==</span> <span class="st">'D1'</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">dat2</span><span class="op">[</span><span class="va">group</span> <span class="op">!=</span> <span class="st">'D1'</span>, <span class="fl">14</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]     NA     NA      1      1      1      0      1      1      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]     NA     NA      1      1      1      1      1      0      1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]     NA     NA      0      1      1      1      1      1      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]     NA     NA      1      1      1      1      1      1      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]     NA     NA      1      0      1      1      1      1      1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]     NA     NA      1      1      1      1      1      0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Item_11 Item_12 Item_13 Item_14 Item_15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]       1       1       0       1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]       0       1       1       1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]       1       0       1       1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]       1       1       1       1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]       1       1       1       1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]       1       1       1       1       0</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1995,]      1      1      0      0      0      1      1      1      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1996,]      1      0      1      1      1      0      1      1      1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1997,]      0      1      0      0      0      1      0      1      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1998,]      0      1      0      0      1      0      0      0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1999,]      1      1      0      1      1      1      1      1      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2000,]      0      0      0      0      0      0      1      0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Item_11 Item_12 Item_13 Item_14 Item_15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1995,]       1       0       1      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1996,]       1       1       0      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1997,]       1       0       1      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1998,]       0       1       0      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1999,]       1       1       1      NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2000,]       0       0       0      NA      NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># items with missing responses need to be constrained across groups for identification</span></span></span>
<span class="r-in"><span><span class="va">nms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat2</span>, <span class="fl">1</span>, <span class="va">group</span>, invariance <span class="op">=</span> <span class="va">nms</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">14</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># this will throw an error without proper constraints (SEs cannot be computed either)</span></span></span>
<span class="r-in"><span><span class="co"># mod &lt;- multipleGroup(dat2, 1, group)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model still does not have anchors, therefore need to add a few (here use items 3-5)</span></span></span>
<span class="r-in"><span><span class="va">mod_anchor</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat2</span>, <span class="fl">1</span>, <span class="va">group</span>,</span></span>
<span class="r-in"><span>                            invariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">nms</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">14</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span><span class="op">]</span>, <span class="st">'free_means'</span>, <span class="st">'free_var'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod_anchor</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1.108  0.542 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1.160 -0.564 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1.073 -0.272 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.871  0.895 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1.089  0.160 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.582  0.685 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1.292  1.009 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.906 -0.328 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.855 -1.049 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.746 -1.089 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.866  1.200 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 1.432 -0.247 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 1.244  0.440 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1.000  0.449 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.852 -0.061 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1.108  0.542 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1.160 -0.564 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1.073 -0.272 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.871  0.895 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1.089  0.160 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.374  0.596 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1.090  0.942 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.988 -0.437 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.854 -1.018 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.657 -1.164 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 1.023  1.228 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 1.324 -0.207 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 1.212  0.399 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1.000  0.449 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.852 -0.061 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.077 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1 1.658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># check if identified by computing information matrix</span></span></span>
<span class="r-in"><span><span class="va">mod_anchor</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat2</span>, <span class="fl">1</span>, <span class="va">group</span>, pars <span class="op">=</span> <span class="fu"><a href="mod2values.html">mod2values</a></span><span class="op">(</span><span class="va">mod_anchor</span><span class="op">)</span>, TOL<span class="op">=</span><span class="cn">NaN</span>, SE<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                            invariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">nms</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">14</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span><span class="op">]</span>, <span class="st">'free_means'</span>, <span class="st">'free_var'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod_anchor</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> multipleGroup(data = dat2, model = 1, group = group, invariance = c(nms[c(1:5, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     14:15)], "free_means", "free_var"), pars = mod2values(mod_anchor), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     TOL = NaN, SE = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full-information item factor analysis with 1 factor(s).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Converged within NaN tolerance after 1 EM iterations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mirt version: 1.45.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M-step optimizer: nlminb </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM acceleration: Ramsay </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of rectangular quadrature: 61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Latent density type: Gaussian </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Information matrix estimated with method: Oakes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Second-order test: model is a possible local maximum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Condition number of information matrix =  87.67822</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood = -15563.53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated parameters: 48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC = 31223.06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC = 31491.91; SABIC = 31339.41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod_anchor</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1     d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     1.108 0.542  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.842 0.330 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.375 0.753 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     1.160 -0.564  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.883 -0.785 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.436 -0.342 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     1.073 -0.272  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.896 -0.408 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.250 -0.137 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1     d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     0.871 0.895  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.710 0.765 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.031 1.026 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1     d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     1.089 0.160  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.906 0.024 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.272 0.295 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1     d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     0.582 0.685  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.405 0.543 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 0.760 0.828 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1     d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     1.292 1.009  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  1.027 0.818 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.558 1.199 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     0.906 -0.328  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.702 -0.476 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.111 -0.179 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     0.855 -1.049  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.642 -1.216 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.069 -0.882 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     0.746 -1.089  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.542 -1.253 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 0.950 -0.926 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1     d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     0.866 1.200  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.651 1.025 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.081 1.375 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     1.432 -0.247  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  1.152 -0.421 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.713 -0.074 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1     d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     1.244 0.440  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.994 0.273 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.494 0.607 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1     d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     1.000 0.449  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.785 0.294 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.215 0.603 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     0.852 -0.061  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.655 -0.205 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.049  0.083 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $GroupPars</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         MEAN_1 COV_11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par          0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5      NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5     NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1     d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     1.108 0.542  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.842 0.330 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.375 0.753 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     1.160 -0.564  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.883 -0.785 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.436 -0.342 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     1.073 -0.272  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.896 -0.408 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.250 -0.137 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1     d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     0.871 0.895  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.710 0.765 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.031 1.026 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1     d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     1.089 0.160  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.906 0.024 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.272 0.295 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1     d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     0.374 0.596  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.236 0.454 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 0.512 0.738 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1     d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     1.090 0.942  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.823 0.722 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.357 1.163 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     0.988 -0.437  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.747 -0.636 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.228 -0.239 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     0.854 -1.018  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.635 -1.219 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.072 -0.817 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     0.657 -1.164  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.469 -1.350 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 0.845 -0.978 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1     d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     1.023 1.228  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.766 1.003 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.280 1.452 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     1.324 -0.207  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  1.010 -0.442 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.637  0.027 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1     d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     1.212 0.399  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.923 0.178 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.502 0.620 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1     d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     1.000 0.449  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.785 0.294 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.215 0.603 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d  g  u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par     0.852 -0.061  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  0.655 -0.205 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5 1.049  0.083 NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $GroupPars</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         MEAN_1 COV_11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par      0.008  1.658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_2.5  -0.148  1.093</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CI_97.5  0.164  2.222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod_anchor</span>, printSE<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.108 0.542     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.136 0.108       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1      d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.160 -0.564     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.141  0.113       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1      d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.073 -0.272     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.090  0.069       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.871 0.895     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.082 0.066       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.089 0.160     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.093 0.069       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.582 0.685     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.091 0.073       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.292 1.009     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.135 0.097       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1      d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.906 -0.328     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.104  0.076       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1      d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.855 -1.049     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.109  0.085       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1      d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.746 -1.089     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.104  0.083       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.866 1.200     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.110 0.089       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1      d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.432 -0.247     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.143  0.089       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.244 0.440     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.127 0.085       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       a1     d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.00 0.449     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.11 0.079       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1      d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.852 -0.061     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.100  0.073       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $GroupPars</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     MEAN_1 COV_11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par      0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE      NA     NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.108 0.542     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.136 0.108       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1      d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.160 -0.564     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.141  0.113       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1      d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.073 -0.272     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.090  0.069       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.871 0.895     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.082 0.066       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.089 0.160     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.093 0.069       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.374 0.596     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.071 0.073       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.090 0.942     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.136 0.112       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1      d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.988 -0.437     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.123  0.101       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1      d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.854 -1.018     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.111  0.102       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1      d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.657 -1.164     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.096  0.095       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.023 1.228     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.131 0.114       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1      d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.324 -0.207     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.160  0.120       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1     d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.212 0.399     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.148 0.113       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       a1     d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 1.00 0.449     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.11 0.079       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Item_15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        a1      d logit(g) logit(u)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par 0.852 -0.061     -999      999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE  0.100  0.073       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $GroupPars</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     MEAN_1 COV_11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> par  0.008  1.658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SE   0.080  0.288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#############</span></span></span>
<span class="r-in"><span><span class="co"># DIF test for each item (using all other items as anchors)</span></span></span>
<span class="r-in"><span><span class="va">itemnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">refmodel</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, group <span class="op">=</span> <span class="va">group</span>, SE<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                          invariance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'free_means'</span>, <span class="st">'free_var'</span>, <span class="va">itemnames</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating information matrix...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># loop over items (in practice, run in parallel to increase speed). May be better to use ?DIF</span></span></span>
<span class="r-in"><span><span class="va">estmodels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">'list'</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">estmodels</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, group <span class="op">=</span> <span class="va">group</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                             invariance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'free_means'</span>, <span class="st">'free_var'</span>, <span class="va">itemnames</span><span class="op">[</span><span class="op">-</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">refmodel</span>, <span class="va">estmodels</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel       35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> estmodels[[1]] 35898.45 35980.86 35968.37 36088.88 -17915.22 0.213  2 0.899</span>
<span class="r-in"><span><span class="op">(</span><span class="va">anovas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">estmodels</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">refmodel</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">refmodel</span>, <span class="va">x</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   refmodel<span class="op">=</span><span class="va">refmodel</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35898.45 35980.86 35968.37 36088.88 -17915.22 0.213  2 0.899</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35896.81 35979.22 35966.73 36087.24 -17914.41 1.847  2 0.397</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35893.66 35976.07 35963.58 36084.09 -17912.83 5.001  2 0.082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35897.07 35979.48 35967.00 36087.50 -17914.54 1.586  2 0.453</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[5]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35897.97 35980.38 35967.89 36088.40 -17914.99 0.688  2 0.709</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[6]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df    p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35894.87 35977.28 35964.79 36085.30 -17913.43 3.793  2 0.15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[7]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35897.53 35979.94 35967.45 36087.96 -17914.76 1.131  2 0.568</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[8]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35897.20 35979.61 35967.12 36087.63 -17914.60 1.462  2 0.481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[9]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35898.46 35980.87 35968.38 36088.89 -17915.23 0.197  2 0.906</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[10]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35897.67 35980.08 35967.59 36088.10 -17914.83 0.993  2 0.609</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[11]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35896.07 35978.48 35965.99 36086.50 -17914.03 2.593  2 0.273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[12]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35897.57 35979.98 35967.49 36088.00 -17914.78 1.092  2 0.579</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[13]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35898.47 35980.88 35968.39 36088.90 -17915.23 0.192  2 0.908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[14]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35896.15 35978.57 35966.08 36086.58 -17914.08 2.505  2 0.286</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[15]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35896.96 35979.37 35966.88 36087.39 -17914.48 1.699  2 0.428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># family-wise error control</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">anovas</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span>, <span class="st">'p'</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p</span>, method <span class="op">=</span> <span class="st">'BH'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.9084069 0.8299980 0.8299980 0.8299980 0.8862364 0.8299980 0.8299980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] 0.8299980 0.9084069 0.8299980 0.8299980 0.8299980 0.9084069 0.8299980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] 0.8299980</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># same as above, except only test if slopes vary (1 df)</span></span></span>
<span class="r-in"><span><span class="co"># constrain all intercepts</span></span></span>
<span class="r-in"><span><span class="va">estmodels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">'list'</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">estmodels</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, group <span class="op">=</span> <span class="va">group</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                             invariance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'free_means'</span>, <span class="st">'free_var'</span>, <span class="st">'intercepts'</span>,</span></span>
<span class="r-in"><span>                             <span class="va">itemnames</span><span class="op">[</span><span class="op">-</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">anovas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">estmodels</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">refmodel</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">refmodel</span>, <span class="va">x</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   refmodel<span class="op">=</span><span class="va">refmodel</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35896.52 35976.50 35964.38 36081.35 -17915.26 0.143  1 0.705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35896.60 35976.58 35964.46 36081.43 -17915.30 0.061  1 0.804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35894.66 35974.65 35962.53 36079.49 -17914.33 1.997  1 0.158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35896.39 35976.38 35964.26 36081.22 -17915.20 0.268  1 0.605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[5]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35896.56 35976.54 35964.42 36081.39 -17915.28 0.103  1 0.748</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[6]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35893.62 35973.60 35961.48 36078.45 -17913.81 3.042  1 0.081</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[7]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35895.67 35975.66 35963.54 36080.50 -17914.84 0.985  1 0.321</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[8]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik   X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35896.27 35976.26 35964.13 36081.10 -17915.13 0.39  1 0.532</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[9]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35896.66 35976.64 35964.52 36081.49 -17915.33 0.001  1 0.979</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[10]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35896.12 35976.11 35963.99 36080.95 -17915.06 0.538  1 0.463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[11]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik   X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35894.22 35974.21 35962.08 36079.05 -17914.11 2.44  1 0.118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[12]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik   X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35895.87 35975.86 35963.74 36080.70 -17914.94 0.79  1 0.374</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[13]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik   X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35896.58 35976.57 35964.44 36081.41 -17915.29 0.08  1 0.778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[14]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik  X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35894.16 35974.15 35962.02 36078.99 -17914.08 2.5  1 0.114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[15]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> refmodel 35894.66 35972.22 35960.47 36073.89 -17915.33               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x        35894.99 35974.97 35962.85 36079.82 -17914.49 1.672  1 0.196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># quickly test with Wald test using DIF()</span></span></span>
<span class="r-in"><span><span class="va">mod_configural2</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, group <span class="op">=</span> <span class="va">group</span>, SE<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating information matrix...</span>
<span class="r-in"><span><span class="fu"><a href="DIF.html">DIF</a></span><span class="op">(</span><span class="va">mod_configural2</span>, which.par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'a1'</span>, <span class="st">'d'</span><span class="op">)</span>, Wald<span class="op">=</span><span class="cn">TRUE</span>, p.adjust <span class="op">=</span> <span class="st">'fdr'</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> NOTE: No hyper-parameters were estimated in the DIF model. </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       For effective DIF testing, freeing the focal group hyper-parameters is recommended.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         groups      W df     p adj_p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1   D1,D2  4.636  2 0.098 0.246</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2   D1,D2  7.265  2 0.026 0.099</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3   D1,D2 10.375  2 0.006 0.055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4   D1,D2  3.210  2 0.201 0.335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5   D1,D2  3.618  2 0.164 0.307</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6   D1,D2  0.820  2 0.664 0.804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7   D1,D2  0.575  2  0.75 0.804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8   D1,D2  5.782  2 0.056 0.167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9   D1,D2  3.802  2 0.149 0.307</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10  D1,D2  0.722  2 0.697 0.804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11  D1,D2  8.922  2 0.012 0.058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12  D1,D2  2.340  2  0.31 0.463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13  D1,D2  2.162  2 0.339 0.463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14  D1,D2  9.848  2 0.007 0.055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15  D1,D2  0.204  2 0.903 0.903</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#############</span></span></span>
<span class="r-in"><span><span class="co"># Three group model where the latent variable parameters are constrained to</span></span></span>
<span class="r-in"><span><span class="co"># be equal in the focal groups</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">1</span>,<span class="fl">.3</span><span class="op">)</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">0</span>,<span class="fl">.7</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">itemtype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">dataset1</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">N</span>, <span class="va">itemtype</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dataset2</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">N</span>, <span class="va">itemtype</span>, mu <span class="op">=</span> <span class="fl">.1</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dataset3</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">N</span>, <span class="va">itemtype</span>, mu <span class="op">=</span> <span class="fl">.1</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dataset1</span>, <span class="va">dataset2</span>, <span class="va">dataset3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'D1'</span>, <span class="st">'D2'</span>, <span class="st">'D3'</span><span class="op">)</span>, each<span class="op">=</span><span class="va">N</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># marginal information</span></span></span>
<span class="r-in"><span><span class="fu"><a href="itemstats.html">itemstats</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $overall</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     N mean_total.score sd_total.score ave.r  sd.r alpha SEM.alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3000             7.89          3.567  0.19 0.054 0.779     1.676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $itemstats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            N K  mean    sd total.r total.r_if_rm alpha_if_rm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  3000 2 0.605 0.489   0.525         0.415       0.764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  3000 2 0.403 0.491   0.563         0.458       0.761</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  3000 2 0.457 0.498   0.504         0.388       0.767</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  3000 2 0.676 0.468   0.458         0.345       0.770</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  3000 2 0.545 0.498   0.539         0.429       0.763</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  3000 2 0.645 0.478   0.334         0.207       0.782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  3000 2 0.688 0.464   0.529         0.426       0.764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  3000 2 0.427 0.495   0.498         0.382       0.767</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  3000 2 0.292 0.455   0.454         0.344       0.770</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 3000 2 0.284 0.451   0.393         0.279       0.775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 3000 2 0.738 0.440   0.451         0.345       0.770</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 3000 2 0.460 0.499   0.598         0.496       0.757</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 3000 2 0.591 0.492   0.556         0.449       0.761</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 3000 2 0.591 0.492   0.548         0.441       0.762</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 3000 2 0.488 0.500   0.452         0.330       0.772</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $proportions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.395 0.605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  0.597 0.403</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.543 0.457</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.324 0.676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  0.455 0.545</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.355 0.645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.312 0.688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.573 0.427</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.708 0.292</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.716 0.284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.262 0.738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 0.540 0.460</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 0.409 0.591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 0.409 0.591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.512 0.488</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># conditional information</span></span></span>
<span class="r-in"><span><span class="fu"><a href="itemstats.html">itemstats</a></span><span class="op">(</span><span class="va">dat</span>, group<span class="op">=</span><span class="va">group</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D1$overall</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     N mean_total.score sd_total.score ave.r  sd.r alpha SEM.alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1000             7.82          3.346 0.159 0.047  0.74     1.705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D1$itemstats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            N K  mean    sd total.r total.r_if_rm alpha_if_rm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1000 2 0.605 0.489   0.484         0.361       0.725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1000 2 0.368 0.483   0.507         0.388       0.722</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1000 2 0.461 0.499   0.471         0.343       0.727</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  1000 2 0.673 0.469   0.439         0.315       0.729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1000 2 0.526 0.500   0.500         0.376       0.723</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  1000 2 0.654 0.476   0.355         0.222       0.739</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1000 2 0.683 0.466   0.508         0.394       0.722</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  1000 2 0.431 0.495   0.462         0.333       0.728</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  1000 2 0.287 0.453   0.419         0.298       0.731</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 1000 2 0.274 0.446   0.372         0.249       0.735</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 1000 2 0.739 0.439   0.401         0.282       0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 1000 2 0.456 0.498   0.563         0.448       0.715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 1000 2 0.584 0.493   0.535         0.416       0.719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1000 2 0.592 0.492   0.483         0.358       0.725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 1000 2 0.487 0.500   0.451         0.321       0.729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D1$proportions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.395 0.605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  0.632 0.368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.539 0.461</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.327 0.673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  0.474 0.526</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.346 0.654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.317 0.683</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.569 0.431</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.713 0.287</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.726 0.274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.261 0.739</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 0.544 0.456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 0.416 0.584</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 0.408 0.592</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.513 0.487</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D2$overall</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     N mean_total.score sd_total.score ave.r  sd.r alpha SEM.alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1000            7.955          3.754 0.217 0.065 0.807      1.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D2$itemstats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            N K  mean    sd total.r total.r_if_rm alpha_if_rm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1000 2 0.612 0.488   0.563         0.464       0.792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1000 2 0.417 0.493   0.569         0.469       0.792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1000 2 0.450 0.498   0.578         0.479       0.791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  1000 2 0.695 0.461   0.484         0.381       0.798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1000 2 0.551 0.498   0.553         0.451       0.793</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  1000 2 0.644 0.479   0.316         0.195       0.811</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1000 2 0.680 0.467   0.540         0.443       0.794</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  1000 2 0.432 0.496   0.544         0.440       0.794</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  1000 2 0.317 0.466   0.470         0.365       0.799</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 1000 2 0.275 0.447   0.403         0.297       0.804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 1000 2 0.729 0.445   0.508         0.413       0.796</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 1000 2 0.483 0.500   0.606         0.511       0.788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 1000 2 0.585 0.493   0.587         0.491       0.790</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1000 2 0.591 0.492   0.589         0.493       0.790</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 1000 2 0.494 0.500   0.466         0.351       0.801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D2$proportions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.388 0.612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  0.583 0.417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.550 0.450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.305 0.695</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  0.449 0.551</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.356 0.644</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.320 0.680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.568 0.432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.683 0.317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.725 0.275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.271 0.729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 0.517 0.483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 0.415 0.585</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 0.409 0.591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.506 0.494</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D3$overall</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     N mean_total.score sd_total.score ave.r  sd.r alpha SEM.alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1000            7.894          3.592 0.194 0.064 0.783     1.672</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D3$itemstats</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            N K  mean    sd total.r total.r_if_rm alpha_if_rm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1000 2 0.599 0.490   0.526         0.416       0.769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1000 2 0.424 0.494   0.610         0.512       0.761</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1000 2 0.459 0.499   0.460         0.340       0.776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  1000 2 0.659 0.474   0.452         0.338       0.775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1000 2 0.557 0.497   0.562         0.456       0.766</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  1000 2 0.638 0.481   0.334         0.208       0.786</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1000 2 0.700 0.458   0.539         0.439       0.767</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  1000 2 0.419 0.494   0.485         0.369       0.773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  1000 2 0.272 0.445   0.470         0.365       0.773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 1000 2 0.303 0.460   0.405         0.290       0.779</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 1000 2 0.747 0.435   0.438         0.333       0.776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 1000 2 0.442 0.497   0.622         0.526       0.759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 1000 2 0.604 0.489   0.545         0.438       0.767</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1000 2 0.589 0.492   0.569         0.465       0.765</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 1000 2 0.482 0.500   0.439         0.317       0.778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D3$proportions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.401 0.599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  0.576 0.424</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.541 0.459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.341 0.659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  0.443 0.557</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.362 0.638</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.300 0.700</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.581 0.419</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.728 0.272</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.697 0.303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.253 0.747</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 0.558 0.442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 0.396 0.604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 0.411 0.589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.518 0.482</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">'F1 = 1-15</span></span></span>
<span class="r-in"><span><span class="st">          FREE[D2, D3] = (GROUP, MEAN_1), (GROUP, COV_11)</span></span></span>
<span class="r-in"><span><span class="st">          CONSTRAINB[D2,D3] = (GROUP, MEAN_1), (GROUP, COV_11)'</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="va">model</span>, group <span class="op">=</span> <span class="va">group</span>, invariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1.089  0.517 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1.302 -0.601 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.950 -0.251 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.857  0.847 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1.119  0.195 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.447  0.618 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1.209  1.023 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.939 -0.396 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.909 -1.110 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.695 -1.073 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.929  1.232 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 1.454 -0.290 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 1.216  0.457 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1.199  0.453 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.751 -0.085 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1.089  0.517 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1.302 -0.601 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.950 -0.251 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.857  0.847 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1.119  0.195 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.447  0.618 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1.209  1.023 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.939 -0.396 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.909 -1.110 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.695 -1.073 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.929  1.232 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 1.454 -0.290 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 1.216  0.457 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1.199  0.453 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.751 -0.085 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.055 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1 1.467</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1.089  0.517 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1.302 -0.601 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.950 -0.251 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.857  0.847 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1.119  0.195 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.447  0.618 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1.209  1.023 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.939 -0.396 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.909 -1.110 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.695 -1.073 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.929  1.232 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 1.454 -0.290 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 1.216  0.457 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1.199  0.453 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.751 -0.085 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.055 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1 1.467</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#############</span></span></span>
<span class="r-in"><span><span class="co"># Testing main effects in multiple independent grouping variables</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">1</span>,<span class="fl">.3</span><span class="op">)</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">0</span>,<span class="fl">.7</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">itemtype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">500</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generated data have interaction effect for latent means, as well as a</span></span></span>
<span class="r-in"><span><span class="co"># main effect across D but no main effect across G</span></span></span>
<span class="r-in"><span><span class="va">d11</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">N</span>, <span class="va">itemtype</span>, mu <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d12</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">N</span>, <span class="va">itemtype</span>, mu <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d13</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">N</span>, <span class="va">itemtype</span>, mu <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d21</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">N</span>, <span class="va">itemtype</span>, mu <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d22</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">N</span>, <span class="va">itemtype</span>, mu <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d23</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">N</span>, <span class="va">itemtype</span>, mu <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">d11</span>, <span class="va">d12</span>, <span class="va">d13</span>, <span class="va">d21</span>, <span class="va">d22</span>, <span class="va">d23</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'G1.D1'</span>, <span class="st">'G1.D2'</span>, <span class="st">'G1.D3'</span>, <span class="st">'G2.D1'</span>, <span class="st">'G2.D2'</span>, <span class="st">'G2.D3'</span><span class="op">)</span>, each<span class="op">=</span><span class="va">N</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G1.D1 G1.D2 G1.D3 G2.D1 G2.D2 G2.D3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   500   500   500   500   500   500 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># in practice, group would be organized in a data.frame as follows</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dfw</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu">separate_wider_delim</span><span class="op">(</span><span class="va">df</span>, <span class="va">group</span>, delim<span class="op">=</span><span class="st">'.'</span>, names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'G'</span>, <span class="st">'D'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dfw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># for use with multipleGroup() combine into a single long group</span></span></span>
<span class="r-in"><span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dfw</span>, <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># conditional information</span></span></span>
<span class="r-in"><span><span class="fu"><a href="itemstats.html">itemstats</a></span><span class="op">(</span><span class="va">dat</span>, group<span class="op">=</span><span class="va">group</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, group <span class="op">=</span> <span class="va">group</span>, SE<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                     invariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, <span class="st">'free_mean'</span>, <span class="st">'free_var'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">means</span><span class="op">)</span><span class="op">)</span> <span class="co"># mean estimates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="wald.html">wald</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span> <span class="co"># view parameter names for later testing</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># test for main effect over G group (manually compute marginal mean)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="wald.html">wald</a></span><span class="op">(</span><span class="va">mod</span>, <span class="st">"0 + MEAN_1.123 + MEAN_1.185 = MEAN_1.247 + MEAN_1.309 + MEAN_1.371"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># test for main effect over D group  (manually compute marginal means)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="wald.html">wald</a></span><span class="op">(</span><span class="va">mod</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0 + MEAN_1.247 = MEAN_1.123 + MEAN_1.309"</span>,</span></span>
<span class="r-in"><span>            <span class="st">"0 + MEAN_1.247 = MEAN_1.185 + MEAN_1.371"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># post-hoc tests (better practice would include p.adjust() )</span></span></span>
<span class="r-in"><span><span class="fu"><a href="wald.html">wald</a></span><span class="op">(</span><span class="va">mod</span>, <span class="st">"0 + MEAN_1.247 = MEAN_1.123 + MEAN_1.309"</span><span class="op">)</span> <span class="co"># D1 vs D2</span></span></span>
<span class="r-in"><span><span class="fu"><a href="wald.html">wald</a></span><span class="op">(</span><span class="va">mod</span>, <span class="st">"0 + MEAN_1.247 = MEAN_1.185 + MEAN_1.371"</span><span class="op">)</span> <span class="co"># D1 vs D3</span></span></span>
<span class="r-in"><span><span class="fu"><a href="wald.html">wald</a></span><span class="op">(</span><span class="va">mod</span>, <span class="st">"MEAN_1.123 + MEAN_1.309 = MEAN_1.185 + MEAN_1.371"</span><span class="op">)</span> <span class="co"># D2 vs D3</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#############</span></span></span>
<span class="r-in"><span><span class="co"># multiple factors</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">.3</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">.3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">15</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">.3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="fl">15</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">0</span>,<span class="fl">.7</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.4</span>, <span class="op">-</span><span class="fl">.7</span>, <span class="fl">.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.21</span>,<span class="fl">.297</span>,<span class="fl">1.232</span>,<span class="fl">.297</span>,<span class="fl">.81</span>,<span class="fl">.252</span>,<span class="fl">1.232</span>,<span class="fl">.252</span>,<span class="fl">1.96</span><span class="op">)</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">itemtype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">dataset1</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">N</span>, <span class="va">itemtype</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dataset2</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">N</span>, <span class="va">itemtype</span>, mu <span class="op">=</span> <span class="va">mu</span>, sigma <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dataset1</span>, <span class="va">dataset2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'D1'</span>, <span class="va">N</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'D2'</span>, <span class="va">N</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># group models</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">'</span></span></span>
<span class="r-in"><span><span class="st">   F1 = 1-5</span></span></span>
<span class="r-in"><span><span class="st">   F2 = 6-10</span></span></span>
<span class="r-in"><span><span class="st">   F3 = 11-15'</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define mirt cluster to use parallel architecture</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="mirtCluster.html">mirtCluster</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EM approach (not as accurate with 3 factors, but generally good for quick model comparisons)</span></span></span>
<span class="r-in"><span><span class="va">mod_configural</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="va">model</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span> <span class="co">#completely separate analyses</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">mod_metric</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="va">model</span>, group <span class="op">=</span> <span class="va">group</span>, invariance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'slopes'</span><span class="op">)</span><span class="op">)</span> <span class="co">#equal slopes</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">mod_fullconstrain</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="va">model</span>, group <span class="op">=</span> <span class="va">group</span>, <span class="co">#equal means, slopes, intercepts</span></span></span>
<span class="r-in"><span>                             invariance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'slopes'</span>, <span class="st">'intercepts'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod_metric</span>, <span class="va">mod_configural</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     AIC    SABIC       HQ      BIC    logLik     X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_metric     36921.29 37030.37 37013.84 37173.33 -18415.65                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_configural 36916.10 37061.53 37039.49 37252.15 -18398.05 35.197 15 0.002</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod_fullconstrain</span>, <span class="va">mod_metric</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        AIC    SABIC       HQ      BIC    logLik      X2 df p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_fullconstrain 37020.58 37093.29 37082.27 37188.60 -18480.29             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_metric        36921.29 37030.37 37013.84 37173.33 -18415.65 129.284 15 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># same as above, but with MHRM (generally  more accurate with 3+ factors, but slower)</span></span></span>
<span class="r-in"><span><span class="va">mod_configural</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="va">model</span>, group <span class="op">=</span> <span class="va">group</span>, method <span class="op">=</span> <span class="st">'MHRM'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , Max-Change = 0.0590, Max-Change = 0.0510, Max-Change = 0.0521, Max-Change = 0.0448, Max-Change = 0.0452, Max-Change = 0.0585, Max-Change = 0.0515, Max-Change = 0.0410, Max-Change = 0.0450, Max-Change = 0.0403, Max-Change = 0.0433, Max-Change = 0.0520, Max-Change = 0.0391, Max-Change = 0.0444, Max-Change = 0.0611, Max-Change = 0.0418, Max-Change = 0.0514, Max-Change = 0.0568, Max-Change = 0.0286, Max-Change = 0.0359, Max-Change = 0.0247, Max-Change = 0.0433, Max-Change = 0.0549, Max-Change = 0.0384, Max-Change = 0.0468, Max-Change = 0.0443, Max-Change = 0.0343, Max-Change = 0.0363, Max-Change = 0.0315, Max-Change = 0.0449, Max-Change = 0.0334, Max-Change = 0.0500, Max-Change = 0.0348, Max-Change = 0.0351, Max-Change = 0.0404, Max-Change = 0.0712, Max-Change = 0.0320, Max-Change = 0.0251, Max-Change = 0.0268, Max-Change = 0.0331, Max-Change = 0.0369, Max-Change = 0.0361, Max-Change = 0.0252, Max-Change = 0.0319, Max-Change = 0.0311, Max-Change = 0.0443, Max-Change = 0.0405, Max-Change = 0.0283, Max-Change = 0.0392, Max-Change = 0.0315, Max-Change = 0.0536, Max-Change = 0.0339, Max-Change = 0.0258, Max-Change = 0.0350, Max-Change = 0.0428, Max-Change = 0.0349, Max-Change = 0.0378, Max-Change = 0.0539, Max-Change = 0.0303, Max-Change = 0.0469, Max-Change = 0.0424, Max-Change = 0.0275, Max-Change = 0.0502, Max-Change = 0.0449, Max-Change = 0.0378, Max-Change = 0.0307, Max-Change = 0.0340, Max-Change = 0.0370, Max-Change = 0.0527, Max-Change = 0.0222, Max-Change = 0.0256, Max-Change = 0.0322, Max-Change = 0.0393, Max-Change = 0.0343, Max-Change = 0.0384, Max-Change = 0.0348, Max-Change = 0.0321, Max-Change = 0.0297, Max-Change = 0.0377, Max-Change = 0.0313, Max-Change = 0.0272, Max-Change = 0.0264, Max-Change = 0.0357, Max-Change = 0.0336, Max-Change = 0.0355, Max-Change = 0.0304, Max-Change = 0.0452, Max-Change = 0.0284, Max-Change = 0.0211, Max-Change = 0.0450, Max-Change = 0.0394, Max-Change = 0.0357, Max-Change = 0.0273, Max-Change = 0.0615, Max-Change = 0.0300, Max-Change = 0.0333, Max-Change = 0.0246, Max-Change = 0.0344, Max-Change = 0.0406, Max-Change = 0.0265, Max-Change = 0.0389, Max-Change = 0.0379, Max-Change = 0.0637, Max-Change = 0.0312, Max-Change = 0.0208, Max-Change = 0.0273, Max-Change = 0.0217, Max-Change = 0.0340, Max-Change = 0.0473, Max-Change = 0.0318, Max-Change = 0.0316, Max-Change = 0.0378, Max-Change = 0.0282, Max-Change = 0.0386, Max-Change = 0.0447, Max-Change = 0.0300, Max-Change = 0.0565, Max-Change = 0.0259, Max-Change = 0.0267, Max-Change = 0.0397, Max-Change = 0.0238, Max-Change = 0.0390, Max-Change = 0.0650, Max-Change = 0.0314, Max-Change = 0.0328, Max-Change = 0.0262, Max-Change = 0.0410, Max-Change = 0.0427, Max-Change = 0.0381, Max-Change = 0.0445, Max-Change = 0.0469, Max-Change = 0.0374, Max-Change = 0.0410, Max-Change = 0.0329, Max-Change = 0.0330, Max-Change = 0.0277, Max-Change = 0.0275, Max-Change = 0.0485, Max-Change = 0.0440, Max-Change = 0.0264, Max-Change = 0.0432, Max-Change = 0.0410, Max-Change = 0.0404, Max-Change = 0.0251, Max-Change = 0.0507, Max-Change = 0.0299, Max-Change = 0.0810, Max-Change = 0.0278, Max-Change = 0.0372, Max-Change = 0.0388, Max-Change = 0.0274, Max-Change = 0.0308, Max-Change = 0.0455, Max-Change = 0.0292, Max-Change = 0.0250, Max-Change = 0.0288, Max-Change = 0.0254, Max-Change = 0.0398, Max-Change = 0.0308, Max-Change = 0.0343, Max-Change = 0.0507, Max-Change = 0.0303, Max-Change = 0.0368, Max-Change = 0.0369, Max-Change = 0.0298, Max-Change = 0.0401, Max-Change = 0.0428, Max-Change = 0.0409, Max-Change = 0.0384, Max-Change = 0.0389, Max-Change = 0.0351, Max-Change = 0.0274, Max-Change = 0.0390, Max-Change = 0.0337, Max-Change = 0.0322, Max-Change = 0.0540, Max-Change = 0.0337, Max-Change = 0.0245, Max-Change = 0.0353, Max-Change = 0.0351, Max-Change = 0.0221, Max-Change = 0.0360, Max-Change = 0.0580, Max-Change = 0.0393, Max-Change = 0.0259, Max-Change = 0.0377, Max-Change = 0.0447, Max-Change = 0.0309, Max-Change = 0.0425, Max-Change = 0.0266, Max-Change = 0.0595, Max-Change = 0.0631, Max-Change = 0.0266, Max-Change = 0.0294, Max-Change = 0.0404, Max-Change = 0.0402, Max-Change = 0.0263, Max-Change = 0.0425, Max-Change = 0.0324, Max-Change = 0.0340, Max-Change = 0.0393, Max-Change = 0.0377, Max-Change = 0.0538, Max-Change = 0.0342, Max-Change = 0.0249, Max-Change = 0.0301, Max-Change = 0.0345, Max-Change = 0.0360, Max-Change = 0.0411, Max-Change = 0.0308, Max-Change = 0.0407, Max-Change = 0.0373, Max-Change = 0.0357, Max-Change = 0.0358, Max-Change = 0.0316, Max-Change = 0.0284, Max-Change = 0.0370, Max-Change = 0.0253, Max-Change = 0.0331, Max-Change = 0.0395, Max-Change = 0.0281, Max-Change = 0.0238, Max-Change = 0.0272, Max-Change = 0.0520, Max-Change = 0.0252, Max-Change = 0.0401, Max-Change = 0.0453, Max-Change = 0.0347, Max-Change = 0.0410, Max-Change = 0.0307, Max-Change = 0.0411, Max-Change = 0.0324, Max-Change = 0.0353, Max-Change = 0.0441, Max-Change = 0.0374, Max-Change = 0.0463, Max-Change = 0.0281, Max-Change = 0.0402, Max-Change = 0.0384, Max-Change = 0.0290, Max-Change = 0.0401, Max-Change = 0.0546, Max-Change = 0.0300, Max-Change = 0.0268, Max-Change = 0.0401, Max-Change = 0.0299, Max-Change = 0.0613, Max-Change = 0.0343, Max-Change = 0.0483, Max-Change = 0.0472, gam = 0.0000, Max-Change = 0.0000, gam = 0.1778, Max-Change = 0.0400, gam = 0.1057, Max-Change = 0.0314, gam = 0.0780, Max-Change = 0.0153, gam = 0.0629, Max-Change = 0.0105, gam = 0.0532, Max-Change = 0.0084, gam = 0.0464, Max-Change = 0.0134, gam = 0.0413, Max-Change = 0.0099, gam = 0.0374, Max-Change = 0.0098, gam = 0.0342, Max-Change = 0.0048, gam = 0.0316, Max-Change = 0.0057, gam = 0.0294, Max-Change = 0.0032, gam = 0.0276, Max-Change = 0.0048, gam = 0.0260, Max-Change = 0.0042, gam = 0.0246, Max-Change = 0.0069, gam = 0.0233, Max-Change = 0.0037, gam = 0.0222, Max-Change = 0.0044, gam = 0.0212, Max-Change = 0.0044, gam = 0.0203, Max-Change = 0.0036, gam = 0.0195, Max-Change = 0.0051, gam = 0.0188, Max-Change = 0.0048, gam = 0.0181, Max-Change = 0.0023, gam = 0.0175, Max-Change = 0.0043, gam = 0.0169, Max-Change = 0.0035, gam = 0.0164, Max-Change = 0.0032, gam = 0.0159, Max-Change = 0.0033, gam = 0.0154, Max-Change = 0.0018, gam = 0.0150, Max-Change = 0.0024, gam = 0.0146, Max-Change = 0.0026, gam = 0.0142, Max-Change = 0.0018, gam = 0.0139, Max-Change = 0.0024, gam = 0.0135, Max-Change = 0.0018, gam = 0.0132, Max-Change = 0.0035, gam = 0.0129, Max-Change = 0.0028, gam = 0.0126, Max-Change = 0.0016, gam = 0.0124, Max-Change = 0.0023, gam = 0.0121, Max-Change = 0.0022, gam = 0.0119, Max-Change = 0.0020, gam = 0.0116, Max-Change = 0.0035, gam = 0.0114, Max-Change = 0.0032, gam = 0.0112, Max-Change = 0.0020, gam = 0.0110, Max-Change = 0.0013, gam = 0.0108, Max-Change = 0.0013, gam = 0.0106, Max-Change = 0.0021, gam = 0.0104, Max-Change = 0.0018, gam = 0.0102, Max-Change = 0.0022, gam = 0.0101, Max-Change = 0.0025, gam = 0.0099, Max-Change = 0.0018, gam = 0.0098, Max-Change = 0.0014, gam = 0.0096, Max-Change = 0.0015, gam = 0.0095, Max-Change = 0.0013, gam = 0.0093, Max-Change = 0.0017, gam = 0.0092, Max-Change = 0.0015, gam = 0.0091, Max-Change = 0.0021, gam = 0.0089, Max-Change = 0.0019, gam = 0.0088, Max-Change = 0.0012, gam = 0.0087, Max-Change = 0.0019, gam = 0.0086, Max-Change = 0.0012, gam = 0.0085, Max-Change = 0.0013, gam = 0.0084, Max-Change = 0.0011, gam = 0.0082, Max-Change = 0.0015, gam = 0.0081, Max-Change = 0.0014, gam = 0.0080, Max-Change = 0.0015, gam = 0.0080, Max-Change = 0.0016, gam = 0.0079, Max-Change = 0.0015, gam = 0.0078, Max-Change = 0.0013, gam = 0.0077, Max-Change = 0.0016, gam = 0.0076, Max-Change = 0.0012, gam = 0.0075, Max-Change = 0.0007, gam = 0.0074, Max-Change = 0.0015, gam = 0.0073, Max-Change = 0.0010, gam = 0.0073, Max-Change = 0.0015, gam = 0.0072, Max-Change = 0.0013, gam = 0.0071, Max-Change = 0.0010, gam = 0.0070, Max-Change = 0.0018, gam = 0.0070, Max-Change = 0.0023, gam = 0.0069, Max-Change = 0.0015, gam = 0.0068, Max-Change = 0.0013, gam = 0.0068, Max-Change = 0.0008, gam = 0.0067, Max-Change = 0.0010, gam = 0.0066, Max-Change = 0.0022, gam = 0.0066, Max-Change = 0.0021, gam = 0.0065, Max-Change = 0.0016, gam = 0.0065, Max-Change = 0.0014, gam = 0.0064, Max-Change = 0.0012, gam = 0.0064, Max-Change = 0.0009, gam = 0.0063, Max-Change = 0.0012, gam = 0.0062, Max-Change = 0.0012, gam = 0.0062, Max-Change = 0.0012, gam = 0.0061, Max-Change = 0.0010, gam = 0.0061, Max-Change = 0.0008, gam = 0.0060, Max-Change = 0.0013, gam = 0.0060, Max-Change = 0.0010, gam = 0.0059, Max-Change = 0.0014, gam = 0.0059, Max-Change = 0.0012, gam = 0.0058, Max-Change = 0.0018, gam = 0.0058, Max-Change = 0.0006, gam = 0.0058, Max-Change = 0.0008, gam = 0.0057, Max-Change = 0.0011, gam = 0.0057, Max-Change = 0.0010, gam = 0.0056, Max-Change = 0.0010, gam = 0.0056, Max-Change = 0.0006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating log-likelihood...</span>
<span class="r-in"><span><span class="va">mod_metric</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="va">model</span>, group <span class="op">=</span> <span class="va">group</span>, invariance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'slopes'</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">'MHRM'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , Max-Change = 0.0602, Max-Change = 0.0556, Max-Change = 0.0444, Max-Change = 0.0508, Max-Change = 0.0365, Max-Change = 0.0433, Max-Change = 0.0317, Max-Change = 0.0330, Max-Change = 0.0324, Max-Change = 0.0245, Max-Change = 0.0334, Max-Change = 0.0232, Max-Change = 0.0176, Max-Change = 0.0321, Max-Change = 0.0257, Max-Change = 0.0304, Max-Change = 0.0253, Max-Change = 0.0199, Max-Change = 0.0240, Max-Change = 0.0202, Max-Change = 0.0239, Max-Change = 0.0248, Max-Change = 0.0311, Max-Change = 0.0186, Max-Change = 0.0301, Max-Change = 0.0316, Max-Change = 0.0253, Max-Change = 0.0146, Max-Change = 0.0204, Max-Change = 0.0180, Max-Change = 0.0305, Max-Change = 0.0229, Max-Change = 0.0400, Max-Change = 0.0192, Max-Change = 0.0343, Max-Change = 0.0320, Max-Change = 0.0285, Max-Change = 0.0170, Max-Change = 0.0337, Max-Change = 0.0177, Max-Change = 0.0206, Max-Change = 0.0226, Max-Change = 0.0167, Max-Change = 0.0183, Max-Change = 0.0259, Max-Change = 0.0128, Max-Change = 0.0273, Max-Change = 0.0211, Max-Change = 0.0283, Max-Change = 0.0258, Max-Change = 0.0327, Max-Change = 0.0224, Max-Change = 0.0153, Max-Change = 0.0245, Max-Change = 0.0285, Max-Change = 0.0165, Max-Change = 0.0225, Max-Change = 0.0195, Max-Change = 0.0179, Max-Change = 0.0302, Max-Change = 0.0240, Max-Change = 0.0266, Max-Change = 0.0268, Max-Change = 0.0258, Max-Change = 0.0243, Max-Change = 0.0174, Max-Change = 0.0205, Max-Change = 0.0201, Max-Change = 0.0533, Max-Change = 0.0199, Max-Change = 0.0250, Max-Change = 0.0225, Max-Change = 0.0267, Max-Change = 0.0159, Max-Change = 0.0182, Max-Change = 0.0229, Max-Change = 0.0242, Max-Change = 0.0285, Max-Change = 0.0240, Max-Change = 0.0294, Max-Change = 0.0171, Max-Change = 0.0156, Max-Change = 0.0214, Max-Change = 0.0175, Max-Change = 0.0262, Max-Change = 0.0279, Max-Change = 0.0195, Max-Change = 0.0337, Max-Change = 0.0234, Max-Change = 0.0289, Max-Change = 0.0167, Max-Change = 0.0206, Max-Change = 0.0106, Max-Change = 0.0424, Max-Change = 0.0174, Max-Change = 0.0168, Max-Change = 0.0176, Max-Change = 0.0296, Max-Change = 0.0258, Max-Change = 0.0122, Max-Change = 0.0307, Max-Change = 0.0214, Max-Change = 0.0319, Max-Change = 0.0384, Max-Change = 0.0263, Max-Change = 0.0241, Max-Change = 0.0285, Max-Change = 0.0269, Max-Change = 0.0253, Max-Change = 0.0247, Max-Change = 0.0192, Max-Change = 0.0207, Max-Change = 0.0181, Max-Change = 0.0184, Max-Change = 0.0219, Max-Change = 0.0138, Max-Change = 0.0198, Max-Change = 0.0203, Max-Change = 0.0233, Max-Change = 0.0218, Max-Change = 0.0253, Max-Change = 0.0177, Max-Change = 0.0142, Max-Change = 0.0181, Max-Change = 0.0279, Max-Change = 0.0251, Max-Change = 0.0152, Max-Change = 0.0171, Max-Change = 0.0185, Max-Change = 0.0206, Max-Change = 0.0165, Max-Change = 0.0222, Max-Change = 0.0181, Max-Change = 0.0308, Max-Change = 0.0201, Max-Change = 0.0198, Max-Change = 0.0216, Max-Change = 0.0272, Max-Change = 0.0205, Max-Change = 0.0160, Max-Change = 0.0271, Max-Change = 0.0137, Max-Change = 0.0107, Max-Change = 0.0176, Max-Change = 0.0271, Max-Change = 0.0208, Max-Change = 0.0286, Max-Change = 0.0181, Max-Change = 0.0215, Max-Change = 0.0196, Max-Change = 0.0151, Max-Change = 0.0218, Max-Change = 0.0253, Max-Change = 0.0201, Max-Change = 0.0179, Max-Change = 0.0144, Max-Change = 0.0141, Max-Change = 0.0208, Max-Change = 0.0124, Max-Change = 0.0194, Max-Change = 0.0172, Max-Change = 0.0254, Max-Change = 0.0225, Max-Change = 0.0228, Max-Change = 0.0310, Max-Change = 0.0388, Max-Change = 0.0211, Max-Change = 0.0142, Max-Change = 0.0228, Max-Change = 0.0273, Max-Change = 0.0402, Max-Change = 0.0296, Max-Change = 0.0256, Max-Change = 0.0389, Max-Change = 0.0127, Max-Change = 0.0248, Max-Change = 0.0446, Max-Change = 0.0215, Max-Change = 0.0230, Max-Change = 0.0198, Max-Change = 0.0142, Max-Change = 0.0202, Max-Change = 0.0441, Max-Change = 0.0276, Max-Change = 0.0145, Max-Change = 0.0263, Max-Change = 0.0201, Max-Change = 0.0193, Max-Change = 0.0273, Max-Change = 0.0223, Max-Change = 0.0262, Max-Change = 0.0329, Max-Change = 0.0240, Max-Change = 0.0166, Max-Change = 0.0283, Max-Change = 0.0325, Max-Change = 0.0273, Max-Change = 0.0236, Max-Change = 0.0310, Max-Change = 0.0176, Max-Change = 0.0152, Max-Change = 0.0246, Max-Change = 0.0227, Max-Change = 0.0188, Max-Change = 0.0203, Max-Change = 0.0197, Max-Change = 0.0246, Max-Change = 0.0160, Max-Change = 0.0277, Max-Change = 0.0216, Max-Change = 0.0315, Max-Change = 0.0404, Max-Change = 0.0293, Max-Change = 0.0267, Max-Change = 0.0246, Max-Change = 0.0153, Max-Change = 0.0272, Max-Change = 0.0182, Max-Change = 0.0182, Max-Change = 0.0171, Max-Change = 0.0230, Max-Change = 0.0163, Max-Change = 0.0182, Max-Change = 0.0223, Max-Change = 0.0229, Max-Change = 0.0210, Max-Change = 0.0210, Max-Change = 0.0235, Max-Change = 0.0204, Max-Change = 0.0273, Max-Change = 0.0164, Max-Change = 0.0122, Max-Change = 0.0173, Max-Change = 0.0154, Max-Change = 0.0420, Max-Change = 0.0345, Max-Change = 0.0169, Max-Change = 0.0182, Max-Change = 0.0172, Max-Change = 0.0225, Max-Change = 0.0239, Max-Change = 0.0172, Max-Change = 0.0171, Max-Change = 0.0267, Max-Change = 0.0205, Max-Change = 0.0246, Max-Change = 0.0335, Max-Change = 0.0183, Max-Change = 0.0198, Max-Change = 0.0259, gam = 0.0000, Max-Change = 0.0000, gam = 0.1778, Max-Change = 0.0167, gam = 0.1057, Max-Change = 0.0103, gam = 0.0780, Max-Change = 0.0132, gam = 0.0629, Max-Change = 0.0049, gam = 0.0532, Max-Change = 0.0077, gam = 0.0464, Max-Change = 0.0073, gam = 0.0413, Max-Change = 0.0037, gam = 0.0374, Max-Change = 0.0040, gam = 0.0342, Max-Change = 0.0062, gam = 0.0316, Max-Change = 0.0037, gam = 0.0294, Max-Change = 0.0038, gam = 0.0276, Max-Change = 0.0025, gam = 0.0260, Max-Change = 0.0025, gam = 0.0246, Max-Change = 0.0033, gam = 0.0233, Max-Change = 0.0024, gam = 0.0222, Max-Change = 0.0026, gam = 0.0212, Max-Change = 0.0023, gam = 0.0203, Max-Change = 0.0022, gam = 0.0195, Max-Change = 0.0026, gam = 0.0188, Max-Change = 0.0019, gam = 0.0181, Max-Change = 0.0021, gam = 0.0175, Max-Change = 0.0022, gam = 0.0169, Max-Change = 0.0024, gam = 0.0164, Max-Change = 0.0026, gam = 0.0159, Max-Change = 0.0018, gam = 0.0154, Max-Change = 0.0014, gam = 0.0150, Max-Change = 0.0016, gam = 0.0146, Max-Change = 0.0019, gam = 0.0142, Max-Change = 0.0021, gam = 0.0139, Max-Change = 0.0015, gam = 0.0135, Max-Change = 0.0017, gam = 0.0132, Max-Change = 0.0011, gam = 0.0129, Max-Change = 0.0016, gam = 0.0126, Max-Change = 0.0019, gam = 0.0124, Max-Change = 0.0020, gam = 0.0121, Max-Change = 0.0012, gam = 0.0119, Max-Change = 0.0014, gam = 0.0116, Max-Change = 0.0010, gam = 0.0114, Max-Change = 0.0016, gam = 0.0112, Max-Change = 0.0013, gam = 0.0110, Max-Change = 0.0013, gam = 0.0108, Max-Change = 0.0011, gam = 0.0106, Max-Change = 0.0015, gam = 0.0104, Max-Change = 0.0018, gam = 0.0102, Max-Change = 0.0009, gam = 0.0101, Max-Change = 0.0017, gam = 0.0099, Max-Change = 0.0014, gam = 0.0098, Max-Change = 0.0008, gam = 0.0096, Max-Change = 0.0011, gam = 0.0095, Max-Change = 0.0010, gam = 0.0093, Max-Change = 0.0011, gam = 0.0092, Max-Change = 0.0010, gam = 0.0091, Max-Change = 0.0010, gam = 0.0089, Max-Change = 0.0012, gam = 0.0088, Max-Change = 0.0010, gam = 0.0087, Max-Change = 0.0012, gam = 0.0086, Max-Change = 0.0020, gam = 0.0085, Max-Change = 0.0013, gam = 0.0084, Max-Change = 0.0010, gam = 0.0082, Max-Change = 0.0009, gam = 0.0081, Max-Change = 0.0008, gam = 0.0080, Max-Change = 0.0010, gam = 0.0080, Max-Change = 0.0009, gam = 0.0079, Max-Change = 0.0017, gam = 0.0078, Max-Change = 0.0011, gam = 0.0077, Max-Change = 0.0011, gam = 0.0076, Max-Change = 0.0011, gam = 0.0075, Max-Change = 0.0007, gam = 0.0074, Max-Change = 0.0010, gam = 0.0073, Max-Change = 0.0005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating log-likelihood...</span>
<span class="r-in"><span><span class="va">mod_fullconstrain</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="va">model</span>, group <span class="op">=</span> <span class="va">group</span>, method <span class="op">=</span> <span class="st">'MHRM'</span>,</span></span>
<span class="r-in"><span>                             invariance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'slopes'</span>, <span class="st">'intercepts'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , Max-Change = 0.0462, Max-Change = 0.0312, Max-Change = 0.0468, Max-Change = 0.0362, Max-Change = 0.0366, Max-Change = 0.0420, Max-Change = 0.0307, Max-Change = 0.0387, Max-Change = 0.0375, Max-Change = 0.0293, Max-Change = 0.0436, Max-Change = 0.0336, Max-Change = 0.0242, Max-Change = 0.0422, Max-Change = 0.0259, Max-Change = 0.0239, Max-Change = 0.0230, Max-Change = 0.0316, Max-Change = 0.0240, Max-Change = 0.0363, Max-Change = 0.0179, Max-Change = 0.0254, Max-Change = 0.0253, Max-Change = 0.0183, Max-Change = 0.0200, Max-Change = 0.0310, Max-Change = 0.0170, Max-Change = 0.0156, Max-Change = 0.0182, Max-Change = 0.0207, Max-Change = 0.0165, Max-Change = 0.0149, Max-Change = 0.0216, Max-Change = 0.0224, Max-Change = 0.0145, Max-Change = 0.0270, Max-Change = 0.0279, Max-Change = 0.0149, Max-Change = 0.0259, Max-Change = 0.0210, Max-Change = 0.0206, Max-Change = 0.0219, Max-Change = 0.0140, Max-Change = 0.0169, Max-Change = 0.0216, Max-Change = 0.0183, Max-Change = 0.0198, Max-Change = 0.0179, Max-Change = 0.0232, Max-Change = 0.0250, Max-Change = 0.0163, Max-Change = 0.0236, Max-Change = 0.0200, Max-Change = 0.0197, Max-Change = 0.0172, Max-Change = 0.0158, Max-Change = 0.0193, Max-Change = 0.0190, Max-Change = 0.0220, Max-Change = 0.0230, Max-Change = 0.0186, Max-Change = 0.0296, Max-Change = 0.0231, Max-Change = 0.0481, Max-Change = 0.0297, Max-Change = 0.0308, Max-Change = 0.0308, Max-Change = 0.0180, Max-Change = 0.0390, Max-Change = 0.0172, Max-Change = 0.0234, Max-Change = 0.0193, Max-Change = 0.0254, Max-Change = 0.0181, Max-Change = 0.0215, Max-Change = 0.0160, Max-Change = 0.0166, Max-Change = 0.0258, Max-Change = 0.0360, Max-Change = 0.0239, Max-Change = 0.0197, Max-Change = 0.0104, Max-Change = 0.0318, Max-Change = 0.0146, Max-Change = 0.0212, Max-Change = 0.0155, Max-Change = 0.0236, Max-Change = 0.0220, Max-Change = 0.0236, Max-Change = 0.0348, Max-Change = 0.0215, Max-Change = 0.0211, Max-Change = 0.0137, Max-Change = 0.0191, Max-Change = 0.0173, Max-Change = 0.0278, Max-Change = 0.0195, Max-Change = 0.0296, Max-Change = 0.0235, Max-Change = 0.0242, Max-Change = 0.0243, Max-Change = 0.0204, Max-Change = 0.0289, Max-Change = 0.0258, Max-Change = 0.0236, Max-Change = 0.0155, Max-Change = 0.0178, Max-Change = 0.0196, Max-Change = 0.0361, Max-Change = 0.0260, Max-Change = 0.0187, Max-Change = 0.0257, Max-Change = 0.0156, Max-Change = 0.0224, Max-Change = 0.0232, Max-Change = 0.0190, Max-Change = 0.0199, Max-Change = 0.0265, Max-Change = 0.0220, Max-Change = 0.0149, Max-Change = 0.0185, Max-Change = 0.0219, Max-Change = 0.0183, Max-Change = 0.0118, Max-Change = 0.0267, Max-Change = 0.0155, Max-Change = 0.0256, Max-Change = 0.0168, Max-Change = 0.0207, Max-Change = 0.0146, Max-Change = 0.0292, Max-Change = 0.0255, Max-Change = 0.0188, Max-Change = 0.0227, Max-Change = 0.0214, Max-Change = 0.0237, Max-Change = 0.0221, Max-Change = 0.0202, Max-Change = 0.0217, Max-Change = 0.0157, Max-Change = 0.0199, Max-Change = 0.0221, Max-Change = 0.0198, Max-Change = 0.0221, Max-Change = 0.0226, Max-Change = 0.0144, Max-Change = 0.0213, Max-Change = 0.0244, Max-Change = 0.0204, Max-Change = 0.0209, Max-Change = 0.0223, Max-Change = 0.0211, Max-Change = 0.0243, Max-Change = 0.0182, Max-Change = 0.0212, Max-Change = 0.0169, Max-Change = 0.0222, Max-Change = 0.0175, Max-Change = 0.0117, Max-Change = 0.0244, Max-Change = 0.0132, Max-Change = 0.0295, Max-Change = 0.0264, Max-Change = 0.0170, Max-Change = 0.0299, Max-Change = 0.0272, Max-Change = 0.0218, Max-Change = 0.0182, Max-Change = 0.0183, Max-Change = 0.0232, Max-Change = 0.0264, Max-Change = 0.0202, Max-Change = 0.0174, Max-Change = 0.0290, Max-Change = 0.0104, Max-Change = 0.0218, Max-Change = 0.0276, Max-Change = 0.0135, Max-Change = 0.0214, Max-Change = 0.0140, Max-Change = 0.0195, Max-Change = 0.0220, Max-Change = 0.0296, Max-Change = 0.0229, Max-Change = 0.0161, Max-Change = 0.0216, Max-Change = 0.0149, Max-Change = 0.0214, Max-Change = 0.0296, Max-Change = 0.0155, Max-Change = 0.0166, Max-Change = 0.0368, Max-Change = 0.0242, Max-Change = 0.0273, Max-Change = 0.0292, Max-Change = 0.0323, Max-Change = 0.0143, Max-Change = 0.0187, Max-Change = 0.0243, Max-Change = 0.0199, Max-Change = 0.0243, Max-Change = 0.0252, Max-Change = 0.0202, Max-Change = 0.0118, Max-Change = 0.0160, Max-Change = 0.0221, Max-Change = 0.0160, Max-Change = 0.0171, Max-Change = 0.0196, Max-Change = 0.0193, Max-Change = 0.0238, Max-Change = 0.0498, Max-Change = 0.0380, Max-Change = 0.0254, Max-Change = 0.0113, Max-Change = 0.0181, Max-Change = 0.0214, Max-Change = 0.0208, Max-Change = 0.0169, Max-Change = 0.0105, Max-Change = 0.0187, Max-Change = 0.0166, Max-Change = 0.0153, Max-Change = 0.0185, Max-Change = 0.0314, Max-Change = 0.0178, Max-Change = 0.0231, Max-Change = 0.0235, Max-Change = 0.0242, Max-Change = 0.0181, Max-Change = 0.0204, Max-Change = 0.0214, Max-Change = 0.0164, Max-Change = 0.0184, Max-Change = 0.0259, Max-Change = 0.0249, Max-Change = 0.0174, Max-Change = 0.0201, Max-Change = 0.0339, Max-Change = 0.0264, Max-Change = 0.0203, Max-Change = 0.0191, Max-Change = 0.0231, Max-Change = 0.0241, Max-Change = 0.0169, Max-Change = 0.0333, Max-Change = 0.0246, Max-Change = 0.0137, Max-Change = 0.0204, Max-Change = 0.0226, gam = 0.0000, Max-Change = 0.0000, gam = 0.1778, Max-Change = 0.0188, gam = 0.1057, Max-Change = 0.0174, gam = 0.0780, Max-Change = 0.0073, gam = 0.0629, Max-Change = 0.0064, gam = 0.0532, Max-Change = 0.0125, gam = 0.0464, Max-Change = 0.0108, gam = 0.0413, Max-Change = 0.0032, gam = 0.0374, Max-Change = 0.0022, gam = 0.0342, Max-Change = 0.0045, gam = 0.0316, Max-Change = 0.0034, gam = 0.0294, Max-Change = 0.0026, gam = 0.0276, Max-Change = 0.0029, gam = 0.0260, Max-Change = 0.0037, gam = 0.0246, Max-Change = 0.0041, gam = 0.0233, Max-Change = 0.0022, gam = 0.0222, Max-Change = 0.0022, gam = 0.0212, Max-Change = 0.0033, gam = 0.0203, Max-Change = 0.0025, gam = 0.0195, Max-Change = 0.0019, gam = 0.0188, Max-Change = 0.0019, gam = 0.0181, Max-Change = 0.0018, gam = 0.0175, Max-Change = 0.0018, gam = 0.0169, Max-Change = 0.0018, gam = 0.0164, Max-Change = 0.0015, gam = 0.0159, Max-Change = 0.0017, gam = 0.0154, Max-Change = 0.0014, gam = 0.0150, Max-Change = 0.0018, gam = 0.0146, Max-Change = 0.0022, gam = 0.0142, Max-Change = 0.0014, gam = 0.0139, Max-Change = 0.0019, gam = 0.0135, Max-Change = 0.0012, gam = 0.0132, Max-Change = 0.0011, gam = 0.0129, Max-Change = 0.0013, gam = 0.0126, Max-Change = 0.0012, gam = 0.0124, Max-Change = 0.0014, gam = 0.0121, Max-Change = 0.0011, gam = 0.0119, Max-Change = 0.0017, gam = 0.0116, Max-Change = 0.0015, gam = 0.0114, Max-Change = 0.0020, gam = 0.0112, Max-Change = 0.0012, gam = 0.0110, Max-Change = 0.0010, gam = 0.0108, Max-Change = 0.0011, gam = 0.0106, Max-Change = 0.0011, gam = 0.0104, Max-Change = 0.0016, gam = 0.0102, Max-Change = 0.0010, gam = 0.0101, Max-Change = 0.0010, gam = 0.0099, Max-Change = 0.0012, gam = 0.0098, Max-Change = 0.0008, gam = 0.0096, Max-Change = 0.0011, gam = 0.0095, Max-Change = 0.0010, gam = 0.0093, Max-Change = 0.0010, gam = 0.0092, Max-Change = 0.0011, gam = 0.0091, Max-Change = 0.0006, gam = 0.0089, Max-Change = 0.0013, gam = 0.0088, Max-Change = 0.0010, gam = 0.0087, Max-Change = 0.0008, gam = 0.0086, Max-Change = 0.0007, gam = 0.0085, Max-Change = 0.0009</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating log-likelihood...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod_metric</span>, <span class="va">mod_configural</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     AIC    SABIC       HQ      BIC    logLik     X2 df p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_metric     36927.79 37036.86 37020.33 37179.83 -18418.89            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_configural 36918.04 37063.47 37041.43 37254.10 -18399.02 39.745 15 0</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod_fullconstrain</span>, <span class="va">mod_metric</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        AIC    SABIC       HQ      BIC    logLik     X2 df p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_fullconstrain 37023.82 37096.54 37085.52 37191.85 -18481.91            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_metric        36927.79 37036.86 37020.33 37179.83 -18418.89 126.04 15 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">############</span></span></span>
<span class="r-in"><span><span class="co"># polytomous item example</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">1</span>,<span class="fl">.3</span><span class="op">)</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">0</span>,<span class="fl">.7</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">d</span><span class="op">-</span><span class="fl">1</span>, <span class="va">d</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">itemtype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'graded'</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">dataset1</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">N</span>, <span class="va">itemtype</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dataset2</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">N</span>, <span class="va">itemtype</span>, mu <span class="op">=</span> <span class="fl">.1</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dataset1</span>, <span class="va">dataset2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'D1'</span>, <span class="va">N</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'D2'</span>, <span class="va">N</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">'F1 = 1-15'</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod_configural</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="va">model</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_configural</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multipleGroup-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_configural</span>, type <span class="op">=</span> <span class="st">'SE'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multipleGroup-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="itemplot.html">itemplot</a></span><span class="op">(</span><span class="va">mod_configural</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multipleGroup-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="itemplot.html">itemplot</a></span><span class="op">(</span><span class="va">mod_configural</span>, <span class="fl">1</span>, type <span class="op">=</span> <span class="st">'info'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multipleGroup-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_configural</span>, type <span class="op">=</span> <span class="st">'trace'</span><span class="op">)</span> <span class="co"># messy, score function typically better</span></span></span>
<span class="r-plt img"><img src="multipleGroup-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_configural</span>, type <span class="op">=</span> <span class="st">'itemscore'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multipleGroup-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fs</span> <span class="op">&lt;-</span> <span class="fu"><a href="fscores.html">fscores</a></span><span class="op">(</span><span class="va">mod_configural</span>, full.scores <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method:  EAP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical Reliability:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     F1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7942 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method:  EAP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical Reliability:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     F1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7249 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fs</span><span class="op">[[</span><span class="st">"D1"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]      0      0      0      0      0      0      0      0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]      0      0      0      0      0      0      0      0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]      0      0      0      0      0      0      0      0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]      0      0      0      0      0      0      0      0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]      0      0      0      0      0      0      0      0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]      0      0      0      0      0      0      0      0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Item_11 Item_12 Item_13 Item_14 Item_15     F1 SE_F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]       0       0       0       0       0 -2.137 0.626</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]       0       0       0       1       0 -1.786 0.574</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]       0       0       0       2       0 -1.727 0.580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]       0       0       0       3       0 -1.689 0.586</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]       0       0       0       3       1 -1.439 0.554</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]       0       2       0       0       0 -1.583 0.566</span>
<span class="r-in"><span><span class="fu"><a href="fscores.html">fscores</a></span><span class="op">(</span><span class="va">mod_configural</span>, method <span class="op">=</span> <span class="st">'EAPsum'</span>, full.scores <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       df     X2  p.X2 SEM.alpha rxx.alpha rxx_F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stats 39 42.374 0.328     3.869     0.784  0.776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       df     X2  p.X2 SEM.alpha rxx.alpha rxx_F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stats 42 29.475 0.928     3.825     0.842  0.832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Sum.Scores     F1 SE_F1 observed expected std.res</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0           0 -2.137 0.626        6    5.731   0.112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1 -1.842 0.589        6   10.082   1.286</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           2 -1.645 0.575       19   15.026   1.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           3 -1.491 0.568       22   21.117   0.192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           4 -1.323 0.548       31   26.167   0.945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           5 -1.173 0.534       21   30.811   1.768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           6 -1.033 0.523       30   34.974   0.841</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7           7 -0.898 0.510       37   38.286   0.208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8           8 -0.770 0.500       47   40.921   0.950</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9           9 -0.648 0.490       40   42.896   0.442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         10 -0.531 0.481       54   44.208   1.473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         11 -0.417 0.473       52   44.945   1.052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         12 -0.307 0.466       50   45.161   0.720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13         13 -0.201 0.460       35   44.909   1.479</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         14 -0.097 0.455       41   44.252   0.489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         15  0.005 0.450       33   43.244   1.558</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         16  0.104 0.446       50   41.936   1.245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         17  0.202 0.443       38   40.375   0.374</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         18  0.298 0.440       34   38.606   0.741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         19  0.394 0.437       40   36.668   0.550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         20  0.488 0.436       30   34.599   0.782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         21  0.582 0.435       42   32.431   1.680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22         22  0.675 0.434       32   30.195   0.328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23         23  0.768 0.434       28   27.920   0.015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24         24  0.861 0.434       19   25.631   1.310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25         25  0.954 0.435       34   23.350   2.204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26         26  1.048 0.436       21   21.099   0.022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27         27  1.142 0.438       18   18.899   0.207</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28         28  1.237 0.441       21   16.765   1.034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29         29  1.334 0.444       10   14.717   1.229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30         30  1.431 0.447       11   12.767   0.495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31         31  1.530 0.451        8   10.931   0.887</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32         32  1.631 0.456        8    9.221   0.402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33         33  1.733 0.461        8    7.648   0.127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34         34  1.838 0.466        6    6.221   0.089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35         35  1.946 0.472        1    4.949   1.775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36         36  2.056 0.479        4    3.835   0.084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37         37  2.169 0.486        6    2.881   1.838</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38         38  2.287 0.494        3    2.086   0.632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         39  2.409 0.503        3    1.445   1.293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40         40  2.535 0.512        1    0.946   0.055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41         41  2.668 0.522        0    0.580   0.761</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42         42  2.809 0.534        0    0.324   0.569</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43         43  2.955 0.544        0    0.158   0.397</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44         44  3.126 0.559        0    0.066   0.256</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         45  3.345 0.584        0    0.019   0.137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Sum.Scores     F1 SE_F1 observed expected std.res</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0           0 -2.051 0.591        9   11.036   0.613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1 -1.750 0.548       23   16.140   1.708</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           2 -1.554 0.530       22   20.995   0.219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           3 -1.412 0.524       31   27.050   0.759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           4 -1.240 0.493       35   30.434   0.828</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           5 -1.095 0.475       33   33.197   0.034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           6 -0.964 0.460       34   35.476   0.248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7           7 -0.836 0.444       32   36.880   0.804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8           8 -0.718 0.431       32   37.812   0.945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9           9 -0.607 0.419       31   38.353   1.187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         10 -0.501 0.409       28   38.516   1.695</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         11 -0.400 0.400       46   38.404   1.226</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         12 -0.303 0.393       41   38.063   0.476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13         13 -0.210 0.386       36   37.526   0.249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14         14 -0.119 0.381       33   36.830   0.631</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15         15 -0.031 0.376       37   36.003   0.166</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16         16  0.055 0.372       33   35.064   0.349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17         17  0.140 0.369       33   34.032   0.177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18         18  0.223 0.366       42   32.921   1.582</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19         19  0.305 0.364       28   31.744   0.665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20         20  0.386 0.363       29   30.511   0.274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21         21  0.466 0.362       30   29.230   0.142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22         22  0.546 0.362       24   27.908   0.740</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23         23  0.626 0.362       28   26.553   0.281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24         24  0.706 0.363       29   25.169   0.764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25         25  0.787 0.364       27   23.761   0.664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26         26  0.868 0.366       29   22.334   1.411</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27         27  0.950 0.369       19   20.892   0.414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28         28  1.033 0.372       17   19.437   0.553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29         29  1.117 0.376       13   17.975   1.174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30         30  1.203 0.380       19   16.510   0.613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31         31  1.291 0.385       17   15.044   0.504</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32         32  1.381 0.391       17   13.583   0.927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33         33  1.473 0.398       16   12.135   1.109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34         34  1.568 0.405       11   10.703   0.091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35         35  1.667 0.414        8    9.299   0.426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36         36  1.769 0.423       11    7.936   1.088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37         37  1.874 0.433        3    6.617   1.406</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38         38  1.984 0.444        6    5.370   0.272</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39         39  2.101 0.457        4    4.219   0.107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40         40  2.219 0.469        2    3.152   0.649</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41         41  2.344 0.482        2    2.236   0.158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42         42  2.484 0.501        0    1.485   1.219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43         43  2.612 0.511        0    0.842   0.918</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44         44  2.766 0.525        0    0.438   0.662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45         45  2.988 0.555        0    0.185   0.431</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># constrain slopes within each group to be equal (but not across groups)</span></span></span>
<span class="r-in"><span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="st">'F1 = 1-15</span></span></span>
<span class="r-in"><span><span class="st">           CONSTRAIN = (1-15, a1)'</span></span></span>
<span class="r-in"><span><span class="va">mod_configural2</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="va">model2</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_configural2</span>, type <span class="op">=</span> <span class="st">'SE'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multipleGroup-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_configural2</span>, type <span class="op">=</span> <span class="st">'RE'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multipleGroup-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="itemplot.html">itemplot</a></span><span class="op">(</span><span class="va">mod_configural2</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multipleGroup-15.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">############</span></span></span>
<span class="r-in"><span><span class="co">## empirical histogram example (normal and bimodal groups)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">.2</span>, <span class="fl">.2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ThetaNormal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ThetaBimodal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#bimodal</span></span></span>
<span class="r-in"><span><span class="va">Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ThetaNormal</span>, <span class="va">ThetaBimodal</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="fl">4000</span>, itemtype <span class="op">=</span> <span class="st">'2PL'</span>, Theta<span class="op">=</span><span class="va">Theta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'G1'</span>, <span class="st">'G2'</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">2000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">EH</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, group<span class="op">=</span><span class="va">group</span>, dentype<span class="op">=</span><span class="st">"empiricalhist"</span>, invariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">EH</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $G1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.759 -1.830 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1.062 -0.555 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1.235 -1.117 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.611 -0.953 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1.088 -0.132 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  1.054  0.502 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.849  1.581 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.870 -0.779 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.902  1.658 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.812 -1.188 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.903  0.661 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 0.841  2.646 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 0.843 -0.064 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1.009 -0.600 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 1.167  0.013 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_16 1.008  1.886 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_17 0.885 -1.124 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_18 0.790  1.420 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_19 0.799  1.316 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_20 1.565  0.294 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_21 1.002  0.001 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_22 0.929 -0.497 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_23 0.903 -0.383 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_24 1.120  0.702 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_25 0.850  2.002 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_26 0.706 -0.208 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_27 1.048 -1.279 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_28 0.826 -0.770 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_29 1.062  0.221 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_30 0.737 -0.333 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_31 1.208 -0.178 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_32 0.917 -0.202 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_33 0.859 -1.360 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_34 0.913 -0.252 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_35 0.767  0.886 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_36 0.783  0.763 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_37 0.630  0.550 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_38 0.736 -0.405 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_39 0.917 -0.166 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_40 0.895 -1.251 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_41 1.251 -0.040 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_42 0.882  0.202 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_43 0.796  1.639 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_44 1.022  1.038 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_45 0.812 -0.470 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_46 0.807  0.336 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_47 0.815 -1.121 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_48 0.739  0.892 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_49 0.904  1.036 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_50 0.895  2.124 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $G2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.759 -1.830 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1.062 -0.555 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1.235 -1.117 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.611 -0.953 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1.088 -0.132 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  1.054  0.502 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.849  1.581 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.870 -0.779 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.902  1.658 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.812 -1.188 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.903  0.661 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 0.841  2.646 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 0.843 -0.064 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1.009 -0.600 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 1.167  0.013 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_16 1.008  1.886 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_17 0.885 -1.124 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_18 0.790  1.420 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_19 0.799  1.316 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_20 1.565  0.294 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_21 1.002  0.001 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_22 0.929 -0.497 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_23 0.903 -0.383 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_24 1.120  0.702 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_25 0.850  2.002 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_26 0.706 -0.208 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_27 1.048 -1.279 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_28 0.826 -0.770 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_29 1.062  0.221 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_30 0.737 -0.333 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_31 1.208 -0.178 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_32 0.917 -0.202 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_33 0.859 -1.360 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_34 0.913 -0.252 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_35 0.767  0.886 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_36 0.783  0.763 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_37 0.630  0.550 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_38 0.736 -0.405 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_39 0.917 -0.166 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_40 0.895 -1.251 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_41 1.251 -0.040 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_42 0.882  0.202 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_43 0.796  1.639 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_44 1.022  1.038 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_45 0.812 -0.470 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_46 0.807  0.336 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_47 0.815 -1.121 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_48 0.739  0.892 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_49 0.904  1.036 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_50 0.895  2.124 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">EH</span>, type <span class="op">=</span> <span class="st">'empiricalhist'</span>, npts <span class="op">=</span> <span class="fl">60</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multipleGroup-16.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># DIF test for item 1</span></span></span>
<span class="r-in"><span><span class="va">EH1</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, group<span class="op">=</span><span class="va">group</span>, dentype<span class="op">=</span><span class="st">"empiricalhist"</span>, invariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">EH</span>, <span class="va">EH1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          AIC    SABIC       HQ      BIC    logLik    X2 df     p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EH  216599.8 217659.4 217358.4 218739.8 -107959.9               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EH1 216602.9 217668.7 217365.9 218755.4 -107959.4 0.916  2 0.632</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#--------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Mixture model (no prior group variable specified)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nitems</span> <span class="op">&lt;-</span> <span class="fl">20</span></span></span>
<span class="r-in"><span><span class="va">a1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">.75</span>, ncol<span class="op">=</span><span class="fl">1</span>, nrow<span class="op">=</span><span class="va">nitems</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1.25</span>, ncol<span class="op">=</span><span class="fl">1</span>, nrow<span class="op">=</span><span class="va">nitems</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nitems</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nitems</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">itemtype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">a1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">N1</span> <span class="op">&lt;-</span> <span class="fl">500</span></span></span>
<span class="r-in"><span><span class="va">N2</span> <span class="op">&lt;-</span> <span class="va">N1</span><span class="op">*</span><span class="fl">2</span> <span class="co"># second class twice as large</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dataset1</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a1</span>, <span class="va">d1</span>, <span class="va">N1</span>, <span class="va">itemtype</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dataset2</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a2</span>, <span class="va">d2</span>, <span class="va">N2</span>, <span class="va">itemtype</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dataset1</span>, <span class="va">dataset2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># group &lt;- c(rep('D1', N1), rep('D2', N2))</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Mixture Rasch model (Rost, 1990)</span></span></span>
<span class="r-in"><span><span class="va">models</span> <span class="op">&lt;-</span> <span class="st">'F1 = 1-20</span></span></span>
<span class="r-in"><span><span class="st">           CONSTRAIN = (1-20, a1)'</span></span></span>
<span class="r-in"><span><span class="va">mod_mix</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="va">models</span>, dentype <span class="op">=</span> <span class="st">'mixture-2'</span>, GenRandomPars <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod_mix</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $MIXTURE_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1.302  0.772 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1.302  1.476 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1.302 -0.553 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  1.302 -1.588 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1.302 -1.545 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  1.302  2.084 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1.302 -0.510 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  1.302  0.606 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  1.302  0.550 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 1.302 -0.167 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 1.302  0.961 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 1.302  2.156 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 1.302  2.082 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1.302  1.733 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 1.302  0.138 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_16 1.302  0.434 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_17 1.302 -0.368 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_18 1.302 -1.633 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_19 1.302  1.799 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_20 1.302 -0.024 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $class_proportion</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.655</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $MIXTURE_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.681  0.664 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  0.681  0.805 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.681 -0.039 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.681 -0.416 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  0.681  0.530 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.681 -2.045 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  0.681  0.770 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.681 -0.314 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.681 -0.030 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.681 -0.820 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.681 -0.252 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 0.681  1.939 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 0.681  0.642 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 0.681  0.593 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.681 -0.749 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_16 0.681  0.852 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_17 0.681 -0.950 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_18 0.681 -0.345 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_19 0.681  1.230 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_20 0.681  0.271 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $class_proportion</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.345</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod_mix</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GROUP: MIXTURE_1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          F1    h2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 0.608 0.369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SS loadings:  7.386 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion Var:  0.369 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor correlations: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class proportion:  0.655 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GROUP: MIXTURE_2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          F1    h2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 0.371 0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SS loadings:  2.758 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proportion Var:  0.138 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Factor correlations: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class proportion:  0.345 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_mix</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multipleGroup-17.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_mix</span>, type <span class="op">=</span> <span class="st">'trace'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multipleGroup-18.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="itemplot.html">itemplot</a></span><span class="op">(</span><span class="va">mod_mix</span>, <span class="fl">1</span>, type <span class="op">=</span> <span class="st">'info'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="multipleGroup-19.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="fscores.html">fscores</a></span><span class="op">(</span><span class="va">mod_mix</span><span class="op">)</span><span class="op">)</span> <span class="co"># theta estimates</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Class_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  -0.361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  -1.695</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  -0.822</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   0.809</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]   0.794</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]   0.229</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="fscores.html">fscores</a></span><span class="op">(</span><span class="va">mod_mix</span>, method <span class="op">=</span> <span class="st">'classify'</span><span class="op">)</span><span class="op">)</span> <span class="co"># classification probability</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      CLASS_1 CLASS_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   0.048   0.952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   0.742   0.258</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   0.025   0.975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   0.029   0.971</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]   0.072   0.928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]   0.424   0.576</span>
<span class="r-in"><span><span class="fu"><a href="itemfit.html">itemfit</a></span><span class="op">(</span><span class="va">mod_mix</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item   S_X2 df.S_X2 RMSEA.S_X2 p.S_X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1 30.498      12      0.032  0.002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2 36.271      12      0.037  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3 15.756      12      0.014  0.203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4  9.334      11      0.000  0.591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5 21.638      12      0.023  0.042</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6 26.071      13      0.026  0.017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7  8.624      12      0.000  0.735</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8 16.652      12      0.016  0.163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9 22.772      12      0.024  0.030</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10 14.622      12      0.012  0.263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Item_11  7.357      12      0.000  0.833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Item_12 14.964      12      0.013  0.243</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Item_13 10.222      12      0.000  0.597</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Item_14 17.414      13      0.015  0.181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 Item_15  9.436      12      0.000  0.665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Item_16 11.408      12      0.000  0.494</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 Item_17 16.483      12      0.016  0.170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Item_18 11.717      11      0.007  0.385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Item_19 11.425      12      0.000  0.493</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Item_20 15.291      12      0.014  0.226</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Mixture 2PL model</span></span></span>
<span class="r-in"><span><span class="va">mod_mix2</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, dentype <span class="op">=</span> <span class="st">'mixture-2'</span>, GenRandomPars <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod_mix</span>, <span class="va">mod_mix2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik     X2 df    p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_mix  34628.19 34720.06 34713.30 34856.65 -17271.09               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_mix2 34655.23 34828.29 34815.56 35085.60 -17246.62 48.957 38 0.11</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod_mix2</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $MIXTURE_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  0.517  0.672 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  0.516  0.826 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.533 -0.012 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  0.387 -0.363 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  0.452  0.551 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.727 -1.905 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1.032  0.879 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  0.744 -0.275 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  0.900  0.037 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 0.709 -0.777 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 0.538 -0.190 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 0.915  2.079 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 0.729  0.690 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1.183  0.722 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 0.812 -0.717 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_16 0.582  0.843 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_17 0.791 -0.953 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_18 0.657 -0.290 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_19 0.498  1.222 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_20 0.468  0.304 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $class_proportion</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $MIXTURE_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1.118  0.710 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1.216  1.405 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1.244 -0.565 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  1.684 -1.826 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1.669 -1.800 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  1.473  2.151 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1.143 -0.510 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  1.244  0.574 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  1.272  0.507 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 1.188 -0.183 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 1.465  0.980 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 1.403  2.208 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 1.388  2.110 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1.062  1.599 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 1.311  0.112 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_16 1.191  0.410 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_17 1.381 -0.387 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_18 1.500 -1.798 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_19 1.624  1.955 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_20 1.353 -0.060 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $class_proportion</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.651</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="itemfit.html">itemfit</a></span><span class="op">(</span><span class="va">mod_mix2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item   S_X2 df.S_X2 RMSEA.S_X2 p.S_X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1 21.271      12      0.023  0.047</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2 44.619      13      0.040  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3 14.259      12      0.011  0.284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4  6.550      11      0.000  0.834</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5 20.639      12      0.022  0.056</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6 27.956      13      0.028  0.009</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7  8.628      12      0.000  0.734</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8 16.261      12      0.015  0.180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9 21.304      12      0.023  0.046</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10 11.460      12      0.000  0.490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Item_11  7.091      12      0.000  0.852</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Item_12 13.838      12      0.010  0.311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Item_13 10.444      12      0.000  0.577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Item_14 15.704      13      0.012  0.265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 Item_15  9.439      12      0.000  0.665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Item_16 10.128      12      0.000  0.605</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 Item_17 17.474      12      0.017  0.133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Item_18 11.833      11      0.007  0.376</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Item_19  8.071      11      0.000  0.707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Item_20 14.542      12      0.012  0.267</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare to single group</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">mod_mix2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               AIC    SABIC       HQ      BIC    logLik      X2 df p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod      35276.70 35362.16 35355.88 35489.23 -17598.35             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mod_mix2 34655.23 34828.29 34815.56 35085.60 -17246.62 703.474 41 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">########################################</span></span></span>
<span class="r-in"><span><span class="co"># Zero-inflated 2PL IRT model (Wall, Park, and Moustaki, 2015)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">nitems</span> <span class="op">&lt;-</span> <span class="fl">20</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">nitems</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, each<span class="op">=</span><span class="va">nitems</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">zi_p</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># Proportion of people in zero class</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">zeros</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">*</span><span class="va">zi_p</span>, <span class="va">nitems</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nonzeros</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">n</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">zi_p</span><span class="op">)</span>, itemtype <span class="op">=</span> <span class="st">'2PL'</span>,</span></span>
<span class="r-in"><span>                   Theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">zi_p</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">nonzeros</span>, <span class="va">zeros</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define class with extreme theta but fixed item parameters</span></span></span>
<span class="r-in"><span><span class="va">zi2PL</span> <span class="op">&lt;-</span> <span class="st">"F = 1-20</span></span></span>
<span class="r-in"><span><span class="st">          START [MIXTURE_1] = (GROUP, MEAN_1, -100), (GROUP, COV_11, .00001),</span></span></span>
<span class="r-in"><span><span class="st">                              (1-20, a1, 1.0), (1-20, d, 0)</span></span></span>
<span class="r-in"><span><span class="st">          FIXED [MIXTURE_1] = (GROUP, MEAN_1), (GROUP, COV_11),</span></span></span>
<span class="r-in"><span><span class="st">                              (1-20, a1), (1-20, d)"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define custom Theta integration grid that contains extreme theta + normal grid</span></span></span>
<span class="r-in"><span><span class="va">technical</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>customTheta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>,<span class="fl">6</span>,length.out<span class="op">=</span><span class="fl">61</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit ZIM-IRT</span></span></span>
<span class="r-in"><span><span class="va">zi2PL.fit</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">data</span>, <span class="va">zi2PL</span>, dentype <span class="op">=</span> <span class="st">'mixture-2'</span>, technical<span class="op">=</span><span class="va">technical</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">zi2PL.fit</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $MIXTURE_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         a1 d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1   1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2   1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3   1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4   1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5   1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6   1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7   1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8   1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9   1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10  1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11  1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12  1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13  1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14  1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15  1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_16  1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_17  1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_18  1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_19  1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_20  1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $class_proportion</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.209</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $MIXTURE_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1      d g u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1.867 -2.089 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  1.998 -1.979 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1.954 -1.932 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  1.595 -1.841 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1.922 -0.986 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  1.924 -0.926 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  2.045 -1.209 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  2.069 -1.005 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  1.782  0.101 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 1.942  0.195 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 2.080  0.039 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 1.956  0.039 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 1.540  0.835 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 2.047  1.092 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 1.956  0.973 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_16 1.807  1.026 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_17 2.084  2.069 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_18 1.917  2.153 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_19 1.464  1.735 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_20 1.739  1.920 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $class_proportion</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     pi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># classification estimates</span></span></span>
<span class="r-in"><span><span class="va">pi_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="fscores.html">fscores</a></span><span class="op">(</span><span class="va">zi2PL.fit</span>, method <span class="op">=</span> <span class="st">'classify'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pi_hat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      CLASS_1 CLASS_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]       0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]       0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]       0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]       0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]       0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]       0       1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">pi_hat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         CLASS_1 CLASS_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [995,]   0.924   0.076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [996,]   0.924   0.076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [997,]   0.924   0.076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [998,]   0.924   0.076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [999,]   0.924   0.076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1000,]   0.924   0.076</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EAP estimates (not useful for zip class)</span></span></span>
<span class="r-in"><span><span class="va">fs</span> <span class="op">&lt;-</span> <span class="fu"><a href="fscores.html">fscores</a></span><span class="op">(</span><span class="va">zi2PL.fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Class_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   0.262</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  -1.762</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   0.286</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   0.563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  -1.669</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]   0.006</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">fs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Class_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [995,] -92.596</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [996,] -92.596</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [997,] -92.596</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [998,] -92.596</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [999,] -92.596</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1000,] -92.596</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">########################################</span></span></span>
<span class="r-in"><span><span class="co"># Zero-inflated graded response model (Magnus and Garnier-Villarreal, 2022)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">nitems</span> <span class="op">&lt;-</span> <span class="fl">20</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">.2</span>,<span class="fl">.3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># for the graded model, ensure that there is enough space between the intercepts,</span></span></span>
<span class="r-in"><span><span class="co"># otherwise closer categories will not be selected often (minimum distance of 0.3 here)</span></span></span>
<span class="r-in"><span><span class="va">diffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">*</span><span class="fl">4</span>, <span class="fl">.3</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">20</span><span class="op">)</span>, <span class="fl">1</span>, <span class="va">cumsum</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">diffs</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="op">(</span><span class="va">diffs</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">diffs</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">diffs</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">zi_p</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># Proportion of people in zero/lowest category class</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">zeros</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">*</span><span class="va">zi_p</span>, <span class="va">nitems</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nonzeros</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">d</span>, <span class="va">n</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">zi_p</span><span class="op">)</span>, itemtype <span class="op">=</span> <span class="st">'graded'</span>,</span></span>
<span class="r-in"><span>                    Theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">zi_p</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">nonzeros</span>, <span class="va">zeros</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># intercepts will be labelled as d1 through d4</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">data</span>, <span class="fl">2</span>, <span class="va">table</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0    474    276    431    384    763    354    420    379    342     610</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    128     61    107     26     69     99    140    137    116     114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     62    105    112     54     45     58    120    136    165      98</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     89    135    159     87     37    135    118     70     68      34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    247    423    191    449     86    354    202    278    309     144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Item_11 Item_12 Item_13 Item_14 Item_15 Item_16 Item_17 Item_18 Item_19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0     393     756     668     605     463     321     683     664     406</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     115     114      75     104      74      55      65      46      99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      54      62      55     113     119     123      58      46      66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     134      33      66      81      89     130      42      57      67</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     304      35     136      97     255     371     152     187     362</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Item_20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0     588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     174</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ignoring zero inflation (bad idea)</span></span></span>
<span class="r-in"><span><span class="va">modGRM</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>EM cycles terminated after 500 iterations.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">modGRM</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1     d1     d2     d3     d4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  2.540 -0.223 -1.106 -1.527 -2.166</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  2.284  1.418  0.791 -0.010 -0.848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  1.771  0.167 -0.479 -1.108 -2.132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  3.367  0.392  0.141 -0.330 -1.021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  3.450 -2.806 -3.524 -4.105 -4.691</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  2.003  0.715  0.013 -0.347 -1.145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  2.375  0.182 -0.781 -1.545 -2.405</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  2.286  0.515 -0.466 -1.336 -1.795</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  2.768  0.837 -0.152 -1.319 -1.801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 2.910 -1.290 -2.154 -3.034 -3.397</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 2.681  0.382 -0.484 -0.858 -1.792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 1.734 -1.721 -2.648 -3.462 -4.224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 2.042 -1.307 -1.802 -2.209 -2.804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 1.914 -0.871 -1.516 -2.346 -3.185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 4.247 -0.504 -1.187 -2.250 -3.114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_16 2.628  1.020  0.501 -0.428 -1.305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_17 2.522 -1.628 -2.114 -2.605 -3.007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_18 2.547 -1.508 -1.835 -2.189 -2.675</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_19 1.906  0.340 -0.291 -0.677 -1.065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_20 2.287 -0.906 -1.572 -2.181 -2.606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define class with extreme theta but fixed item parameters</span></span></span>
<span class="r-in"><span><span class="co">#   For GRM in zero-inflated class the intercept values are arbitrary</span></span></span>
<span class="r-in"><span><span class="co">#   as the model forces the responses all into the first category (hence,</span></span></span>
<span class="r-in"><span><span class="co">#   spacing arbitrarily set to 1)</span></span></span>
<span class="r-in"><span><span class="va">ziGRM</span> <span class="op">&lt;-</span> <span class="st">"F = 1-20</span></span></span>
<span class="r-in"><span><span class="st">          START [MIXTURE_1] = (GROUP, MEAN_1, -100), (GROUP, COV_11, .00001),</span></span></span>
<span class="r-in"><span><span class="st">                              (1-20, a1, 1.0),</span></span></span>
<span class="r-in"><span><span class="st">                              (1-20, d1, 2), (1-20, d2, 1), (1-20, d3, 0), (1-20, d4, -1)</span></span></span>
<span class="r-in"><span><span class="st">          FIXED [MIXTURE_1] = (GROUP, MEAN_1), (GROUP, COV_11),</span></span></span>
<span class="r-in"><span><span class="st">                              (1-20, a1),</span></span></span>
<span class="r-in"><span><span class="st">                              (1-20, d1), (1-20, d2), (1-20, d3), (1-20, d4)"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define custom Theta integration grid that contains extreme theta + normal grid</span></span></span>
<span class="r-in"><span><span class="va">technical</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>customTheta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>,<span class="fl">6</span>,length.out<span class="op">=</span><span class="fl">61</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit zero-inflated GRM</span></span></span>
<span class="r-in"><span><span class="va">ziGRM.fit</span> <span class="op">&lt;-</span> <span class="fu">multipleGroup</span><span class="op">(</span><span class="va">data</span>, <span class="va">ziGRM</span>, dentype <span class="op">=</span> <span class="st">'mixture-2'</span>, technical<span class="op">=</span><span class="va">technical</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">ziGRM.fit</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $MIXTURE_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         a1 d1 d2 d3 d4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1   1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2   1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3   1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4   1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5   1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6   1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7   1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8   1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9   1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10  1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11  1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12  1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13  1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14  1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15  1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_16  1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_17  1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_18  1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_19  1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_20  1  2  1  0 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    F </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $class_proportion</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   pi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $MIXTURE_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            a1     d1     d2     d3     d4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_1  1.287  0.857 -0.022 -0.438 -1.068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_2  0.764  2.477  1.751  0.932  0.124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_3  0.695  0.975  0.325 -0.293 -1.284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_4  1.711  1.782  1.532  1.064  0.381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_5  1.928 -1.382 -2.106 -2.689 -3.276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_6  0.751  1.601  0.875  0.518 -0.255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_7  1.137  1.198  0.242 -0.506 -1.343</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_8  1.030  1.498  0.515 -0.332 -0.778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_9  1.307  1.994  0.998 -0.138 -0.604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_10 1.583 -0.062 -0.930 -1.809 -2.171</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_11 1.308  1.508  0.644  0.276 -0.636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_12 0.886 -0.954 -1.873 -2.677 -3.431</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_13 1.048 -0.420 -0.912 -1.315 -1.903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_14 0.946 -0.030 -0.668 -1.485 -2.310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_15 2.338  1.299  0.604 -0.475 -1.353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_16 1.154  2.119  1.582  0.664 -0.180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_17 1.363 -0.559 -1.046 -1.536 -1.937</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_18 1.359 -0.428 -0.755 -1.108 -1.591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_19 0.725  1.173  0.539  0.161 -0.216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Item_20 1.179  0.077 -0.586 -1.190 -1.609</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $means</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $class_proportion</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   pi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># classification estimates</span></span></span>
<span class="r-in"><span><span class="va">pi_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="fscores.html">fscores</a></span><span class="op">(</span><span class="va">ziGRM.fit</span>, method <span class="op">=</span> <span class="st">'classify'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pi_hat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      CLASS_1 CLASS_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]       0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]       0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]       0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]       0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]       0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]       0       1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">pi_hat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         CLASS_1 CLASS_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [995,]   0.998   0.002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [996,]   0.998   0.002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [997,]   0.998   0.002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [998,]   0.998   0.002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [999,]   0.998   0.002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1000,]   0.998   0.002</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EAP estimates (not useful for zip class)</span></span></span>
<span class="r-in"><span><span class="va">fs</span> <span class="op">&lt;-</span> <span class="fu"><a href="fscores.html">fscores</a></span><span class="op">(</span><span class="va">ziGRM.fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Class_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  -0.541</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   0.857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   1.506</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   1.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]   0.221</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  -1.409</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">fs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Class_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [995,] -99.829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [996,] -99.829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [997,] -99.829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [998,] -99.829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [999,] -99.829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1000,] -99.829</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

