<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Multidimensional discrete item response theory — mdirt • mirt</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multidimensional discrete item response theory — mdirt"><meta name="description" content="mdirt fits a variety of item response models with discrete latent variables.
These include, but are not limited to, latent class analysis, multidimensional latent
class models, multidimensional discrete latent class models, DINA/DINO models,
grade of measurement models, C-RUM, and so on. If response models are not defined explicitly
then customized models can defined using the createItem function."><meta property="og:description" content="mdirt fits a variety of item response models with discrete latent variables.
These include, but are not limited to, latent class analysis, multidimensional latent
class models, multidimensional discrete latent class models, DINA/DINO models,
grade of measurement models, C-RUM, and so on. If response models are not defined explicitly
then customized models can defined using the createItem function."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mirt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.42.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/mirt-vignettes.html">UNKNOWN TITLE</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/philchalmers/mirt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Multidimensional discrete item response theory</h1>
      <small class="dont-index">Source: <a href="https://github.com/philchalmers/mirt/blob/main/R/mdirt.R" class="external-link"><code>R/mdirt.R</code></a></small>
      <div class="d-none name"><code>mdirt.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>mdirt</code> fits a variety of item response models with discrete latent variables.
These include, but are not limited to, latent class analysis, multidimensional latent
class models, multidimensional discrete latent class models, DINA/DINO models,
grade of measurement models, C-RUM, and so on. If response models are not defined explicitly
then customized models can defined using the <code><a href="createItem.html">createItem</a></code> function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mdirt</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  customTheta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  structure <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  item.Q <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nruns <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"EM"</span>,</span>
<span>  covdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  itemtype <span class="op">=</span> <span class="st">"lca"</span>,</span>
<span>  optimizer <span class="op">=</span> <span class="st">"nlminb"</span>,</span>
<span>  return_max <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  GenRandomPars <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  technical <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a <code>matrix</code> or <code>data.frame</code> that consists of
numerically ordered data, organized in the form of integers,
 with missing data coded as <code>NA</code></p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>number of mutually exclusive classes to fit, or alternatively a more specific
<code><a href="mirt.model.html">mirt.model</a></code> definition (which reflects the so-called Q-matrix).
Note that when using a <code><a href="mirt.model.html">mirt.model</a></code>,
the order with which the syntax factors/attributes are defined are associated with the
columns in the <code>customTheta</code> input</p></dd>


<dt id="arg-customtheta">customTheta<a class="anchor" aria-label="anchor" href="#arg-customtheta"></a></dt>
<dd><p>input passed to <code>technical = list(customTheta = ...)</code>, but is included
directly in this function for convenience. This input is most interesting for discrete latent models
because it allows customized patterns of latent classes (i.e., defines the possible combinations
of the latent attribute profile). The default builds the pattern <code>customTheta = diag(model)</code>,
which is the typical pattern for the traditional latent class analysis whereby class
membership mutually distinct and exhaustive. See <code><a href="thetaComb.html">thetaComb</a></code> for a quick method
to generate a matrix with all possible combinations</p></dd>


<dt id="arg-structure">structure<a class="anchor" aria-label="anchor" href="#arg-structure"></a></dt>
<dd><p>an R formula allowing the profile probability patterns (i.e., the structural component of
the model) to be fitted according to a log-linear model. When <code>NULL</code>, all profile probabilities
(except one) will be estimated. Use of this input requires that the <code>customTheta</code> input is supplied,
and that the column names in this matrix match the names found within this formula</p></dd>


<dt id="arg-item-q">item.Q<a class="anchor" aria-label="anchor" href="#arg-item-q"></a></dt>
<dd><p>a list of item-level Q-matrices indicating how the respective categories should be
modeled by the underlying attributes. Each matrix must represent a \(K_i \times A\) matrix,
where \(K_i\) represents the number of categories for the ith item, and \(A\) is the number
of attributes included in the <code>Theta</code> matrix; otherwise, a value of<code>NULL</code> will default
to a matrix consisting of 1's for each \(K_i \times A\) element except for the first row, which
contains only 0's for proper identification. Incidentally, the first row of each matrix <code>must</code>
contain only 0's so that the first category represents the reference category for identification</p></dd>


<dt id="arg-nruns">nruns<a class="anchor" aria-label="anchor" href="#arg-nruns"></a></dt>
<dd><p>a numeric value indicating how many times the model should be fit to the data
when using random starting values. If greater than 1, <code>GenRandomPars</code> is set to true
by default</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>estimation method. Can be 'EM' or 'BL' (see <code><a href="mirt.html">mirt</a></code> for more details)</p></dd>


<dt id="arg-covdata">covdata<a class="anchor" aria-label="anchor" href="#arg-covdata"></a></dt>
<dd><p>a data.frame of data used for latent regression models</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>an R formula (or list of formulas) indicating how the latent traits
can be regressed using external covariates in <code>covdata</code>. If a named list
of formulas is supplied (where the names correspond to the latent trait/attribute names in <code>model</code>)
then specific regression effects can be estimated for each factor. Supplying a single formula
will estimate the regression parameters for all latent variables by default</p></dd>


<dt id="arg-itemtype">itemtype<a class="anchor" aria-label="anchor" href="#arg-itemtype"></a></dt>
<dd><p>a vector indicating the itemtype associated with each item.
For discrete models this is limited to only 'lca' or items defined using a
<code><a href="createItem.html">createItem</a></code> definition</p></dd>


<dt id="arg-optimizer">optimizer<a class="anchor" aria-label="anchor" href="#arg-optimizer"></a></dt>
<dd><p>optimizer used for the M-step, set to <code>'nlminb'</code> by default.
See <code><a href="mirt.html">mirt</a></code> for more details</p></dd>


<dt id="arg-return-max">return_max<a class="anchor" aria-label="anchor" href="#arg-return-max"></a></dt>
<dd><p>logical; when <code>nruns &gt; 1</code>, return the model that has the most optimal
maximum likelihood criteria? If FALSE, returns a list of all the estimated objects</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>a factor variable indicating group membership used for multiple group analyses</p></dd>


<dt id="arg-genrandompars">GenRandomPars<a class="anchor" aria-label="anchor" href="#arg-genrandompars"></a></dt>
<dd><p>logical; use random starting values</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical; turn on messages to the R console</p></dd>


<dt id="arg-pars">pars<a class="anchor" aria-label="anchor" href="#arg-pars"></a></dt>
<dd><p>used for modifying starting values; see <code><a href="mirt.html">mirt</a></code> for details</p></dd>


<dt id="arg-technical">technical<a class="anchor" aria-label="anchor" href="#arg-technical"></a></dt>
<dd><p>list of lower-level inputs. See <code><a href="mirt.html">mirt</a></code> for details</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments to be passed to the estimation engine. See <code><a href="mirt.html">mirt</a></code>
for more details and examples</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Posterior classification accuracy for each response pattern may be obtained
via the <code><a href="fscores.html">fscores</a></code> function. The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function will display
the category probability values given the class membership, which can also
be displayed graphically with <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>, while <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code>
displays the raw coefficient values (and their standard errors, if estimated). Finally,
<code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code> is used to compare nested models, while
<code><a href="M2.html">M2</a></code> and <code><a href="itemfit.html">itemfit</a></code> may be used for model fitting purposes.</p>
    </div>
    <div class="section level2">
    <h2 id="-lca-model-definition">'lca' model definition<a class="anchor" aria-label="anchor" href="#-lca-model-definition"></a></h2>



<p>The latent class IRT model with two latent classes has the form</p>
<p>$$P(x = k|\theta_1, \theta_2, a1, a2) = \frac{exp(a1 \theta_1 + a2 \theta_2)}{
  \sum_j^K exp(a1 \theta_1 + a2 \theta_2)}$$</p>
<p>where the \(\theta\) values generally take on discrete points (such as 0 or 1).
For proper identification, the first category slope parameters
(\(a1\) and \(a2\)) are never freely estimated. Alternatively, supplying a different
grid of \(\theta\) values will allow the estimation of similar models (multidimensional
discrete models, grade of membership, etc.). See the examples below.</p>
<p>When the <code>item.Q</code> for is utilized, the above equation can be understood as</p>
<p>$$P(x = k|\theta_1, \theta_2, a1, a2) = \frac{exp(a1 \theta_1 Q_{j1} + a2 \theta_2 Q_{j2})}{
  \sum_j^K exp(a1 \theta_1 Q_{j1} + a2 \theta_2 Q_{j2})}$$</p>
<p>where by construction <code>Q</code> is a \(K_i \times A\) matrix indicating whether the category should
be modeled according to the latent class structure. For the standard latent class model, the Q-matrix
has as many rows as categories, as many columns as the number of classes/attributes modeled,
and consist of 0's in the first row and 1's elsewhere. This of course can be over-written by passing
an alternative <code>item.Q</code> definition for each respective item.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Chalmers, R., P. (2012). mirt: A Multidimensional Item Response Theory
Package for the R Environment. <em>Journal of Statistical Software, 48</em>(6), 1-29.</p>
<p>Proctor, C. H. (1970). A probabilistic formulation and statistical analysis for Guttman scaling.
  <em>Psychometrika, 35</em>, 73-78.
<a href="https://doi.org/10.18637/jss.v048.i06" class="external-link">doi:10.18637/jss.v048.i06</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="thetaComb.html">thetaComb</a></code>, <code><a href="fscores.html">fscores</a></code>, <code><a href="mirt.model.html">mirt.model</a></code>, <code><a href="M2.html">M2</a></code>,
  <code><a href="itemfit.html">itemfit</a></code>, <code><a href="boot.mirt.html">boot.mirt</a></code>, <code><a href="mirtCluster.html">mirtCluster</a></code>,
  <code><a href="wald.html">wald</a></code>, <code><a href="coef-method.html">coef-method</a></code>, <code><a href="summary-method.html">summary-method</a></code>,
  <code><a href="anova-method.html">anova-method</a></code>, <code><a href="residuals-method.html">residuals-method</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># LSAT6 dataset</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="expand.table.html">expand.table</a></span><span class="op">(</span><span class="va">LSAT6</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit with 2-3 latent classes</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">mdirt</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration: 1, Log-Lik: -3209.317, Max-Change: 2.67790Iteration: 2, Log-Lik: -2475.451, Max-Change: 0.21401Iteration: 3, Log-Lik: -2470.563, Max-Change: 0.09205Iteration: 4, Log-Lik: -2469.778, Max-Change: 0.05245Iteration: 5, Log-Lik: -2469.535, Max-Change: 0.03452Iteration: 6, Log-Lik: -2469.405, Max-Change: 0.02589Iteration: 7, Log-Lik: -2469.246, Max-Change: 0.02880Iteration: 8, Log-Lik: -2469.158, Max-Change: 0.01855Iteration: 9, Log-Lik: -2469.093, Max-Change: 0.01736Iteration: 10, Log-Lik: -2469.039, Max-Change: 0.03472Iteration: 11, Log-Lik: -2468.920, Max-Change: 0.01539Iteration: 12, Log-Lik: -2468.878, Max-Change: 0.01420Iteration: 13, Log-Lik: -2468.831, Max-Change: 0.02339Iteration: 14, Log-Lik: -2468.770, Max-Change: 0.01408Iteration: 15, Log-Lik: -2468.735, Max-Change: 0.01310Iteration: 16, Log-Lik: -2468.695, Max-Change: 0.02106Iteration: 17, Log-Lik: -2468.645, Max-Change: 0.01246Iteration: 18, Log-Lik: -2468.615, Max-Change: 0.01221Iteration: 19, Log-Lik: -2468.581, Max-Change: 0.02004Iteration: 20, Log-Lik: -2468.534, Max-Change: 0.01204Iteration: 21, Log-Lik: -2468.507, Max-Change: 0.01004Iteration: 22, Log-Lik: -2468.496, Max-Change: 0.02473Iteration: 23, Log-Lik: -2468.422, Max-Change: 0.01147Iteration: 24, Log-Lik: -2468.398, Max-Change: 0.01041Iteration: 25, Log-Lik: -2468.376, Max-Change: 0.02018Iteration: 26, Log-Lik: -2468.328, Max-Change: 0.01024Iteration: 27, Log-Lik: -2468.308, Max-Change: 0.00924Iteration: 28, Log-Lik: -2468.300, Max-Change: 0.02179Iteration: 29, Log-Lik: -2468.241, Max-Change: 0.00899Iteration: 30, Log-Lik: -2468.223, Max-Change: 0.00917Iteration: 31, Log-Lik: -2468.205, Max-Change: 0.01688Iteration: 32, Log-Lik: -2468.170, Max-Change: 0.00823Iteration: 33, Log-Lik: -2468.154, Max-Change: 0.00852Iteration: 34, Log-Lik: -2468.138, Max-Change: 0.01546Iteration: 35, Log-Lik: -2468.107, Max-Change: 0.00808Iteration: 36, Log-Lik: -2468.093, Max-Change: 0.00770Iteration: 37, Log-Lik: -2468.085, Max-Change: 0.01709Iteration: 38, Log-Lik: -2468.047, Max-Change: 0.00756Iteration: 39, Log-Lik: -2468.033, Max-Change: 0.00694Iteration: 40, Log-Lik: -2468.033, Max-Change: 0.01749Iteration: 41, Log-Lik: -2467.990, Max-Change: 0.00707Iteration: 42, Log-Lik: -2467.978, Max-Change: 0.00670Iteration: 43, Log-Lik: -2467.975, Max-Change: 0.01603Iteration: 44, Log-Lik: -2467.939, Max-Change: 0.00663Iteration: 45, Log-Lik: -2467.929, Max-Change: 0.00628Iteration: 46, Log-Lik: -2467.927, Max-Change: 0.01508Iteration: 47, Log-Lik: -2467.895, Max-Change: 0.00612Iteration: 48, Log-Lik: -2467.885, Max-Change: 0.00614Iteration: 49, Log-Lik: -2467.886, Max-Change: 0.01511Iteration: 50, Log-Lik: -2467.853, Max-Change: 0.00604Iteration: 51, Log-Lik: -2467.844, Max-Change: 0.00554Iteration: 52, Log-Lik: -2467.835, Max-Change: 0.01010Iteration: 53, Log-Lik: -2467.821, Max-Change: 0.00526Iteration: 54, Log-Lik: -2467.814, Max-Change: 0.00533Iteration: 55, Log-Lik: -2467.814, Max-Change: 0.01387Iteration: 56, Log-Lik: -2467.787, Max-Change: 0.00518Iteration: 57, Log-Lik: -2467.780, Max-Change: 0.00445Iteration: 58, Log-Lik: -2467.778, Max-Change: 0.01108Iteration: 59, Log-Lik: -2467.758, Max-Change: 0.00559Iteration: 60, Log-Lik: -2467.752, Max-Change: 0.00397Iteration: 61, Log-Lik: -2467.745, Max-Change: 0.00700Iteration: 62, Log-Lik: -2467.738, Max-Change: 0.00388Iteration: 63, Log-Lik: -2467.732, Max-Change: 0.00563Iteration: 64, Log-Lik: -2467.724, Max-Change: 0.00766Iteration: 65, Log-Lik: -2467.716, Max-Change: 0.00398Iteration: 66, Log-Lik: -2467.711, Max-Change: 0.00555Iteration: 67, Log-Lik: -2467.704, Max-Change: 0.00726Iteration: 68, Log-Lik: -2467.696, Max-Change: 0.00448Iteration: 69, Log-Lik: -2467.691, Max-Change: 0.00340Iteration: 70, Log-Lik: -2467.691, Max-Change: 0.00960Iteration: 71, Log-Lik: -2467.675, Max-Change: 0.00460Iteration: 72, Log-Lik: -2467.671, Max-Change: 0.00320Iteration: 73, Log-Lik: -2467.666, Max-Change: 0.00647Iteration: 74, Log-Lik: -2467.660, Max-Change: 0.00455Iteration: 75, Log-Lik: -2467.655, Max-Change: 0.00346Iteration: 76, Log-Lik: -2467.651, Max-Change: 0.00712Iteration: 77, Log-Lik: -2467.643, Max-Change: 0.00459Iteration: 78, Log-Lik: -2467.639, Max-Change: 0.00319Iteration: 79, Log-Lik: -2467.635, Max-Change: 0.00690Iteration: 80, Log-Lik: -2467.628, Max-Change: 0.00439Iteration: 81, Log-Lik: -2467.624, Max-Change: 0.00308Iteration: 82, Log-Lik: -2467.620, Max-Change: 0.00652Iteration: 83, Log-Lik: -2467.615, Max-Change: 0.00407Iteration: 84, Log-Lik: -2467.611, Max-Change: 0.00291Iteration: 85, Log-Lik: -2467.607, Max-Change: 0.00631Iteration: 86, Log-Lik: -2467.602, Max-Change: 0.00328Iteration: 87, Log-Lik: -2467.598, Max-Change: 0.00354Iteration: 88, Log-Lik: -2467.595, Max-Change: 0.00435Iteration: 89, Log-Lik: -2467.591, Max-Change: 0.00248Iteration: 90, Log-Lik: -2467.589, Max-Change: 0.00331Iteration: 91, Log-Lik: -2467.585, Max-Change: 0.00380Iteration: 92, Log-Lik: -2467.582, Max-Change: 0.00267Iteration: 93, Log-Lik: -2467.580, Max-Change: 0.00317Iteration: 94, Log-Lik: -2467.577, Max-Change: 0.00345Iteration: 95, Log-Lik: -2467.574, Max-Change: 0.00281Iteration: 96, Log-Lik: -2467.572, Max-Change: 0.00304Iteration: 97, Log-Lik: -2467.569, Max-Change: 0.00319Iteration: 98, Log-Lik: -2467.566, Max-Change: 0.00287Iteration: 99, Log-Lik: -2467.564, Max-Change: 0.00293Iteration: 100, Log-Lik: -2467.561, Max-Change: 0.00299Iteration: 101, Log-Lik: -2467.559, Max-Change: 0.00287Iteration: 102, Log-Lik: -2467.557, Max-Change: 0.00283Iteration: 103, Log-Lik: -2467.554, Max-Change: 0.00284Iteration: 104, Log-Lik: -2467.552, Max-Change: 0.00284Iteration: 105, Log-Lik: -2467.550, Max-Change: 0.00276Iteration: 106, Log-Lik: -2467.548, Max-Change: 0.00271Iteration: 107, Log-Lik: -2467.546, Max-Change: 0.00278Iteration: 108, Log-Lik: -2467.544, Max-Change: 0.00269Iteration: 109, Log-Lik: -2467.542, Max-Change: 0.00265Iteration: 110, Log-Lik: -2467.540, Max-Change: 0.00272Iteration: 111, Log-Lik: -2467.538, Max-Change: 0.00264Iteration: 112, Log-Lik: -2467.536, Max-Change: 0.00258Iteration: 113, Log-Lik: -2467.534, Max-Change: 0.00264Iteration: 114, Log-Lik: -2467.532, Max-Change: 0.00258Iteration: 115, Log-Lik: -2467.530, Max-Change: 0.00252Iteration: 116, Log-Lik: -2467.528, Max-Change: 0.00257Iteration: 117, Log-Lik: -2467.527, Max-Change: 0.00253Iteration: 118, Log-Lik: -2467.525, Max-Change: 0.00247Iteration: 119, Log-Lik: -2467.523, Max-Change: 0.00249Iteration: 120, Log-Lik: -2467.522, Max-Change: 0.00248Iteration: 121, Log-Lik: -2467.520, Max-Change: 0.00241Iteration: 122, Log-Lik: -2467.518, Max-Change: 0.00241Iteration: 123, Log-Lik: -2467.517, Max-Change: 0.00243Iteration: 124, Log-Lik: -2467.515, Max-Change: 0.00236Iteration: 125, Log-Lik: -2467.513, Max-Change: 0.00234Iteration: 126, Log-Lik: -2467.512, Max-Change: 0.00238Iteration: 127, Log-Lik: -2467.510, Max-Change: 0.00230Iteration: 128, Log-Lik: -2467.509, Max-Change: 0.00226Iteration: 129, Log-Lik: -2467.507, Max-Change: 0.00233Iteration: 130, Log-Lik: -2467.506, Max-Change: 0.00225Iteration: 131, Log-Lik: -2467.504, Max-Change: 0.00219Iteration: 132, Log-Lik: -2467.503, Max-Change: 0.00229Iteration: 133, Log-Lik: -2467.502, Max-Change: 0.00220Iteration: 134, Log-Lik: -2467.500, Max-Change: 0.00212Iteration: 135, Log-Lik: -2467.499, Max-Change: 0.00224Iteration: 136, Log-Lik: -2467.497, Max-Change: 0.00215Iteration: 137, Log-Lik: -2467.496, Max-Change: 0.00206Iteration: 138, Log-Lik: -2467.495, Max-Change: 0.00220Iteration: 139, Log-Lik: -2467.494, Max-Change: 0.00210Iteration: 140, Log-Lik: -2467.492, Max-Change: 0.00187Iteration: 141, Log-Lik: -2467.491, Max-Change: 0.00201Iteration: 142, Log-Lik: -2467.490, Max-Change: 0.00317Iteration: 143, Log-Lik: -2467.488, Max-Change: 0.00198Iteration: 144, Log-Lik: -2467.487, Max-Change: 0.00189Iteration: 145, Log-Lik: -2467.486, Max-Change: 0.00406Iteration: 146, Log-Lik: -2467.483, Max-Change: 0.00201Iteration: 147, Log-Lik: -2467.482, Max-Change: 0.00181Iteration: 148, Log-Lik: -2467.481, Max-Change: 0.00400Iteration: 149, Log-Lik: -2467.478, Max-Change: 0.00197Iteration: 150, Log-Lik: -2467.477, Max-Change: 0.00176Iteration: 151, Log-Lik: -2467.477, Max-Change: 0.00376Iteration: 152, Log-Lik: -2467.474, Max-Change: 0.00187Iteration: 153, Log-Lik: -2467.473, Max-Change: 0.00170Iteration: 154, Log-Lik: -2467.473, Max-Change: 0.00390Iteration: 155, Log-Lik: -2467.470, Max-Change: 0.00187Iteration: 156, Log-Lik: -2467.469, Max-Change: 0.00166Iteration: 157, Log-Lik: -2467.468, Max-Change: 0.00336Iteration: 158, Log-Lik: -2467.466, Max-Change: 0.00170Iteration: 159, Log-Lik: -2467.465, Max-Change: 0.00159Iteration: 160, Log-Lik: -2467.465, Max-Change: 0.00373Iteration: 161, Log-Lik: -2467.463, Max-Change: 0.00177Iteration: 162, Log-Lik: -2467.462, Max-Change: 0.00156Iteration: 163, Log-Lik: -2467.461, Max-Change: 0.00308Iteration: 164, Log-Lik: -2467.459, Max-Change: 0.00157Iteration: 165, Log-Lik: -2467.459, Max-Change: 0.00149Iteration: 166, Log-Lik: -2467.458, Max-Change: 0.00352Iteration: 167, Log-Lik: -2467.456, Max-Change: 0.00166Iteration: 168, Log-Lik: -2467.455, Max-Change: 0.00147Iteration: 169, Log-Lik: -2467.455, Max-Change: 0.00282Iteration: 170, Log-Lik: -2467.453, Max-Change: 0.00154Iteration: 171, Log-Lik: -2467.453, Max-Change: 0.00139Iteration: 172, Log-Lik: -2467.452, Max-Change: 0.00333Iteration: 173, Log-Lik: -2467.450, Max-Change: 0.00155Iteration: 174, Log-Lik: -2467.450, Max-Change: 0.00138Iteration: 175, Log-Lik: -2467.449, Max-Change: 0.00283Iteration: 176, Log-Lik: -2467.448, Max-Change: 0.00161Iteration: 177, Log-Lik: -2467.447, Max-Change: 0.00127Iteration: 178, Log-Lik: -2467.446, Max-Change: 0.00220Iteration: 179, Log-Lik: -2467.446, Max-Change: 0.00138Iteration: 180, Log-Lik: -2467.445, Max-Change: 0.00124Iteration: 181, Log-Lik: -2467.445, Max-Change: 0.00307Iteration: 182, Log-Lik: -2467.443, Max-Change: 0.00142Iteration: 183, Log-Lik: -2467.443, Max-Change: 0.00127Iteration: 184, Log-Lik: -2467.442, Max-Change: 0.00248Iteration: 185, Log-Lik: -2467.441, Max-Change: 0.00144Iteration: 186, Log-Lik: -2467.440, Max-Change: 0.00116Iteration: 187, Log-Lik: -2467.440, Max-Change: 0.00212Iteration: 188, Log-Lik: -2467.439, Max-Change: 0.00132Iteration: 189, Log-Lik: -2467.439, Max-Change: 0.00114Iteration: 190, Log-Lik: -2467.438, Max-Change: 0.00267Iteration: 191, Log-Lik: -2467.437, Max-Change: 0.00125Iteration: 192, Log-Lik: -2467.437, Max-Change: 0.00115Iteration: 193, Log-Lik: -2467.436, Max-Change: 0.00233Iteration: 194, Log-Lik: -2467.435, Max-Change: 0.00126Iteration: 195, Log-Lik: -2467.435, Max-Change: 0.00110Iteration: 196, Log-Lik: -2467.435, Max-Change: 0.00227Iteration: 197, Log-Lik: -2467.434, Max-Change: 0.00123Iteration: 198, Log-Lik: -2467.433, Max-Change: 0.00107Iteration: 199, Log-Lik: -2467.433, Max-Change: 0.00237Iteration: 200, Log-Lik: -2467.432, Max-Change: 0.00133Iteration: 201, Log-Lik: -2467.432, Max-Change: 0.00161Iteration: 202, Log-Lik: -2467.431, Max-Change: 0.00163Iteration: 203, Log-Lik: -2467.431, Max-Change: 0.00107Iteration: 204, Log-Lik: -2467.430, Max-Change: 0.00099Iteration: 205, Log-Lik: -2467.430, Max-Change: 0.00244Iteration: 206, Log-Lik: -2467.429, Max-Change: 0.00111Iteration: 207, Log-Lik: -2467.429, Max-Change: 0.00100Iteration: 208, Log-Lik: -2467.429, Max-Change: 0.00199Iteration: 209, Log-Lik: -2467.428, Max-Change: 0.00090Iteration: 210, Log-Lik: -2467.428, Max-Change: 0.00123Iteration: 211, Log-Lik: -2467.427, Max-Change: 0.00080Iteration: 212, Log-Lik: -2467.427, Max-Change: 0.00094Iteration: 213, Log-Lik: -2467.427, Max-Change: 0.00090Iteration: 214, Log-Lik: -2467.427, Max-Change: 0.00227Iteration: 215, Log-Lik: -2467.426, Max-Change: 0.00102Iteration: 216, Log-Lik: -2467.425, Max-Change: 0.00093Iteration: 217, Log-Lik: -2467.425, Max-Change: 0.00176Iteration: 218, Log-Lik: -2467.425, Max-Change: 0.00081Iteration: 219, Log-Lik: -2467.424, Max-Change: 0.00113Iteration: 220, Log-Lik: -2467.424, Max-Change: 0.00074Iteration: 221, Log-Lik: -2467.424, Max-Change: 0.00086Iteration: 222, Log-Lik: -2467.424, Max-Change: 0.00083Iteration: 223, Log-Lik: -2467.424, Max-Change: 0.00196Iteration: 224, Log-Lik: -2467.423, Max-Change: 0.00105Iteration: 225, Log-Lik: -2467.423, Max-Change: 0.00069Iteration: 226, Log-Lik: -2467.422, Max-Change: 0.00081Iteration: 227, Log-Lik: -2467.422, Max-Change: 0.00106Iteration: 228, Log-Lik: -2467.422, Max-Change: 0.00070Iteration: 229, Log-Lik: -2467.422, Max-Change: 0.00071Iteration: 230, Log-Lik: -2467.421, Max-Change: 0.00103Iteration: 231, Log-Lik: -2467.421, Max-Change: 0.00068Iteration: 232, Log-Lik: -2467.421, Max-Change: 0.00069Iteration: 233, Log-Lik: -2467.421, Max-Change: 0.00100Iteration: 234, Log-Lik: -2467.421, Max-Change: 0.00066Iteration: 235, Log-Lik: -2467.420, Max-Change: 0.00068Iteration: 236, Log-Lik: -2467.420, Max-Change: 0.00098Iteration: 237, Log-Lik: -2467.420, Max-Change: 0.00065Iteration: 238, Log-Lik: -2467.420, Max-Change: 0.00067Iteration: 239, Log-Lik: -2467.420, Max-Change: 0.00096Iteration: 240, Log-Lik: -2467.419, Max-Change: 0.00063Iteration: 241, Log-Lik: -2467.419, Max-Change: 0.00066Iteration: 242, Log-Lik: -2467.419, Max-Change: 0.00094Iteration: 243, Log-Lik: -2467.419, Max-Change: 0.00062Iteration: 244, Log-Lik: -2467.419, Max-Change: 0.00064Iteration: 245, Log-Lik: -2467.418, Max-Change: 0.00092Iteration: 246, Log-Lik: -2467.418, Max-Change: 0.00061Iteration: 247, Log-Lik: -2467.418, Max-Change: 0.00063Iteration: 248, Log-Lik: -2467.418, Max-Change: 0.00090Iteration: 249, Log-Lik: -2467.418, Max-Change: 0.00060Iteration: 250, Log-Lik: -2467.418, Max-Change: 0.00062Iteration: 251, Log-Lik: -2467.417, Max-Change: 0.00088Iteration: 252, Log-Lik: -2467.417, Max-Change: 0.00058Iteration: 253, Log-Lik: -2467.417, Max-Change: 0.00061Iteration: 254, Log-Lik: -2467.417, Max-Change: 0.00086Iteration: 255, Log-Lik: -2467.417, Max-Change: 0.00057Iteration: 256, Log-Lik: -2467.417, Max-Change: 0.00059Iteration: 257, Log-Lik: -2467.417, Max-Change: 0.00085Iteration: 258, Log-Lik: -2467.416, Max-Change: 0.00056Iteration: 259, Log-Lik: -2467.416, Max-Change: 0.00058Iteration: 260, Log-Lik: -2467.416, Max-Change: 0.00083Iteration: 261, Log-Lik: -2467.416, Max-Change: 0.00055Iteration: 262, Log-Lik: -2467.416, Max-Change: 0.00057Iteration: 263, Log-Lik: -2467.416, Max-Change: 0.00081Iteration: 264, Log-Lik: -2467.416, Max-Change: 0.00054Iteration: 265, Log-Lik: -2467.415, Max-Change: 0.00055Iteration: 266, Log-Lik: -2467.415, Max-Change: 0.00079Iteration: 267, Log-Lik: -2467.415, Max-Change: 0.00053Iteration: 268, Log-Lik: -2467.415, Max-Change: 0.00054Iteration: 269, Log-Lik: -2467.415, Max-Change: 0.00078Iteration: 270, Log-Lik: -2467.415, Max-Change: 0.00052Iteration: 271, Log-Lik: -2467.415, Max-Change: 0.00053Iteration: 272, Log-Lik: -2467.414, Max-Change: 0.00076Iteration: 273, Log-Lik: -2467.414, Max-Change: 0.00051Iteration: 274, Log-Lik: -2467.414, Max-Change: 0.00052Iteration: 275, Log-Lik: -2467.414, Max-Change: 0.00075Iteration: 276, Log-Lik: -2467.414, Max-Change: 0.00050Iteration: 277, Log-Lik: -2467.414, Max-Change: 0.00051Iteration: 278, Log-Lik: -2467.414, Max-Change: 0.00073Iteration: 279, Log-Lik: -2467.414, Max-Change: 0.00049Iteration: 280, Log-Lik: -2467.414, Max-Change: 0.00049Iteration: 281, Log-Lik: -2467.413, Max-Change: 0.00072Iteration: 282, Log-Lik: -2467.413, Max-Change: 0.00048Iteration: 283, Log-Lik: -2467.413, Max-Change: 0.00048Iteration: 284, Log-Lik: -2467.413, Max-Change: 0.00070Iteration: 285, Log-Lik: -2467.413, Max-Change: 0.00047Iteration: 286, Log-Lik: -2467.413, Max-Change: 0.00047Iteration: 287, Log-Lik: -2467.413, Max-Change: 0.00069Iteration: 288, Log-Lik: -2467.413, Max-Change: 0.00046Iteration: 289, Log-Lik: -2467.413, Max-Change: 0.00046Iteration: 290, Log-Lik: -2467.413, Max-Change: 0.00067Iteration: 291, Log-Lik: -2467.412, Max-Change: 0.00045Iteration: 292, Log-Lik: -2467.412, Max-Change: 0.00045Iteration: 293, Log-Lik: -2467.412, Max-Change: 0.00066Iteration: 294, Log-Lik: -2467.412, Max-Change: 0.00044Iteration: 295, Log-Lik: -2467.412, Max-Change: 0.00044Iteration: 296, Log-Lik: -2467.412, Max-Change: 0.00064Iteration: 297, Log-Lik: -2467.412, Max-Change: 0.00043Iteration: 298, Log-Lik: -2467.412, Max-Change: 0.00043Iteration: 299, Log-Lik: -2467.412, Max-Change: 0.00063Iteration: 300, Log-Lik: -2467.412, Max-Change: 0.00042Iteration: 301, Log-Lik: -2467.412, Max-Change: 0.00042Iteration: 302, Log-Lik: -2467.412, Max-Change: 0.00062Iteration: 303, Log-Lik: -2467.411, Max-Change: 0.00041Iteration: 304, Log-Lik: -2467.411, Max-Change: 0.00041Iteration: 305, Log-Lik: -2467.411, Max-Change: 0.00061Iteration: 306, Log-Lik: -2467.411, Max-Change: 0.00040Iteration: 307, Log-Lik: -2467.411, Max-Change: 0.00040Iteration: 308, Log-Lik: -2467.411, Max-Change: 0.00059Iteration: 309, Log-Lik: -2467.411, Max-Change: 0.00040Iteration: 310, Log-Lik: -2467.411, Max-Change: 0.00040Iteration: 311, Log-Lik: -2467.411, Max-Change: 0.00058Iteration: 312, Log-Lik: -2467.411, Max-Change: 0.00039Iteration: 313, Log-Lik: -2467.411, Max-Change: 0.00039Iteration: 314, Log-Lik: -2467.411, Max-Change: 0.00057Iteration: 315, Log-Lik: -2467.411, Max-Change: 0.00038Iteration: 316, Log-Lik: -2467.410, Max-Change: 0.00038Iteration: 317, Log-Lik: -2467.410, Max-Change: 0.00056Iteration: 318, Log-Lik: -2467.410, Max-Change: 0.00037Iteration: 319, Log-Lik: -2467.410, Max-Change: 0.00037Iteration: 320, Log-Lik: -2467.410, Max-Change: 0.00055Iteration: 321, Log-Lik: -2467.410, Max-Change: 0.00037Iteration: 322, Log-Lik: -2467.410, Max-Change: 0.00036Iteration: 323, Log-Lik: -2467.410, Max-Change: 0.00054Iteration: 324, Log-Lik: -2467.410, Max-Change: 0.00036Iteration: 325, Log-Lik: -2467.410, Max-Change: 0.00036Iteration: 326, Log-Lik: -2467.410, Max-Change: 0.00052Iteration: 327, Log-Lik: -2467.410, Max-Change: 0.00035Iteration: 328, Log-Lik: -2467.410, Max-Change: 0.00035Iteration: 329, Log-Lik: -2467.410, Max-Change: 0.00051Iteration: 330, Log-Lik: -2467.410, Max-Change: 0.00034Iteration: 331, Log-Lik: -2467.410, Max-Change: 0.00034Iteration: 332, Log-Lik: -2467.410, Max-Change: 0.00050Iteration: 333, Log-Lik: -2467.409, Max-Change: 0.00034Iteration: 334, Log-Lik: -2467.409, Max-Change: 0.00034Iteration: 335, Log-Lik: -2467.409, Max-Change: 0.00049Iteration: 336, Log-Lik: -2467.409, Max-Change: 0.00033Iteration: 337, Log-Lik: -2467.409, Max-Change: 0.00033Iteration: 338, Log-Lik: -2467.409, Max-Change: 0.00048Iteration: 339, Log-Lik: -2467.409, Max-Change: 0.00032Iteration: 340, Log-Lik: -2467.409, Max-Change: 0.00032Iteration: 341, Log-Lik: -2467.409, Max-Change: 0.00047Iteration: 342, Log-Lik: -2467.409, Max-Change: 0.00032Iteration: 343, Log-Lik: -2467.409, Max-Change: 0.00032Iteration: 344, Log-Lik: -2467.409, Max-Change: 0.00046Iteration: 345, Log-Lik: -2467.409, Max-Change: 0.00031Iteration: 346, Log-Lik: -2467.409, Max-Change: 0.00031Iteration: 347, Log-Lik: -2467.409, Max-Change: 0.00045Iteration: 348, Log-Lik: -2467.409, Max-Change: 0.00031Iteration: 349, Log-Lik: -2467.409, Max-Change: 0.00030Iteration: 350, Log-Lik: -2467.409, Max-Change: 0.00045Iteration: 351, Log-Lik: -2467.409, Max-Change: 0.00030Iteration: 352, Log-Lik: -2467.409, Max-Change: 0.00030Iteration: 353, Log-Lik: -2467.409, Max-Change: 0.00044Iteration: 354, Log-Lik: -2467.409, Max-Change: 0.00029Iteration: 355, Log-Lik: -2467.408, Max-Change: 0.00029Iteration: 356, Log-Lik: -2467.408, Max-Change: 0.00043Iteration: 357, Log-Lik: -2467.408, Max-Change: 0.00029Iteration: 358, Log-Lik: -2467.408, Max-Change: 0.00029Iteration: 359, Log-Lik: -2467.408, Max-Change: 0.00042Iteration: 360, Log-Lik: -2467.408, Max-Change: 0.00028Iteration: 361, Log-Lik: -2467.408, Max-Change: 0.00028Iteration: 362, Log-Lik: -2467.408, Max-Change: 0.00041Iteration: 363, Log-Lik: -2467.408, Max-Change: 0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mdirt(data = dat, model = 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Latent class model with 2 classes and 2 profiles.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Converged within 1e-04 tolerance after 363 EM iterations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mirt version: 1.42.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M-step optimizer: nlminb </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM acceleration: Ramsay</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Latent density type: discrete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood = -2467.408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated parameters: 11 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC = 4956.816</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC = 5010.802; SABIC = 4975.865</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G2 (20) = 22.74, p = 0.3018, RMSEA = 0.012</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">mdirt</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">mod2</span>, type <span class="op">=</span> <span class="st">'exp'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod2</span>, <span class="va">mod3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="M2.html">M2</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="itemfit.html">itemfit</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generate classification plots</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod2</span>, facet_items <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod2</span>, profile <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># available for polytomous data</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">mdirt</span><span class="op">(</span><span class="va">Science</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, profile<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># classification based on response patterns</span></span></span>
<span class="r-in"><span><span class="fu"><a href="fscores.html">fscores</a></span><span class="op">(</span><span class="va">mod2</span>, full.scores <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># classify individuals either with the largest posterior probability.....</span></span></span>
<span class="r-in"><span><span class="va">fs</span> <span class="op">&lt;-</span> <span class="fu"><a href="fscores.html">fscores</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">classes</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">class_max</span> <span class="op">&lt;-</span> <span class="va">classes</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">fs</span>, <span class="fl">1</span>, <span class="va">max</span><span class="op">)</span> <span class="op">==</span> <span class="va">fs</span>, <span class="fl">1</span>, <span class="va">which</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">class_max</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ... or by probability sampling (i.e., plausible value draws)</span></span></span>
<span class="r-in"><span><span class="va">class_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">fs</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span>, prob<span class="op">=</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">class_prob</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plausible value imputations for stochastic classification in both classes</span></span></span>
<span class="r-in"><span><span class="va">pvs</span> <span class="op">&lt;-</span> <span class="fu"><a href="fscores.html">fscores</a></span><span class="op">(</span><span class="va">mod2</span>, plausible.draws<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tabs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">pvs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span>, <span class="va">table</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tabs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit with random starting points (run in parallel to save time)</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="mirtCluster.html">mirtCluster</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">mdirt</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, nruns<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#--------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Grade of measurement model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define a custom Theta grid for including a 'fuzzy' class membership</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">3</span> , ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">mod_gom</span> <span class="op">&lt;-</span> <span class="fu">mdirt</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">2</span>, customTheta <span class="op">=</span> <span class="va">Theta</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod_gom</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-----------------</span></span></span>
<span class="r-in"><span><span class="co"># Multidimensional discrete latent class model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="key2binary.html">key2binary</a></span><span class="op">(</span><span class="va">SAT12</span>,</span></span>
<span class="r-in"><span>     key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define Theta grid for three latent classes</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="thetaComb.html">thetaComb</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">mod_discrete</span> <span class="op">&lt;-</span> <span class="fu">mdirt</span><span class="op">(</span><span class="va">dat</span>, <span class="fl">3</span>, customTheta <span class="op">=</span> <span class="va">Theta</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod_discrete</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Located latent class model</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.model.html">mirt.model</a></span><span class="op">(</span><span class="st">'C1 = 1-32</span></span></span>
<span class="r-in"><span><span class="st">                     C2 = 1-32</span></span></span>
<span class="r-in"><span><span class="st">                     C3 = 1-32</span></span></span>
<span class="r-in"><span><span class="st">                     CONSTRAIN = (1-32, a1), (1-32, a2), (1-32, a3)'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">mod_located</span> <span class="op">&lt;-</span> <span class="fu">mdirt</span><span class="op">(</span><span class="va">dat</span>, <span class="va">model</span>, customTheta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod_located</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-----------------</span></span></span>
<span class="r-in"><span><span class="co">### DINA model example</span></span></span>
<span class="r-in"><span><span class="co"># generate some suitable data for a two dimensional DINA application</span></span></span>
<span class="r-in"><span><span class="co">#     (first columns are intercepts)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="expand.table.html">expand.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span>                               <span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span>                               <span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span>                               <span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fl">4</span>, <span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      freq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">200</span>,<span class="fl">100</span>,<span class="fl">500</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">15</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="fl">.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span><span class="op">)</span>, <span class="fl">15</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">guess</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># population guess</span></span></span>
<span class="r-in"><span><span class="va">slip</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="co"># population slip</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>, Theta<span class="op">=</span><span class="va">Theta</span>, itemtype <span class="op">=</span> <span class="st">'lca'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># first column is the intercept, 2nd and 3rd are attributes</span></span></span>
<span class="r-in"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="thetaComb.html">thetaComb</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">theta</span>, <span class="va">theta</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">theta</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="co">#DINA interaction of main attributes</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.model.html">mirt.model</a></span><span class="op">(</span><span class="st">'Intercept = 1-15</span></span></span>
<span class="r-in"><span><span class="st">                     A1 = 1-5</span></span></span>
<span class="r-in"><span><span class="st">                     A2 = 6-10</span></span></span>
<span class="r-in"><span><span class="st">                     A1A2 = 11-15'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># last 5 items are DINA (first 10 are unidimensional C-RUMs)</span></span></span>
<span class="r-in"><span><span class="va">DINA</span> <span class="op">&lt;-</span> <span class="fu">mdirt</span><span class="op">(</span><span class="va">dat</span>, <span class="va">model</span>, customTheta <span class="op">=</span> <span class="va">theta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">DINA</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">DINA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="M2.html">M2</a></span><span class="op">(</span><span class="va">DINA</span><span class="op">)</span> <span class="co"># fits well (as it should)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">DINA</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">items</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">guess</span>, estguess <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">cfs</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">slip</span>, estslip <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">cfs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### DINO model example</span></span></span>
<span class="r-in"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="thetaComb.html">thetaComb</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># define theta matrix with negative interaction term</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">theta</span>, <span class="op">-</span><span class="va">theta</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">theta</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.model.html">mirt.model</a></span><span class="op">(</span><span class="st">'Intercept = 1-15</span></span></span>
<span class="r-in"><span><span class="st">                     A1 = 1-5, 11-15</span></span></span>
<span class="r-in"><span><span class="st">                     A2 = 6-15</span></span></span>
<span class="r-in"><span><span class="st">                     Yoshi = 11-15</span></span></span>
<span class="r-in"><span><span class="st">                     CONSTRAIN = (11,a2,a3,a4), (12,a2,a3,a4), (13,a2,a3,a4),</span></span></span>
<span class="r-in"><span><span class="st">                                 (14,a2,a3,a4), (15,a2,a3,a4)'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># last five items are DINOs (first 10 are unidimensional C-RUMs)</span></span></span>
<span class="r-in"><span><span class="va">DINO</span> <span class="op">&lt;-</span> <span class="fu">mdirt</span><span class="op">(</span><span class="va">dat</span>, <span class="va">model</span>, customTheta <span class="op">=</span> <span class="va">theta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">DINO</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">DINO</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="M2.html">M2</a></span><span class="op">(</span><span class="va">DINO</span><span class="op">)</span> <span class="co">#doesn't fit as well, because not the generating model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## C-RUM (analogous to MIRT model)</span></span></span>
<span class="r-in"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="thetaComb.html">thetaComb</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.model.html">mirt.model</a></span><span class="op">(</span><span class="st">'Intercept = 1-15</span></span></span>
<span class="r-in"><span><span class="st">                     A1 = 1-5, 11-15</span></span></span>
<span class="r-in"><span><span class="st">                     A2 = 6-15'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">CRUM</span> <span class="op">&lt;-</span> <span class="fu">mdirt</span><span class="op">(</span><span class="va">dat</span>, <span class="va">model</span>, customTheta <span class="op">=</span> <span class="va">theta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">CRUM</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">CRUM</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># good fit, but over-saturated (main effects for items 11-15 can be set to 0)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="M2.html">M2</a></span><span class="op">(</span><span class="va">CRUM</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#------------------</span></span></span>
<span class="r-in"><span><span class="co"># multidimensional latent class model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="key2binary.html">key2binary</a></span><span class="op">(</span><span class="va">SAT12</span>,</span></span>
<span class="r-in"><span>     key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 5 latent classes within 2 different sets of items</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.model.html">mirt.model</a></span><span class="op">(</span><span class="st">'C1 = 1-16</span></span></span>
<span class="r-in"><span><span class="st">                     C2 = 1-16</span></span></span>
<span class="r-in"><span><span class="st">                     C3 = 1-16</span></span></span>
<span class="r-in"><span><span class="st">                     C4 = 1-16</span></span></span>
<span class="r-in"><span><span class="st">                     C5 = 1-16</span></span></span>
<span class="r-in"><span><span class="st">                     C6 = 17-32</span></span></span>
<span class="r-in"><span><span class="st">                     C7 = 17-32</span></span></span>
<span class="r-in"><span><span class="st">                     C8 = 17-32</span></span></span>
<span class="r-in"><span><span class="st">                     C9 = 17-32</span></span></span>
<span class="r-in"><span><span class="st">                     C10 = 17-32</span></span></span>
<span class="r-in"><span><span class="st">                     CONSTRAIN = (1-16, a1), (1-16, a2), (1-16, a3), (1-16, a4), (1-16, a5),</span></span></span>
<span class="r-in"><span><span class="st">                       (17-32, a6), (17-32, a7), (17-32, a8), (17-32, a9), (17-32, a10)'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="co"># defined explicitly. Otherwise, this profile is assumed</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">mdirt</span><span class="op">(</span><span class="va">dat</span>, <span class="va">model</span>, customTheta <span class="op">=</span> <span class="va">theta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#------------------</span></span></span>
<span class="r-in"><span><span class="co"># multiple group with constrained group probabilities</span></span></span>
<span class="r-in"><span> <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="key2binary.html">key2binary</a></span><span class="op">(</span><span class="va">SAT12</span>,</span></span>
<span class="r-in"><span>   key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'G1'</span>, <span class="st">'G2'</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">SAT12</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the latent class parameters are technically located in the (nitems + 1) location</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.model.html">mirt.model</a></span><span class="op">(</span><span class="st">'A1 = 1-32</span></span></span>
<span class="r-in"><span><span class="st">                     A2 = 1-32</span></span></span>
<span class="r-in"><span><span class="st">                     CONSTRAINB = (33, c1)'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">mdirt</span><span class="op">(</span><span class="va">dat</span>, <span class="va">model</span>, group <span class="op">=</span> <span class="va">group</span>, customTheta <span class="op">=</span> <span class="va">Theta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#------------------</span></span></span>
<span class="r-in"><span><span class="co"># Probabilistic Guttman Model (Proctor, 1970)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example analysis can also be found in the sirt package (see ?prob.guttman)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data.read</span>, package <span class="op">=</span> <span class="st">'sirt'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data.read</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span>                  <span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span>                  <span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span>                  <span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.model.html">mirt.model</a></span><span class="op">(</span><span class="st">"INTERCEPT = 1-12</span></span></span>
<span class="r-in"><span><span class="st">                     C1 = 1,7,9,11</span></span></span>
<span class="r-in"><span><span class="st">                     C2 = 2,5,8,10,12</span></span></span>
<span class="r-in"><span><span class="st">                     C3 = 3,4,6"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">mdirt</span><span class="op">(</span><span class="va">data.read</span>, <span class="va">model</span>, customTheta<span class="op">=</span><span class="va">Theta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="M2.html">M2</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="itemfit.html">itemfit</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

