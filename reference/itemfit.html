<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Item fit statistics — itemfit • mirt</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Item fit statistics — itemfit"><meta name="description" content="Computes item-fit statistics for a variety of unidimensional and multidimensional models.
Poorly fitting items should be inspected with the empirical plots/tables
for unidimensional models, otherwise itemGAM can be used to diagnose
where the functional form of the IRT model was misspecified, or models can be refit using
more flexible semi-parametric response models (e.g., itemtype = 'spline').
If the latent trait density was approximated (e.g., Davidian curves, Empirical histograms, etc)
then passing use_dentype_estimate = TRUE will use the internally saved quadrature and
density components (where applicable). Currently, only S-X2 statistic supported for
mixture IRT models. Finally, where applicable the root mean-square error of approximation (RMSEA)
is reported to help gauge the magnitude of item misfit."><meta property="og:description" content="Computes item-fit statistics for a variety of unidimensional and multidimensional models.
Poorly fitting items should be inspected with the empirical plots/tables
for unidimensional models, otherwise itemGAM can be used to diagnose
where the functional form of the IRT model was misspecified, or models can be refit using
more flexible semi-parametric response models (e.g., itemtype = 'spline').
If the latent trait density was approximated (e.g., Davidian curves, Empirical histograms, etc)
then passing use_dentype_estimate = TRUE will use the internally saved quadrature and
density components (where applicable). Currently, only S-X2 statistic supported for
mixture IRT models. Finally, where applicable the root mean-square error of approximation (RMSEA)
is reported to help gauge the magnitude of item misfit."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mirt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.45.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/mirt-vignettes.html">UNKNOWN TITLE</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/philchalmers/mirt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Item fit statistics</h1>
      <small class="dont-index">Source: <a href="https://github.com/philchalmers/mirt/blob/main/R/itemfit.R" class="external-link"><code>R/itemfit.R</code></a></small>
      <div class="d-none name"><code>itemfit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes item-fit statistics for a variety of unidimensional and multidimensional models.
Poorly fitting items should be inspected with the empirical plots/tables
for unidimensional models, otherwise <code><a href="itemGAM.html">itemGAM</a></code> can be used to diagnose
where the functional form of the IRT model was misspecified, or models can be refit using
more flexible semi-parametric response models (e.g., <code>itemtype = 'spline'</code>).
If the latent trait density was approximated (e.g., Davidian curves, Empirical histograms, etc)
then passing <code>use_dentype_estimate = TRUE</code> will use the internally saved quadrature and
density components (where applicable). Currently, only S-X2 statistic supported for
mixture IRT models. Finally, where applicable the root mean-square error of approximation (RMSEA)
is reported to help gauge the magnitude of item misfit.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">itemfit</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  fit_stats <span class="op">=</span> <span class="st">"S_X2"</span>,</span>
<span>  which.items <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="extract.mirt.html">extract.mirt</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"nitems"</span><span class="op">)</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  p.adjust <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  group.bins <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  group.size <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  group.fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>  mincell <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mincell.X2 <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  return.tables <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pv_draws <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  boot <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  boot_dfapprox <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  S_X2.plot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  S_X2.plot_raw.score <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ETrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  ETpoints <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  empirical.plot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  empirical.CI <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  empirical.poly.collapse <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"EAP"</span>,</span>
<span>  Theta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  par.strip.text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span>,</span>
<span>  par.settings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>strip.background <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"#9ECAE1"</span><span class="op">)</span>, strip.border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span></span>
<span>    <span class="st">"black"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>space <span class="op">=</span> <span class="st">"right"</span>, points <span class="op">=</span> <span class="cn">FALSE</span>, lines <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a computed model object of class <code>SingleGroupClass</code>,
<code>MultipleGroupClass</code>, or <code>DiscreteClass</code></p></dd>


<dt id="arg-fit-stats">fit_stats<a class="anchor" aria-label="anchor" href="#arg-fit-stats"></a></dt>
<dd><p>a character vector indicating which fit statistics should be computed.
  Supported inputs are:</p>
<ul><li><p><code>'S_X2'</code> : Orlando and Thissen (2000, 2003) and
    Kang and Chen's (2007) signed chi-squared test (default)</p></li>
<li><p><code>'Zh'</code> : Drasgow, Levine, &amp; Williams (1985) Zh</p></li>
<li><p><code>'X2'</code> : Bock's (1972) chi-squared method.
    The default inputs compute Yen's (1981) Q1 variant of the X2 statistic
    (i.e., uses a fixed <code>group.bins = 10</code>). However, Bock's group-size variable
    median-based method can be computed by passing <code>group.fun = median</code> and
    modifying the <code>group.size</code> input to the desired number of bins</p></li>
<li><p><code>'G2'</code> : McKinley &amp; Mills (1985) G2 statistic (similar method to Q1,
    but with the likelihood-ratio test).</p></li>
<li><p><code>'PV_Q1'</code> : Chalmers and Ng's (2017) plausible-value variant
    of the Q1 statistic.</p></li>
<li><p><code>'PV_Q1*'</code> : Chalmers and Ng's (2017) plausible-value variant
    of the Q1 statistic that uses parametric bootstrapping to obtain a suitable empirical
    distribution.</p></li>
<li><p><code>'X2*'</code> : Stone's (2000) fit statistics that require parametric
    bootstrapping</p></li>
<li><p><code>'X2*_df'</code> : Stone's (2000) fit statistics that require parametric
    bootstrapping to obtain scaled versions of the X2* and degrees of freedom</p></li>
<li><p><code>'infit'</code> : Compute the infit and outfit statistics</p></li>
</ul><p>Note that 'S_X2' and 'Zh' cannot be computed when there are missing response data
(i.e., will require multiple-imputation/row-removal techniques).</p></dd>


<dt id="arg-which-items">which.items<a class="anchor" aria-label="anchor" href="#arg-which-items"></a></dt>
<dd><p>an integer vector indicating which items to test for fit.
Default tests all possible items</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>logical; remove rows with any missing values? This is required for methods such
as S-X2 because they require the "EAPsum" method from <code><a href="fscores.html">fscores</a></code></p></dd>


<dt id="arg-p-adjust">p.adjust<a class="anchor" aria-label="anchor" href="#arg-p-adjust"></a></dt>
<dd><p>method to use for adjusting all p-values for each respective item fit
statistic (see <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></code> for available options). Default is <code>'none'</code></p></dd>


<dt id="arg-group-bins">group.bins<a class="anchor" aria-label="anchor" href="#arg-group-bins"></a></dt>
<dd><p>the number of bins to use for X2 and G2. For example,
setting <code>group.bins = 10</code> will will compute Yen's (1981) Q1 statistic when <code>'X2'</code> is
requested</p></dd>


<dt id="arg-group-size">group.size<a class="anchor" aria-label="anchor" href="#arg-group-size"></a></dt>
<dd><p>approximate size of each group to be used in calculating the \(\chi^2\)
statistic. The default <code>NA</code>
disables this command and instead uses the <code>group.bins</code> input to try and construct
equally sized bins</p></dd>


<dt id="arg-group-fun">group.fun<a class="anchor" aria-label="anchor" href="#arg-group-fun"></a></dt>
<dd><p>function used when <code>'X2'</code> or <code>'G2'</code> are computed. Determines the central
tendency measure within each partitioned group. E.g., setting <code>group.fun = median</code> will
obtain the median of each respective ability estimate in each subgroup (this is what was used
by Bock, 1972)</p></dd>


<dt id="arg-mincell">mincell<a class="anchor" aria-label="anchor" href="#arg-mincell"></a></dt>
<dd><p>the minimum expected cell size to be used in the S-X2 computations. Tables will be
collapsed across items first if polytomous, and then across scores if necessary</p></dd>


<dt id="arg-mincell-x-">mincell.X2<a class="anchor" aria-label="anchor" href="#arg-mincell-x-"></a></dt>
<dd><p>the minimum expected cell size to be used in the X2 computations. Tables will be
collapsed if polytomous, however if this condition can not be met then the group block will
be omitted in the computations</p></dd>


<dt id="arg-return-tables">return.tables<a class="anchor" aria-label="anchor" href="#arg-return-tables"></a></dt>
<dd><p>logical; return tables when investigating <code>'X2'</code>, <code>'S_X2'</code>,
and <code>'X2*'</code>?</p></dd>


<dt id="arg-pv-draws">pv_draws<a class="anchor" aria-label="anchor" href="#arg-pv-draws"></a></dt>
<dd><p>number of plausible-value draws to obtain for PV_Q1 and PV_Q1*</p></dd>


<dt id="arg-boot">boot<a class="anchor" aria-label="anchor" href="#arg-boot"></a></dt>
<dd><p>number of parametric bootstrap samples to create for PV_Q1* and X2*</p></dd>


<dt id="arg-boot-dfapprox">boot_dfapprox<a class="anchor" aria-label="anchor" href="#arg-boot-dfapprox"></a></dt>
<dd><p>number of parametric bootstrap samples to create for the X2*_df statistic
to approximate the scaling factor for X2* as well as the scaled degrees of freedom estimates</p></dd>


<dt id="arg-s-x-plot">S_X2.plot<a class="anchor" aria-label="anchor" href="#arg-s-x-plot"></a></dt>
<dd><p>argument input is the same as <code>empirical.plot</code>, however the resulting image
is constructed according to the S-X2 statistic's conditional sum-score information</p></dd>


<dt id="arg-s-x-plot-raw-score">S_X2.plot_raw.score<a class="anchor" aria-label="anchor" href="#arg-s-x-plot-raw-score"></a></dt>
<dd><p>logical; use the raw-score information in the plot in stead of the latent
trait scale score? Default is <code>FALSE</code></p></dd>


<dt id="arg-etrange">ETrange<a class="anchor" aria-label="anchor" href="#arg-etrange"></a></dt>
<dd><p>range of integration nodes for Stone's X2* statistic</p></dd>


<dt id="arg-etpoints">ETpoints<a class="anchor" aria-label="anchor" href="#arg-etpoints"></a></dt>
<dd><p>number of integration nodes to use for Stone's X2* statistic</p></dd>


<dt id="arg-empirical-plot">empirical.plot<a class="anchor" aria-label="anchor" href="#arg-empirical-plot"></a></dt>
<dd><p>a single numeric value or character of the item name indicating which
item to plot (via <code>itemplot</code>) and overlay with the empirical \(\theta\) groupings (see
<code>empirical.CI</code>). Useful for plotting the expected bins based on the <code>'X2'</code> or
<code>'G2'</code> method</p></dd>


<dt id="arg-empirical-ci">empirical.CI<a class="anchor" aria-label="anchor" href="#arg-empirical-ci"></a></dt>
<dd><p>a numeric value indicating the width of the empirical confidence interval
ranging between 0 and 1 (default of 0 plots not interval). For example, a 95<!-- % confidence -->
interval would be plotted when <code>empirical.CI = .95</code>. Only applicable to dichotomous items</p></dd>


<dt id="arg-empirical-poly-collapse">empirical.poly.collapse<a class="anchor" aria-label="anchor" href="#arg-empirical-poly-collapse"></a></dt>
<dd><p>logical; collapse polytomous item categories to for expected scoring
functions for empirical plots? Default is <code>FALSE</code></p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>type of factor score estimation method. See <code><a href="fscores.html">fscores</a></code> for more detail</p></dd>


<dt id="arg-theta">Theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>a matrix of factor scores for each person used for statistics that require
empirical estimates. If supplied, arguments typically passed to <code><a href="fscores.html">fscores()</a></code> will be
ignored and these values will be used instead. Also required when estimating statistics
with missing data via imputation</p></dd>


<dt id="arg-par-strip-text">par.strip.text<a class="anchor" aria-label="anchor" href="#arg-par-strip-text"></a></dt>
<dd><p>plotting argument passed to <code><a href="https://rdrr.io/pkg/lattice/man/Lattice.html" class="external-link">lattice</a></code></p></dd>


<dt id="arg-par-settings">par.settings<a class="anchor" aria-label="anchor" href="#arg-par-settings"></a></dt>
<dd><p>plotting argument passed to <code><a href="https://rdrr.io/pkg/lattice/man/Lattice.html" class="external-link">lattice</a></code></p></dd>


<dt id="arg-auto-key">auto.key<a class="anchor" aria-label="anchor" href="#arg-auto-key"></a></dt>
<dd><p>plotting argument passed to <code><a href="https://rdrr.io/pkg/lattice/man/Lattice.html" class="external-link">lattice</a></code></p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments to be passed to <code><a href="fscores.html">fscores()</a></code> and <code><a href="https://rdrr.io/pkg/lattice/man/Lattice.html" class="external-link">lattice</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bock, R. D. (1972). Estimating item parameters and latent ability when responses are scored
in two or more nominal categories. <em>Psychometrika, 37</em>, 29-51.</p>
<p>Chalmers, R., P. (2012). mirt: A Multidimensional Item Response Theory
Package for the R Environment. <em>Journal of Statistical Software, 48</em>(6), 1-29.
<a href="https://doi.org/10.18637/jss.v048.i06" class="external-link">doi:10.18637/jss.v048.i06</a></p>
<p>Chalmers, R. P. &amp; Ng, V. (2017). Plausible-Value Imputation Statistics for Detecting
Item Misfit. <em>Applied Psychological Measurement, 41</em>, 372-387.
<a href="https://doi.org/10.1177/0146621617692079" class="external-link">doi:10.1177/0146621617692079</a></p>
<p>Drasgow, F., Levine, M. V., &amp; Williams, E. A. (1985). Appropriateness measurement with
polychotomous item response models and standardized indices.
<em>British Journal of Mathematical and Statistical Psychology, 38</em>, 67-86.</p>
<p>Kang, T. &amp; Chen, Troy, T. (2007). An investigation of the performance of the generalized
S-X2 item-fit index for polytomous IRT models. ACT</p>
<p>McKinley, R., &amp; Mills, C. (1985). A comparison of several goodness-of-fit statistics.
Applied Psychological Measurement, 9, 49-57.</p>
<p>Orlando, M. &amp; Thissen, D. (2000). Likelihood-based item fit indices for dichotomous item
response theory models. <em>Applied Psychological Measurement, 24</em>, 50-64.</p>
<p>Reise, S. P. (1990). A comparison of item- and person-fit methods of assessing model-data fit
in IRT. <em>Applied Psychological Measurement, 14</em>, 127-137.</p>
<p>Stone, C. A. (2000). Monte Carlo Based Null Distribution for an Alternative Goodness-of-Fit
Test Statistics in IRT Models. <em>Journal of Educational Measurement, 37</em>, 58-75.</p>
<p>Wright B. D. &amp; Masters, G. N. (1982). <em>Rating scale analysis</em>. MESA Press.</p>
<p>Yen, W. M. (1981). Using simulation results to choose a latent trait model.
<em>Applied Psychological Measurement, 5</em>, 245-262.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="personfit.html">personfit</a></code>, <code><a href="itemGAM.html">itemGAM</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Theta</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">Theta</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="fl">1.2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">Theta</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="fl">1.2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#make some data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">20</span>, meanlog<span class="op">=</span><span class="fl">0</span>, sdlog <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>, <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu">P</span><span class="op">(</span><span class="va">Theta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">baditem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2000</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">baditem</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">ps</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">ps</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">d</span>, <span class="fl">2000</span>, <span class="va">items</span>, Theta<span class="op">=</span><span class="va">Theta</span><span class="op">)</span>, baditem<span class="op">=</span><span class="va">baditem</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">data</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">raschfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">data</span>, <span class="fl">1</span>, itemtype<span class="op">=</span><span class="st">'Rasch'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item    S_X2 df.S_X2 RMSEA.S_X2 p.S_X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1  16.519      15      0.007  0.348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2  11.718      15      0.000  0.700</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3  22.835      15      0.016  0.088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4  11.703      16      0.000  0.764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5  15.241      15      0.003  0.434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6  11.983      16      0.000  0.745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7  23.912      16      0.016  0.091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8  12.744      15      0.000  0.622</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9  16.931      15      0.008  0.323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10   9.199      16      0.000  0.905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Item_11  17.630      15      0.009  0.283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Item_12  12.198      15      0.000  0.664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Item_13  17.487      15      0.009  0.291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Item_14  19.117      15      0.012  0.208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 Item_15  11.542      16      0.000  0.775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Item_16  12.534      16      0.000  0.706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 Item_17  29.453      15      0.022  0.014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Item_18  15.064      16      0.000  0.520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Item_19  17.125      15      0.008  0.311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Item_20  10.064      15      0.000  0.816</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 baditem 233.224      18      0.077  0.000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># p-value adjustment</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, p.adjust<span class="op">=</span><span class="st">'fdr'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item    S_X2 df.S_X2 RMSEA.S_X2 p.S_X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1  16.519      15      0.007  0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2  11.718      15      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3  22.835      15      0.016  0.480</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4  11.703      16      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5  15.241      15      0.003  0.829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6  11.983      16      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7  23.912      16      0.016  0.480</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8  12.744      15      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9  16.931      15      0.008  0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10   9.199      16      0.000  0.905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Item_11  17.630      15      0.009  0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Item_12  12.198      15      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Item_13  17.487      15      0.009  0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Item_14  19.117      15      0.012  0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 Item_15  11.542      16      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Item_16  12.534      16      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 Item_17  29.453      15      0.022  0.148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Item_18  15.064      16      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Item_19  17.125      15      0.008  0.732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Item_20  10.064      15      0.000  0.856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 baditem 233.224      18      0.077  0.000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># two different fit stats (with/without p-value adjustment)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'S_X2'</span> ,<span class="st">'X2'</span><span class="op">)</span>, p.adjust<span class="op">=</span><span class="st">'fdr'</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in xtfrm.data.frame(x):</span> cannot xtfrm data frames</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'S_X2'</span> ,<span class="st">'X2'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in xtfrm.data.frame(x):</span> cannot xtfrm data frames</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Conditional sum-score plot from S-X2 information</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, S_X2.plot <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># good fit</span></span></span>
<span class="r-plt img"><img src="itemfit-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, S_X2.plot <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># good fit</span></span></span>
<span class="r-plt img"><img src="itemfit-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, S_X2.plot <span class="op">=</span> <span class="fl">21</span><span class="op">)</span> <span class="co"># bad fit</span></span></span>
<span class="r-plt img"><img src="itemfit-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, <span class="st">'X2'</span><span class="op">)</span> <span class="co"># just X2</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in xtfrm.data.frame(x):</span> cannot xtfrm data frames</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, <span class="st">'X2'</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span> <span class="co"># X2 with maximum-likelihood estimates for traits</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The following factor score estimates failed to converge successfully:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>     311,315,352,518,677,748,909,927,1081,1243,1277,1305,1415,1480,1620,1893</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in xtfrm.data.frame(x):</span> cannot xtfrm data frames</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, group.bins<span class="op">=</span><span class="fl">15</span>, empirical.plot <span class="op">=</span> <span class="fl">1</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span> <span class="co">#empirical item plot with 15 points</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The following factor score estimates failed to converge successfully:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>     311,315,352,518,677,748,909,927,1081,1243,1277,1305,1415,1480,1620,1893</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in xtfrm.data.frame(x):</span> cannot xtfrm data frames</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, group.bins<span class="op">=</span><span class="fl">15</span>, empirical.plot <span class="op">=</span> <span class="fl">21</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The following factor score estimates failed to converge successfully:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>     311,315,352,518,677,748,909,927,1081,1243,1277,1305,1415,1480,1620,1893</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in xtfrm.data.frame(x):</span> cannot xtfrm data frames</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># PV and X2* statistics (parametric bootstrap stats not run to save time)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, <span class="st">'PV_Q1'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item   PV_Q1 df.PV_Q1 RMSEA.PV_Q1 p.PV_Q1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1   8.984        8       0.008   0.344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2   9.441        8       0.009   0.306</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3   7.162        8       0.000   0.519</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4   8.463        8       0.005   0.390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5   8.755        8       0.007   0.363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6   9.411        8       0.009   0.309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7   8.678        8       0.007   0.370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8   8.269        8       0.004   0.408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9   9.005        8       0.008   0.342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10   6.873        8       0.000   0.550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Item_11   9.871        8       0.011   0.274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Item_12   9.214        8       0.009   0.325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Item_13   8.889        8       0.007   0.352</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Item_14   9.088        8       0.008   0.335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 Item_15   8.583        8       0.006   0.379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Item_16   8.848        8       0.007   0.355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 Item_17   8.408        8       0.005   0.395</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Item_18   8.000        8       0.000   0.433</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Item_19   8.742        8       0.007   0.365</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Item_20   7.823        8       0.000   0.451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 baditem 118.597        8       0.083   0.000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="mirtCluster.html">mirtCluster</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># improve speed of bootstrap samples by running in parallel</span></span></span>
<span class="r-in"><span><span class="co"># itemfit(x, 'PV_Q1*')</span></span></span>
<span class="r-in"><span><span class="co"># itemfit(x, 'X2*') # Stone's 1993 statistic</span></span></span>
<span class="r-in"><span><span class="co"># itemfit(x, 'X2*_df') # Stone's 2000 scaled statistic with df estimate</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># empirical tables for X2 statistic</span></span></span>
<span class="r-in"><span><span class="va">tabs</span> <span class="op">&lt;-</span> <span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, <span class="st">'X2'</span>, return.tables<span class="op">=</span><span class="cn">TRUE</span>, which.items <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in xtfrm.data.frame(x):</span> cannot xtfrm data frames</span>
<span class="r-in"><span><span class="va">tabs</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'tabs' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#infit/outfit statistics. method='ML' agrees better with eRm package</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, <span class="st">'infit'</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span> <span class="co">#infit and outfit stats</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in personfit(x, method = method, Theta = Theta):</span> Theta must be a matrix</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#same as above, but inputting ML estimates instead (saves time for re-use)</span></span></span>
<span class="r-in"><span><span class="va">Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="fscores.html">fscores</a></span><span class="op">(</span><span class="va">raschfit</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, <span class="st">'infit'</span>, Theta<span class="op">=</span><span class="va">Theta</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in itemfit(raschfit, "infit", Theta = Theta):</span> Theta does not have the correct number of rows</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, empirical.plot<span class="op">=</span><span class="fl">1</span>, Theta<span class="op">=</span><span class="va">Theta</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in itemfit(raschfit, empirical.plot = 1, Theta = Theta):</span> Theta does not have the correct number of rows</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, <span class="st">'X2'</span>, return.tables<span class="op">=</span><span class="cn">TRUE</span>, Theta<span class="op">=</span><span class="va">Theta</span>, which.items<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in itemfit(raschfit, "X2", return.tables = TRUE, Theta = Theta,     which.items = 1):</span> Theta does not have the correct number of rows</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit a new more flexible model for the mis-fitting item</span></span></span>
<span class="r-in"><span><span class="va">itemtype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>, <span class="fl">20</span><span class="op">)</span>, <span class="st">'spline'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">data</span>, <span class="fl">1</span>, itemtype<span class="op">=</span><span class="va">itemtype</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>EM cycles terminated after 500 iterations.</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item   S_X2 df.S_X2 RMSEA.S_X2 p.S_X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1 13.109      15      0.000  0.594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2 13.513      15      0.000  0.563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3 21.887      15      0.015  0.111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4  9.894      15      0.000  0.826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5 16.248      15      0.006  0.366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6 10.218      16      0.000  0.855</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7 18.279      15      0.010  0.248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8 13.587      16      0.000  0.629</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9 13.485      15      0.000  0.565</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10 10.569      16      0.000  0.835</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 Item_11 16.325      15      0.007  0.361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 Item_12  9.663      15      0.000  0.840</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 Item_13 19.394      16      0.010  0.249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 Item_14 16.357      15      0.007  0.359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 Item_15  9.410      16      0.000  0.896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 Item_16 13.578      16      0.000  0.630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 Item_17 29.945      16      0.021  0.018</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Item_18 15.058      16      0.000  0.520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Item_19 15.663      15      0.005  0.405</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Item_20  9.333      15      0.000  0.859</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 baditem 11.473      13      0.000  0.571</span>
<span class="r-in"><span><span class="fu"><a href="itemplot.html">itemplot</a></span><span class="op">(</span><span class="va">x2</span>, <span class="fl">21</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="itemfit-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         AIC    SABIC       HQ      BIC    logLik     X2 df p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x  49477.85 49579.65 49564.23 49713.09 -24696.93            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2 49214.97 49321.62 49305.46 49461.41 -24563.49 266.88  2 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#similar example to Kang and Chen 2007</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.8</span>,<span class="fl">.4</span>,<span class="fl">.7</span>, <span class="fl">.8</span>, <span class="fl">.4</span>, <span class="fl">.7</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.0</span>,<span class="fl">0.0</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1.5</span><span class="op">)</span>,<span class="fl">10</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">d</span>,<span class="fl">2000</span>, itemtype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'graded'</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>      4      0      1      4      1      4      3      2      1       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>      2      1      1      3      2      4      2      1      4       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>      2      2      3      0      0      0      4      4      4       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>      1      2      4      1      2      2      2      2      0       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>      1      3      0      2      1      4      4      4      3       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>      1      3      3      2      3      1      1      2      0       1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       item    S_X2 df.S_X2 RMSEA.S_X2 p.S_X2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Item_1 143.021     103      0.014  0.006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Item_2  85.589     109      0.000  0.953</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Item_3 110.835     105      0.005  0.330</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Item_4 121.145     103      0.009  0.107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   Item_5 107.875     111      0.000  0.566</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   Item_6  93.905     102      0.000  0.704</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   Item_7 113.544      99      0.009  0.151</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   Item_8 100.858      99      0.003  0.429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   Item_9  83.214      98      0.000  0.857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 Item_10 104.402      99      0.005  0.336</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">mod</span>, <span class="st">'X2'</span><span class="op">)</span> <span class="co"># less useful given inflated Type I error rates</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in xtfrm.data.frame(x):</span> cannot xtfrm data frames</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">mod</span>, empirical.plot <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in xtfrm.data.frame(x):</span> cannot xtfrm data frames</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">mod</span>, empirical.plot <span class="op">=</span> <span class="fl">1</span>, empirical.poly.collapse<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in xtfrm.data.frame(x):</span> cannot xtfrm data frames</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># collapsed tables (see mincell.X2) for X2 and G2</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">mod</span>, <span class="st">'X2'</span>, return.tables <span class="op">=</span> <span class="cn">TRUE</span>, which.items <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in xtfrm.data.frame(x):</span> cannot xtfrm data frames</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="st">'Rasch'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">mod2</span>, <span class="st">'infit'</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in personfit(x, method = method, Theta = Theta):</span> Theta must be a matrix</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># massive list of tables for S-X2</span></span></span>
<span class="r-in"><span><span class="va">tables</span> <span class="op">&lt;-</span> <span class="fu">itemfit</span><span class="op">(</span><span class="va">mod</span>, return.tables <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#observed and expected total score patterns for item 1 (post collapsing)</span></span></span>
<span class="r-in"><span><span class="va">tables</span><span class="op">$</span><span class="va">O</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0  1  2  3  4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  12  3  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   6  1  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   8 17  1  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  12 16  5  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  22  8  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  30 20  3  3  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 19 27  9  1  7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 16 32  9  4  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 17 40 17  1  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 25 51 15  4  8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 22 44 14  3  8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 22 46 22  5 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 14 41 32  8 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 11 42 31  8 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 11 57 25  7 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 17 41 37 11 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 11 35 28 12 26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 10 32 32  8 22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  5 32 18 15 29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  2 23 17  7 33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  2 30 22  9 23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  3 15 19  7 28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  3 12 16 11 23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  4 13 12  4 19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  3  6  9  5 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  3  6  2 17  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30  3 10  2 21  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31  1  2  1 13  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32  1  4  5  6  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33  3  4  4  5  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34  1  3  1 11  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35  2  6  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36  2  6  0  0  0</span>
<span class="r-in"><span><span class="va">tables</span><span class="op">$</span><span class="va">E</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]      [,2]      [,3]      [,4]      [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 11.023325  3.976675        NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  4.102366  2.897634        NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 13.498246 10.610902  1.890852        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 15.184304 14.492730  3.322965        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 12.249443 13.799872  3.950685        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 20.682046 26.920288  6.923239  1.157706  1.316720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 20.332439 30.097150  8.830861  1.641385  2.098165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 17.517441 29.135716  9.625822  1.958940  2.762080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 20.446921 37.829468 13.940499  3.072836  4.710276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 23.437800 47.811327 19.504466  4.622495  7.623912</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 18.436615 41.167389 18.467918  4.679944  8.248134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 19.651227 47.756678 23.431406  6.318731 11.841957</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 19.076413 50.199010 26.830125  7.670547 15.223905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 14.528071 41.195659 23.904020  7.227464 15.144786</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 15.799085 48.086720 30.192468  9.636968 21.284760</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 13.544069 44.116503 29.895563 10.055666 23.388198</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 11.078348 38.500292 28.110440  9.952500 24.358420</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]  9.068050 33.529616 26.330542  9.809752 25.262041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]  7.581094 29.780090 25.109651  9.840833 26.688332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]  5.489874 22.880802 20.702905  8.532437 24.393982</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,]  5.010515 22.116677 21.467501  9.311108 28.094199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]  3.626463 16.954931 17.637672  8.059013 25.721921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,]  2.805419 13.907880 15.517623  7.472196 25.296882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,]  1.907017 10.013898 12.004816  6.104317 21.969952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,]  1.261885  7.039995  9.063539  4.881523 18.753058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,]  4.944641  5.875443  3.354204 13.825711        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,]  5.454637  7.095249  4.313860 19.136254        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,]  2.176787  3.093386  2.019117  9.710709        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,]  1.685470  2.659415  1.858932  9.796184        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,]  1.334541  2.384692  1.813140 10.467628        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31,]  1.040082  2.042086  1.733955 11.183876        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [32,]  2.050562  5.949438        NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33,]  1.369048  6.630952        NA        NA        NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># can also select specific items</span></span></span>
<span class="r-in"><span><span class="co"># itemfit(mod, return.tables = TRUE, which.items=1)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit stats with missing data (run in parallel using all cores)</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span>, <span class="fl">100</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in `[&lt;-`(`*tmp*`, sample(1:prod(dim(dat)), 100), value = NA):</span> Can't assign to columns beyond the end with non-consecutive locations.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> Input has size 10.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">✖</span> Subscript `sample(1:prod(dim(dat)), 100)` contains non-consecutive locations 820, 1141, 1583, 1918, 2007, etc.</span>
<span class="r-in"><span><span class="va">raschfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, itemtype<span class="op">=</span><span class="st">'Rasch'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use only valid data by removing rows with missing terms</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'S_X2'</span>, <span class="st">'infit'</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data does not contain missing values. Continuing normally</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Sample size after row-wise response data removal: 2000</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in personfit(x, method = method, Theta = Theta):</span> Theta must be a matrix</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># note that X2, G2, PV-Q1, and X2* do not require complete datasets</span></span></span>
<span class="r-in"><span><span class="va">thetas</span> <span class="op">&lt;-</span> <span class="fu"><a href="fscores.html">fscores</a></span><span class="op">(</span><span class="va">raschfit</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span> <span class="co"># save for faster computations</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'X2'</span>, <span class="st">'G2'</span><span class="op">)</span>, Theta<span class="op">=</span><span class="va">thetas</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in itemfit(raschfit, c("X2", "G2"), Theta = thetas):</span> Theta does not have the correct number of rows</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, empirical.plot<span class="op">=</span><span class="fl">1</span>, Theta<span class="op">=</span><span class="va">thetas</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in itemfit(raschfit, empirical.plot = 1, Theta = thetas):</span> Theta does not have the correct number of rows</span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, <span class="st">'X2'</span>, return.tables<span class="op">=</span><span class="cn">TRUE</span>, which.items<span class="op">=</span><span class="fl">1</span>, Theta<span class="op">=</span><span class="va">thetas</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in itemfit(raschfit, "X2", return.tables = TRUE, which.items = 1,     Theta = thetas):</span> Theta does not have the correct number of rows</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

